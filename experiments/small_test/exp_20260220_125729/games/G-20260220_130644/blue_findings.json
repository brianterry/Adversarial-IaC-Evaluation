[
  {
    "finding_id": "F1",
    "resource_name": "aws_security_group.lambda_sg",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Unrestricted Network Access",
    "description": "Security group allows unrestricted inbound and outbound traffic from any source",
    "evidence": "ingress { from_port = 0, to_port = 65535, cidr_blocks = [\"0.0.0.0/0\"] }",
    "line_number_estimate": 45,
    "confidence": 0.95,
    "reasoning": "The security group permits all TCP ports (0-65535) from any IP address, creating a significant network exposure risk",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "aws_s3_bucket.transaction_logs",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "encryption|data_protection",
    "severity": "high",
    "title": "Unencrypted Sensitive Data Storage",
    "description": "S3 bucket storing financial transaction logs lacks encryption configuration",
    "evidence": "No encryption_at_rest configuration specified",
    "line_number_estimate": 30,
    "confidence": 0.9,
    "reasoning": "Financial transaction data requires encryption to protect against unauthorized access",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "aws_iam_role.lambda_exec",
    "resource_type": "aws_iam_role",
    "vulnerability_type": "iam",
    "severity": "medium",
    "title": "Overly Broad IAM Role Permissions",
    "description": "IAM role policy provides broad logging permissions without specific resource constraints",
    "evidence": "Resource = \"arn:aws:logs:*:*:*\"",
    "line_number_estimate": 90,
    "confidence": 0.85,
    "reasoning": "While the policy appears minimal, it uses a wildcard for log resource access",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "aws_lambda_function.transaction_processor",
    "resource_type": "aws_lambda_function",
    "vulnerability_type": "data_protection",
    "severity": "medium",
    "title": "Potential Code Deployment Security Risk",
    "description": "Lambda function uses local ZIP file for deployment without explicit version control",
    "evidence": "filename = \"lambda_function.zip\"",
    "line_number_estimate": 20,
    "confidence": 0.75,
    "reasoning": "Direct local file deployment can introduce risks if source code management is not strict",
    "source": "llm"
  }
]