[
  {
    "finding_id": "F1",
    "resource_name": "cicd_artifacts",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "S3 Bucket Lacks Encryption",
    "description": "S3 bucket is not configured with server-side encryption",
    "evidence": "No encryption_configuration block present",
    "line_number_estimate": 15,
    "confidence": 0.95,
    "reasoning": "Unencrypted S3 buckets expose sensitive data to potential unauthorized access",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "build_agents",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Unrestricted SSH Access",
    "description": "Security group allows SSH access from any IP address",
    "evidence": "cidr_blocks = [\"0.0.0.0/0\"]",
    "line_number_estimate": 35,
    "confidence": 0.98,
    "reasoning": "Allowing SSH from anywhere creates significant risk of brute force and unauthorized access",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "build_metadata",
    "resource_type": "aws_db_instance",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "Database Not Encrypted",
    "description": "RDS instance lacks storage encryption",
    "evidence": "No storage_encrypted configuration",
    "line_number_estimate": 55,
    "confidence": 0.95,
    "reasoning": "Unencrypted databases expose sensitive data at rest",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "cicd_role",
    "resource_type": "aws_iam_role_policy",
    "vulnerability_type": "iam",
    "severity": "critical",
    "title": "Overly Permissive IAM Policy",
    "description": "IAM role has wildcard permissions across multiple services",
    "evidence": "Action = [\"s3:*\", \"ec2:*\", \"rds:*\"], Resource = \"*\"",
    "line_number_estimate": 85,
    "confidence": 0.9,
    "reasoning": "Wildcard permissions violate least privilege principle, enabling potential unauthorized actions",
    "source": "llm"
  },
  {
    "finding_id": "F5",
    "resource_name": "cicd_artifacts",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "access_control",
    "severity": "high",
    "title": "Missing Public Access Block",
    "description": "S3 bucket lacks public access restrictions",
    "evidence": "No aws_s3_bucket_public_access_block resource",
    "line_number_estimate": 15,
    "confidence": 0.95,
    "reasoning": "Without explicit public access blocks, bucket could be inadvertently exposed",
    "source": "llm"
  }
]