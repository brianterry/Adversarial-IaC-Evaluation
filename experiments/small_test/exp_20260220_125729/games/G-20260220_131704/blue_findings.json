[
  {
    "finding_id": "F1",
    "resource_name": "aws_s3_bucket.medical_records",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "access_control",
    "severity": "critical",
    "title": "S3 Bucket Public Access Blocks Disabled",
    "description": "The S3 bucket containing sensitive PHI (Protected Health Information) has all public access blocks disabled, potentially allowing public access to medical records. This violates HIPAA requirements and poses a severe data breach risk.",
    "evidence": "block_public_acls = false\nblock_public_policy = false\nignore_public_acls = false\nrestrict_public_buckets = false",
    "line_number_estimate": 32,
    "confidence": 0.99,
    "reasoning": "1. The bucket contains PHI data (tagged as PHI)\n2. All public access blocks are explicitly disabled\n3. This configuration allows public access policies and ACLs\n4. Healthcare data must be strictly private per HIPAA",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "aws_security_group.backend_services",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Overly Permissive Security Group Rules",
    "description": "The security group allows unrestricted inbound access on all ports from any source IP address, creating a severe security risk for backend services.",
    "evidence": "from_port = 0\nto_port = 65535\nprotocol = \"tcp\"\ncidr_blocks = [\"0.0.0.0/0\"]",
    "line_number_estimate": 45,
    "confidence": 0.99,
    "reasoning": "1. Opens ALL TCP ports (0-65535)\n2. Allows access from ANY IP address (0.0.0.0/0)\n3. Backend services should have restricted access\n4. Violates principle of least privilege",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "aws_db_instance.patient_records",
    "resource_type": "aws_db_instance",
    "vulnerability_type": "encryption",
    "severity": "critical",
    "title": "Unencrypted Database Storage",
    "description": "The RDS instance storing patient records has storage encryption explicitly disabled, violating HIPAA requirements for PHI protection.",
    "evidence": "storage_encrypted = false",
    "line_number_estimate": 73,
    "confidence": 0.99,
    "reasoning": "1. Database contains PHI (tagged as PHI)\n2. Storage encryption is explicitly disabled\n3. HIPAA requires encryption for PHI at rest\n4. Sensitive medical data is at risk",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "aws_s3_bucket.medical_records",
    "resource_type": "data_protection",
    "vulnerability_type": "data_protection",
    "severity": "high",
    "title": "Force Destroy Enabled on PHI Storage",
    "description": "The S3 bucket has force_destroy enabled, which could lead to accidental deletion of medical records without proper safeguards.",
    "evidence": "force_destroy = true",
    "line_number_estimate": 24,
    "confidence": 0.95,
    "reasoning": "1. force_destroy allows bucket deletion with content\n2. Medical records require strict retention policies\n3. Accidental deletion could violate HIPAA requirements\n4. No versioning or backup configuration specified",
    "source": "llm"
  }
]