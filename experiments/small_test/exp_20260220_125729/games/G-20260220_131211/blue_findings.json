[
  {
    "finding_id": "F1",
    "resource_name": "aws_rds_cluster.transaction_history",
    "resource_type": "aws_rds_cluster",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "Missing RDS Cluster Encryption",
    "description": "RDS cluster lacks storage encryption, exposing sensitive transaction data to potential unauthorized access",
    "evidence": "storage encryption intentionally omitted in RDS cluster configuration",
    "line_number_estimate": 32,
    "confidence": 0.95,
    "reasoning": "No storage_encrypted parameter set, leaving database contents unencrypted at rest",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "aws_security_group.lambda_sg",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Overly Permissive Security Group",
    "description": "Lambda security group allows unrestricted inbound access from any IP address",
    "evidence": "cidr_blocks = [\"0.0.0.0/0\"]",
    "line_number_estimate": 55,
    "confidence": 0.95,
    "reasoning": "Allows all TCP traffic from any source, creating significant network exposure",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "aws_s3_bucket.transaction_logs",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "logging",
    "severity": "medium",
    "title": "Missing S3 Bucket Logging Configuration",
    "description": "Transaction logs bucket lacks logging and access tracking",
    "evidence": "No logging configuration defined for S3 bucket",
    "line_number_estimate": 42,
    "confidence": 0.85,
    "reasoning": "No logging_target or access logging configured, preventing audit trail creation",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "aws_lambda_function.payment_processor",
    "resource_type": "aws_lambda_function",
    "vulnerability_type": "data_protection",
    "severity": "medium",
    "title": "Sensitive Environment Variables in Lambda",
    "description": "Database connection details exposed in Lambda environment variables",
    "evidence": "Environment variables include RDS endpoint and transaction bucket",
    "line_number_estimate": 22,
    "confidence": 0.75,
    "reasoning": "Direct exposure of infrastructure connection details increases potential attack surface",
    "source": "llm"
  }
]