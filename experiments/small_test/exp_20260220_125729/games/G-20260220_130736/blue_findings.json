[
  {
    "finding_id": "F1",
    "resource_name": "transaction_logs",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "access_control",
    "severity": "critical",
    "title": "Public S3 Bucket Access Enabled",
    "description": "S3 bucket public access controls are completely disabled, allowing potential unauthorized access to sensitive transaction logs",
    "evidence": "public_access_block { block_public_acls = false, block_public_policy = false }",
    "line_number_estimate": 35,
    "confidence": 0.95,
    "reasoning": "All public access block settings are set to false, which means anyone could potentially read or modify transaction logs",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "transaction_sg",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Overly Permissive Security Group",
    "description": "Security group allows unrestricted inbound and outbound traffic from any IP address",
    "evidence": "ingress { from_port = 0, to_port = 65535, cidr_blocks = ['0.0.0.0/0'] }",
    "line_number_estimate": 75,
    "confidence": 0.95,
    "reasoning": "Open ingress rule allows all TCP ports from any source IP, creating significant network exposure",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "transaction_db",
    "resource_type": "aws_db_instance",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "Database Storage Not Encrypted",
    "description": "RDS database storage encryption is disabled, exposing sensitive transaction data",
    "evidence": "storage_encrypted = false",
    "line_number_estimate": 60,
    "confidence": 0.9,
    "reasoning": "Disabling storage encryption leaves database contents vulnerable to unauthorized access",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "transaction_processor",
    "resource_type": "aws_lambda_function",
    "vulnerability_type": "network",
    "severity": "medium",
    "title": "Broad Lambda Network Configuration",
    "description": "Lambda function configured with potentially unnecessary network access",
    "evidence": "vpc_config { subnet_ids = var.subnet_ids }",
    "line_number_estimate": 20,
    "confidence": 0.8,
    "reasoning": "Lambda function has broad subnet access without clear network segmentation",
    "source": "llm"
  },
  {
    "finding_id": "F5",
    "resource_name": "transaction_logs",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "logging",
    "severity": "medium",
    "title": "S3 Bucket Logging Disabled",
    "description": "S3 bucket logging is disabled, preventing audit trail tracking",
    "evidence": "logging { target_bucket = null }",
    "line_number_estimate": 45,
    "confidence": 0.85,
    "reasoning": "No logging configuration means no visibility into bucket access patterns",
    "source": "llm"
  }
]