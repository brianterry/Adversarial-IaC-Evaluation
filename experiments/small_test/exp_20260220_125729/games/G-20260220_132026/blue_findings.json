[
  {
    "finding_id": "F1",
    "resource_name": "aws_s3_bucket.cicd_artifacts",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "access_control",
    "severity": "critical",
    "title": "S3 Bucket Configured with Public Access",
    "description": "The S3 bucket is configured with 'public-read' ACL, making its contents publicly accessible to anyone on the internet. This is a severe security risk for CI/CD artifacts which may contain sensitive code or credentials.",
    "evidence": "acl = \"public-read\"",
    "line_number_estimate": 32,
    "confidence": 0.99,
    "reasoning": "1. ACL is explicitly set to public-read\n2. CI/CD artifacts typically contain sensitive information\n3. Public access to build artifacts creates security and intellectual property risks",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "aws_s3_bucket.cicd_artifacts",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "Missing Server-Side Encryption",
    "description": "The S3 bucket has no encryption configuration specified, meaning data is stored unencrypted at rest. This violates security best practices for sensitive CI/CD artifacts.",
    "evidence": "# No server_side_encryption specified",
    "line_number_estimate": 34,
    "confidence": 0.95,
    "reasoning": "1. No encryption configuration is present\n2. CI/CD artifacts should always be encrypted at rest\n3. Lack of encryption exposes sensitive data if bucket access is compromised",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "aws_security_group.cicd_sg",
    "resource_type": "aws_security_group",
    "vulnerability_type": "network",
    "severity": "critical",
    "title": "Overly Permissive Security Group Rules",
    "description": "Security group allows unrestricted inbound access on all ports (0-65535) from any IP address (0.0.0.0/0).",
    "evidence": "from_port = 0\nto_port = 65535\ncidr_blocks = [\"0.0.0.0/0\"]",
    "line_number_estimate": 48,
    "confidence": 0.99,
    "reasoning": "1. Opens all TCP ports to the internet\n2. No IP restrictions in place\n3. Violates principle of least privilege\n4. Creates unnecessary attack surface",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "aws_s3_bucket.cicd_artifacts",
    "resource_type": "data_protection",
    "vulnerability_type": "unknown",
    "severity": "medium",
    "title": "S3 Bucket Versioning Disabled",
    "description": "Versioning is explicitly disabled on the S3 bucket containing CI/CD artifacts, preventing recovery from accidental deletions or modifications.",
    "evidence": "versioning {\n  enabled = false\n}",
    "line_number_estimate": 36,
    "confidence": 0.9,
    "reasoning": "1. Versioning explicitly disabled\n2. CI/CD artifacts should maintain version history\n3. No protection against accidental or malicious overwrites",
    "source": "llm"
  }
]