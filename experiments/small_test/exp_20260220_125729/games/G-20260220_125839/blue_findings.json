[
  {
    "finding_id": "F1",
    "resource_name": "aws_kms_key.phi_encryption_key",
    "resource_type": "aws_kms_key",
    "vulnerability_type": "iam",
    "severity": "critical",
    "title": "Overly permissive KMS key policy",
    "description": "The KMS key policy grants full access (kms:*) to the AWS account root user, which violates least privilege principles and creates unnecessary risk for PHI data",
    "evidence": "Action = \"kms:*\", Principal = { AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\" }",
    "line_number_estimate": 35,
    "confidence": 0.95,
    "reasoning": "1. Policy grants full KMS permissions (kms:*)\n2. Granted to account root user\n3. HIPAA compliance requires strict access controls\n4. No conditions limiting key usage",
    "source": "llm"
  },
  {
    "finding_id": "F2",
    "resource_name": "aws_s3_bucket_server_side_encryption_configuration.phi_storage",
    "resource_type": "aws_s3_bucket_server_side_encryption_configuration",
    "vulnerability_type": "encryption",
    "severity": "high",
    "title": "Weak encryption configuration for PHI data",
    "description": "S3 bucket storing PHI uses AES256 SSE instead of KMS encryption, reducing audit capabilities and key management control",
    "evidence": "sse_algorithm = \"AES256\"",
    "line_number_estimate": 71,
    "confidence": 0.95,
    "reasoning": "1. PHI data requires strong encryption controls\n2. AES256 SSE doesn't provide detailed audit trails\n3. KMS key exists but isn't used\n4. HIPAA compliance typically requires KMS for better key management",
    "source": "llm"
  },
  {
    "finding_id": "F3",
    "resource_name": "aws_s3_bucket_versioning.phi_storage",
    "resource_type": "aws_s3_bucket",
    "vulnerability_type": "data_protection",
    "severity": "high",
    "title": "S3 bucket versioning disabled for PHI data",
    "description": "Versioning is disabled on S3 bucket containing PHI data, risking data loss and making recovery from accidental deletions impossible",
    "evidence": "status = \"Disabled\"",
    "line_number_estimate": 82,
    "confidence": 0.95,
    "reasoning": "1. PHI data requires protection against accidental deletion\n2. Versioning provides audit trail of changes\n3. HIPAA requires data retention capabilities\n4. Versioning helps maintain data integrity",
    "source": "llm"
  },
  {
    "finding_id": "F4",
    "resource_name": "aws_s3_bucket_acl.phi_storage",
    "resource_type": "aws_s3_bucket_acl",
    "vulnerability_type": "access_control",
    "severity": "high",
    "title": "Overly permissive S3 bucket ACL",
    "description": "Bucket ACL set to 'authenticated-read' allows any authenticated AWS user to read bucket contents",
    "evidence": "acl = \"authenticated-read\"",
    "line_number_estimate": 77,
    "confidence": 0.95,
    "reasoning": "1. PHI data should be restricted to specific authorized users\n2. authenticated-read allows any AWS authenticated user to read\n3. Violates HIPAA access control requirements\n4. Creates unnecessary exposure risk",
    "source": "llm"
  },
  {
    "finding_id": "F5",
    "resource_name": "aws_s3_bucket_policy.phi_storage",
    "resource_type": "aws_s3_bucket_policy",
    "vulnerability_type": "access_control",
    "severity": "critical",
    "title": "Overly permissive S3 bucket policy",
    "description": "Bucket policy allows all IAM users in the account to read, write, and delete PHI data",
    "evidence": "Principal = { AWS = \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:*\" }",
    "line_number_estimate": 95,
    "confidence": 0.95,
    "reasoning": "1. Policy grants access to all IAM users in account\n2. Includes destructive permissions (DeleteObject)\n3. No conditions limiting access\n4. Violates HIPAA least privilege requirements",
    "source": "llm"
  }
]